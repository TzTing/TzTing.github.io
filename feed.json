{
    "version": "https://jsonfeed.org/version/1",
    "title": "一些记录",
    "subtitle": "= 编程、羽毛球、游戏、骑行 =",
    "icon": "https://mytingting.gitee.io/tzblog/images/favicon.ico",
    "description": "君将自由, 我心亦然",
    "home_page_url": "https://mytingting.gitee.io/tzblog",
    "items": [
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/04/20/computer-science/databases/sql-optimization/",
            "url": "https://mytingting.gitee.io/tzblog/2024/04/20/computer-science/databases/sql-optimization/",
            "title": "通用sql优化",
            "date_published": "2024-04-20T11:12:45.000Z",
            "content_html": "<div class=\"note info\">\n<p>本文介绍通用的 sql 语句优化的经验</p>\n</div>\n<h1 id=\"sql优化经验\"><a class=\"anchor\" href=\"#sql优化经验\">#</a> sql 优化经验</h1>\n<h2 id=\"介绍\"><a class=\"anchor\" href=\"#介绍\">#</a> 介绍</h2>\n<p>在 SQL 优化方面，有多种策略可以提高查询性能和减少资源消耗。</p>\n<h2 id=\"sql执行计划常用操作符\"><a class=\"anchor\" href=\"#sql执行计划常用操作符\">#</a> SQL 执行计划常用操作符</h2>\n<ol>\n<li>\n<p>PRJT2<br />\n 关系的 “投影”(project) 运算，用于选择表达式项的计算；广泛用于查询，排序，函数索引创建等。<br />\nSQL&gt;explain select c1 + c2 from t1;<br />\nexplain select c1 + c2 from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)</p>\n</li>\n<li>\n<p>NSET2<br />\n 结果集 (result set) 收集，一般是查询计划的顶层节点。<br />\nSQL&gt;explain select c1 + c2 from t1;<br />\nexplain select c1 + c2 from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)</p>\n</li>\n<li>\n<p>SLCT2<br />\n 关系的 “选择”（select）运算，用于查询条件的过滤。<br />\nexplain select * from t1 where c1 &gt;1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#SLCT2: [6, 1, 0]; T1.C1 &gt; 1<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)</p>\n</li>\n<li>\n<p>NEST LOOP INNER JOIN2</p>\n<p>简写为 NLI2，嵌套循环内连接；没有索引可用，且无法用 HASH,(如不等值比较)，则可能使用 NLI2</p>\n<p>explain select * from t1, t2 where t1.c1 &gt;t2.c2;<br />\n#NSET2: [19, 1, 0]<br />\n#PRJT2: [19, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#SLCT2: [19, 1, 0]; T1.C1 &gt; T2.C2<br />\n#NEST LOOP INNER JOIN2: [19, 1, 0];<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>MERGE INNER JOIN3<br />\n 简写为 MI3，归并内连接；有索引可用时，有可能使用 MI3。<br />\nexplain select a.c1, b.c1 from tx a, tx b where a.c1 = b.c1;<br />\n#NSET2: [29, 100000, 0]<br />\n#PRJT2: [29, 100000, 0]; exp_num(2), is_atom(FALSE)<br />\n#MERGE INNER JOIN3: [29, 100000, 0];<br />\n#CSCN2: [23, 100000, 0]; INDEX33555463(TX)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555463(TX)</p>\n</li>\n<li>\n<p>NEST LOOP FULL JOIN2<br />\n 简写为 NLFO2，嵌套循环全外连接。一般不等值连接时使用。<br />\nexplain select *from t1 full join t2 on t1.c1 &lt;&gt; t2.c1;<br />\n#NSET2: [19, 1, 0]<br />\n#PRJT2: [19, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#NEST LOOP FULL JOIN2: [19, 1, 0]; join condition(T1.C1 &lt;&gt; T2.C1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>NEST LOOP LEFT JOIN2<br />\n 简写为 NLLO2，嵌套循环左外连接。一般不等值连接时使用。<br />\nexplain select *from t1 left join t2 on t1.c1 &lt;&gt; t2.c1;<br />\n#NSET2: [19, 1, 0]<br />\n#PRJT2: [19, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#NEST LOOP LEFT JOIN2: [19, 1, 0]; join condition(T1.C1 &lt;&gt; T2.C1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>HASH LEFT JOIN2<br />\n 简写为 HLO2，HASH 左外连接。一般等值连接时使用。<br />\nexplain select *from t1 left join t2 on t1.c1 = t2.c1;<br />\n#NSET2: [13, 1, 0]<br />\n#PRJT2: [13, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#HASH LEFT JOIN2: [13, 1, 0]; key_num(1),<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>HASH RIGHT JOIN2<br />\n 简写为 HRO2，HASH 右外连接。下面的例子，做一个 tx 与 t2 的左连接。因为 t2 的行数很小，tx 比较大，所以自动转为右连接，在 t2 上建 hash 的代价比较小。<br />\nexplain select * from tx left join t2 on t2.c1 = tx.c1 + 2;<br />\n#NSET2: [39, 100000, 0]<br />\n#PRJT2: [39, 100000, 0]; exp_num(4), is_atom(FALSE)<br />\n#HASH RIGHT JOIN2: [39, 100000, 0]; key_num(1),<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555463(TX)</p>\n</li>\n<li>\n<p>HASH FULL JOIN2<br />\n 简写为 HFO2，HASH 全外连接。等值连接时可用；<br />\nexplain select *from t1 full join t2 on t1.c1 = t2.c1;<br />\n#NSET2: [13, 1, 0]<br />\n#PRJT2: [13, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#HASH FULL JOIN2: [13, 1, 0]; key_num(1),<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>TOPN2<br />\n 取前 N 个记录；</p>\n<p>explain select top 10 * from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#TOPN2: [6, 1, 0]; top_num(10)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)</p>\n</li>\n<li>\n<p>UNION ALL<br />\nUnion all 运算，<br />\nexplain select *from t1 union all select *from t2;<br />\n#NSET2: [13, 2, 0]<br />\n#PRJT2: [13, 2, 0]; exp_num(2), is_atom(FALSE)<br />\n#UNION ALL: [13, 2, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>UNION<br />\n 集合的并运算，<br />\nexplain select *from t1 union select *from t2;<br />\n#NSET2: [13, 2, 0]<br />\n#PRJT2: [13, 2, 0]; exp_num(2), is_atom(FALSE)<br />\n#UNION: [13, 2, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555457(T1)<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555458(T2)</p>\n</li>\n<li>\n<p>EXCEPT / EXCEPT ALL<br />\n 集合的差运算<br />\n explain select * from t1 except select * from t2;<br />\n#NSET2: [13, 1, 0]<br />\n#PRJT2: [13, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#EXCEPT: [13, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555476(T2)</p>\n</li>\n<li>\n<p>INTER SECT/ INTERSECT ALL<br />\n 集合的交运算<br />\n explain select * from t1 intersect select * from t2;<br />\n#NSET2: [13, 1, 0]<br />\n#PRJT2: [13, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#INTERSECT: [13, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555476(T2)</p>\n</li>\n<li>\n<p>INSERET/VINS2<br />\n 插入记录，其中 VINS2 用于列存储表<br />\n explain insert into t1 values (1, 1);<br />\n#INSERT : [0, 0, 0]; table(T1), type(values)</p>\n</li>\n<li>\n<p>HAGR2<br />\nHash aggregate; HASH 分组，并计算聚集函数<br />\n explain select count (*) from tx group by c2;<br />\n#NSET2: [23, 1000, 0]<br />\n#PRJT2: [23, 1000, 0]; exp_num(1), is_atom(FALSE)<br />\n#HAGR2: [23, 1000, 0]; grp_num(1), sfun_num(1)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>SAGR2<br />\nStream Aggregate; 如果输入流是有序的，则使用流分组，并计算聚集函数<br />\n explain select count (*) from tx group by c1;<br />\n#NSET2: [23, 1000, 0]<br />\n#PRJT2: [23, 1000, 0]; exp_num(1), is_atom(FALSE)<br />\n#SAGR2: [23, 1000, 0]; grp_num(1), sfun_num(1)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>FAGR2<br />\nFast aggregate; 如果没有 where 条件，且取 count (<em>), 或者基于索引的 MAX/MIN 值，则可以快速取得集函数的值<br />\n explain select count (</em>) from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(1), is_atom(FALSE)<br />\n#FAGR2: [6, 1, 0]; sfun_num(1)</p>\n</li>\n<li>\n<p>AAGR2<br />\n 简单聚集；如果没有分组（group by）， 则总的就一个组，直接计算聚集函数<br />\n explain select count (*) from tx where c2 = 10;<br />\n#NSET2: [22, 1, 0]<br />\n#PRJT2: [22, 1, 0]; exp_num(1), is_atom(FALSE)<br />\n#AAGR2: [22, 1, 0]; grp_num(0), sfun_num(1)<br />\n#SLCT2: [22, 2500, 0]; exp_cast(TX.C2) = var1<br />\n#CSCN2: [22, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>HASH LEFT SEMI JOIN2<br />\nHASH 左半连接； 扫描左表建立 hash 表，扫描右表探测 HASH 表，最后输出被探测到的左表的行<br />\n explain select * from t1 where c1 in (select c2 from tx);<br />\n#NSET2: [35, 1, 0]<br />\n#PRJT2: [35, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#HASH LEFT SEMI JOIN2: [35, 1, 0];<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#PRJT2: [22, 100000, 0]; exp_num(1), is_atom(FALSE)<br />\n#CSCN2: [22, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>CSCN2/VSCN2<br />\n 聚集索引扫描（cluster index scan）; VSCN2 用于列存储表<br />\n explain select *from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)</p>\n</li>\n<li>\n<p>DSCN<br />\nDynamic table scan; 动态视图扫描<br />\n explain select * from vthreads;\n#NSET2: [6, 1, 0]\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)\n#DSCN: [6, 1, 0]; SYSINDEXVTHREADS(V$THREADS)</p>\n</li>\n<li>\n<p>DELETE/VDEL2<br />\n 删除数据，其中 VDEL2 用于列存储表<br />\n explain delete from t1 where c1 = 1;<br />\n#DELETE : [0, 0, 0]; table(T1), type(select)<br />\n#TEMP TABLE SPOOL: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(1), is_atom(FALSE)<br />\n#SLCT2: [6, 1, 0]; T1.C1 = 1<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)</p>\n</li>\n<li>\n<p>SORT3<br />\n 排序<br />\n explain select * from t1 order by c1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#SORT3: [6, 1, 0]; key_num(1), is_distinct(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)</p>\n</li>\n<li>\n<p>TEMP TABLE SPOOL<br />\n 临时表，临时存放数据；如 delete/update 时，临时存放 ROWID, PK 等定位信息<br />\n explain delete from t1 where c1 = 1;<br />\n#DELETE : [0, 0, 0]; table(T1), type(select)<br />\n#TEMP TABLE SPOOL: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(1), is_atom(FALSE)<br />\n#SLCT2: [6, 1, 0]; T1.C1 = 1<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)</p>\n</li>\n<li>\n<p>PIPE2<br />\n 管道；先做一遍右儿子，然后执行左儿子，并把左儿子的数据向上送，直到左儿子不再有数据。<br />\nexplain select (select 2) from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#PIPE2: [6, 1, 0]<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#SPOOL2: [0, 1, 0]; key_num(1), spool_num(0)<br />\n#PRJT2: [0, 1, 0]; exp_num(1), is_atom(TRUE)<br />\n#CSCN2: [0, 1, 0]; SYSINDEXSYSDUAL(SYSDUAL)</p>\n</li>\n<li>\n<p>SPOOL2<br />\n 也是临时表；和 TEMP TABLE SPOOL (NTTS) 不同的是，它的数据集不向父亲节点传送，而是被编号，用编号和 KEY 来定位访问；而 TEMP TABLE SPOOL 的数据，主动传递给父亲节点；<br />\nexplain select (select 2) from t1;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#PIPE2: [6, 1, 0]<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#SPOOL2: [0, 1, 0]; key_num(1), spool_num(0)<br />\n#PRJT2: [0, 1, 0]; exp_num(1), is_atom(TRUE)<br />\n#CSCN2: [0, 1, 0]; SYSINDEXSYSDUAL(SYSDUAL)</p>\n</li>\n<li>\n<p>CSEK2<br />\n 聚集索引数据定位；(cluster index seek)<br />\nexplain select *from tx where c1 = 20;<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#CSEK2: [6, 1, 0]; scan_type(UNIQUE),INDEX33555479(TX), scan_range[20,20]</p>\n</li>\n<li>\n<p>SSEK2<br />\n2 级索引数据定位；(second index seek)<br />\ncreate index ind2 on tx(c2);<br />\nexplain select c2 from tx where c2 = 'aaa';<br />\n#NSET2: [6, 2500, 0]<br />\n#PRJT2: [6, 2500, 0]; exp_num(1), is_atom(FALSE)<br />\n#SSEK2: [6, 2500, 0]; scan_type(ASC), IND2(TX), scan_range[aaa,aaa]</p>\n</li>\n<li>\n<p>BLKUP2<br />\n (Batch lookup), 使用 2 级别索引的定位信息， 在聚集索引中查找数据<br />\n explain select * from tx where c2 = 'aaa';<br />\n#NSET2: [20, 2500, 0]<br />\n#PRJT2: [20, 2500, 0]; exp_num(4), is_atom(FALSE)<br />\n#BLKUP2: [20, 2500, 0]; IND2(TX)<br />\n#SSEK2: [20, 2500, 0]; scan_type(ASC), IND2(TX), scan_range[aaa,aaa]</p>\n</li>\n<li>\n<p>NEST LOOP SEMI JOIN2<br />\n 嵌套循环半连接。通常用于无法使用 HASH, 索引的不等值的 In/Exists；效率比较差。<br />\nexplain select * from t1 where exists (select * from t2 where t1.c1 &lt;&gt; t2.c1);<br />\n#NSET2: [19, 1, 0]<br />\n#PRJT2: [19, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#NEST LOOP SEMI JOIN2: [19, 1, 0]; join condition(T1.C1 &lt;&gt; T2.C1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555476(T2)</p>\n</li>\n<li>\n<p>NEST LOOP INDEX JOIN2<br />\n 嵌套循环索引连接 (IJI2)。 右表上有索引， 对于左表的每一行，利用索引在右表中定位。这是 DM6 中最常用的优化方式；DM7 由于 HASH 连接比较成熟，因此其重要性略有下降。<br />\nexplain select *from t1, tx where t1.c1 = tx.c1;<br />\n#NSET2: [26, 1, 0]<br />\n#PRJT2: [26, 1, 0]; exp_num(5), is_atom(FALSE)<br />\n#NEST LOOP INDEX JOIN2: [26, 1, 0]<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSEK2: [19, 1, 0]; scan_type(UNIQUE),INDEX33555479(TX), scan_range[T1.C1,T1.C1]</p>\n</li>\n<li>\n<p>HASH2 INNER JOIN<br />\nHASH 内连接（HI3）；无法利用索引时，系统一般采用 HASH 连接。<br />\nexplain select *from t1, t2 where t1.c1 = t2.c1;<br />\n#NSET2: [13, 1, 0]<br />\n#PRJT2: [13, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#HASH2 INNER JOIN: [13, 1, 0]; KEY_NUM(1);<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSCN2: [6, 1, 0]; INDEX33555476(T2)</p>\n</li>\n<li>\n<p>INDEX JOIN SEMI JOIN2<br />\n 索引半连接。在半连接的右表中，有索引可利用时使用，如下例 tx (c1) 上有索引。<br />\nexplain select *from t1 where exists (select * from tx where t1.c1 = tx.c1);<br />\n#NSET2: [8, 1, 0]<br />\n#PRJT2: [8, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#INDEX JOIN SEMI JOIN2: [8, 1, 0];<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSEK2: [19, 1, 0]; scan_type(UNIQUE), INDEX33555479(TX), scan_range[T1.C1,T1.C1]</p>\n</li>\n<li>\n<p>HASH RIGHT SEMI JOIN2<br />\nHASH 右半连接 (HRS2)。半连接一般情况下，总是在左表建立 HASH, 如果右表数据更少，则转化为右半连接。<br />\nexplain select * from tx where exists (select *from t1 where tx.c3 = t1.c2);<br />\n#NSET2: [40, 1, 0]<br />\n#PRJT2: [40, 1, 0]; exp_num(4), is_atom(FALSE)<br />\n#HASH RIGHT SEMI JOIN2: [40, 1, 0];<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>HASH RIGHT SEMI JOIN32<br />\nHASH 右半连接。这个专门用来处理 all/any/some 等谓词。但 all/any/some 不是必须用这个操作符。<br />\nexplain select *from tx where c3 &gt; all(select c2 from t1);<br />\n#NSET2: [30, 100000, 0]<br />\n#PRJT2: [30, 100000, 0]; exp_num(4), is_atom(FALSE)<br />\n#HASH RIGHT SEMI JOIN32: [30, 100000, 0]; op all;, join condition(TX.C3 &gt; DMTEMPVIEW_00001021.col_name)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)<br />\n#PRJT2: [6, 1, 0]; exp_num(1), is_atom(FALSE)<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)</p>\n</li>\n<li>\n<p>MERGE SEMI JOIN3<br />\n 归并半连接。如果连接的关键字正好是索引列，则可以使用。<br />\nexplain select * from tx a where exists (select *from tx b where a.c1 = b.c1 and b.c3 = 10);<br />\n#NSET2: [27, 2500, 0]<br />\n#PRJT2: [27, 2500, 0]; exp_num(4), is_atom(FALSE)<br />\n#MERGE SEMI JOIN3: [27, 2500, 0];<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)<br />\n#SLCT2: [23, 2500, 0]; TX.C3 = 10<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>CONST VALUE LIST<br />\n 系统自动创建的一个常量列表，用于与实体表做连接。<br />\nexplain select *from t1 where c1 in (1, 2, 3);<br />\n#NSET2: [6, 1, 0]<br />\n#PRJT2: [6, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#HASH2 INNER JOIN: [6, 1, 0]; KEY_NUM(1);<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CONST VALUE LIST: [0, 3, 0]; row_num(3), col_num(1)</p>\n</li>\n<li>\n<p>HEAP TABLE/HEAP TABLE SCAN<br />\n 有时，系统会把重复利用的中间保存在一个临时表中，这个表称为 HEAP TABLE; 与之配套的是，一个专门的扫描操作符号。(HTAB/HSCN)<br />\nexplain with v1 as<br />\n(select count(*) from tx)<br />\nselect *<br />\nfrom v1 a, v1 b;<br />\n#NSET2: [89, 1, 0]<br />\n#PIPE2: [89, 1, 0]<br />\n#PRJT2: [66, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#NEST LOOP INNER JOIN2: [66, 1, 0];<br />\n#HEAP TABLE SCAN: [22, 1, 0]; table_no(0),<br />\n#HEAP TABLE SCAN: [22, 1, 0]; table_no(0),<br />\n#HEAP TABLE: [22, 1, 0]; table_no(0),<br />\n#PRJT2: [22, 1, 0]; exp_num(1), is_atom(FALSE)<br />\n#FAGR2: [22, 1, 0]; sfun_num(1)</p>\n</li>\n<li>\n<p>FBTR<br />\nFill Btr, 填充 B 树。建索引的时候使用。一般不能用 explain 看，到， 但是建索引的时候，可以在 V$SQL_NODE_HISTORY 中查到 。</p>\n</li>\n<li>\n<p>UFLT<br />\n (Filter for Update from)，这是个用于实现 UPDATE FROM 语句 (SQL SERVER 兼容性) 的操作符号。以 rowid 作为 key，建 hash 表，如果下层数据过来没有 hash 匹配项则插入到 hash 表，<br />\nexplain update t1 set t1.c1 = tx.c2 from tx where t1.c2 = tx.c1;<br />\n#UPDATE : [0, 0, 0]; table(T1), type(select)<br />\n#TEMP TABLE SPOOL: [26, 1, 0]<br />\n#UFLT: [0, 0, 0]; IS_TOP_1(TRUE)<br />\n#PRJT2: [26, 1, 0]; exp_num(2), is_atom(FALSE)<br />\n#NEST LOOP INDEX JOIN2: [26, 1, 0]<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSEK2: [19, 1, 0]; scan_type(UNIQUE), INDEX33555479(TX), scan_range[T1.C2,T1.C2]</p>\n</li>\n<li>\n<p>HIERARCHICAL QUERY (CNNTB)<br />\n 用于实现层次查询。<br />\nexplain select * from tx connect by prior c1 = c2 start with c3 = 0;<br />\n#NSET2: [118773, 12500000, 0]<br />\n#PRJT2: [118773, 12500000, 0]; exp_num(3), is_atom(FALSE)<br />\n#HIERARCHICAL QUERY: [118773, 12500000, 0];<br />\n#PRJT2: [23, 2500, 0]; exp_num(4), is_atom(FALSE)<br />\n#SLCT2: [23, 2500, 0]; TX.C3 = 0<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)<br />\n#PRJT2: [23, 2500, 0]; exp_num(4), is_atom(FALSE)<br />\n#SLCT2: [23, 2500, 0]; var1 = exp_cast(TX.C2)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>INDEX JOIN LEFT JOIN2<br />\n 索引左外连接，使用右表的索引。<br />\nexplain select * from t1 left join tx on t1.c1 = tx.c1;<br />\n#NSET2: [26, 1, 0]<br />\n#PRJT2: [26, 1, 0]; exp_num(5), is_atom(FALSE)<br />\n#INDEX JOIN LEFT JOIN2: [26, 1, 0]<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)<br />\n#CSEK2: [19, 1, 0]; scan_type(UNIQUE), INDEX33555479(TX), scan_range[T1.C1,T1.C1]</p>\n</li>\n<li>\n<p>MPP BROADCAST<br />\nMpp 模式下，消息广播到各站点，包含必要的聚集函数合并计算</p>\n</li>\n<li>\n<p>MPP GATHER<br />\nMpp 模式下，消息收集到主站点</p>\n</li>\n<li>\n<p>MPP DISTRIBUTE<br />\nMpp 模式下，消息各站点的相互重分发， 一般在连接前做</p>\n</li>\n<li>\n<p>MPP SCATTER<br />\nMpp 模式下，主站点向各从站点广播消息</p>\n</li>\n<li>\n<p>PARALLEL<br />\n 水平分区表的并行查询</p>\n</li>\n<li>\n<p>RNSK<br />\n (Row number stop key), 实现 ORACLE 兼容的 rownum;<br />\nexplain select * from tx where rownum = 10;<br />\n#NSET2: [23, 100000, 0]<br />\n#PRJT2: [23, 100000, 0]; exp_num(4), is_atom(FALSE)<br />\n#RNSK: [23, 100000, 0]; rownum = exp_cast(10)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>CNTS<br />\n 用于实现全文索引的 CONTAINS</p>\n</li>\n<li>\n<p>SSCN<br />\n (second index scan), 直接使用 2 级索引进行扫描；<br />\nexplain select c2 from tx;<br />\n#NSET2: [22, 100000, 0]<br />\n#PRJT2: [22, 100000, 0]; exp_num(1), is_atom(FALSE)<br />\n#SSCN: [22, 100000, 0]; IND2(TX)</p>\n</li>\n<li>\n<p>AFUN<br />\n 分析函数计算。<br />\nexplain<br />\nSELECT c1, SUM(c3) OVER (PARTITION BY c1) FROM tx;<br />\n#NSET2: [23, 100000, 0]<br />\n#PRJT2: [23, 100000, 0]; exp_num(2), is_atom(FALSE)<br />\n#AFUN: [23, 100000, 0]; afun_num(1)<br />\n#CSCN2: [23, 100000, 0]; INDEX33555479(TX)</p>\n</li>\n<li>\n<p>PSCN/ASCN/ESCN<br />\nPSCN： 批量参数当作表来扫描<br />\n ASCN: 数组当作表来扫描<br />\n ESCN: 外部表扫描</p>\n</li>\n<li>\n<p>DISTINCT<br />\n 去重。<br />\nexplain select distinct c1 from tx;<br />\n#NSET2: [22, 1000, 0]<br />\n#PRJT2: [22, 1000, 0]; exp_num(1), is_atom(FALSE)<br />\n#DISTINCT: [22, 1000, 0]<br />\n#SSCN: [22, 100000, 0]; IND2(TX)</p>\n</li>\n<li>\n<p>HASH LEFT SEMI MUTIPLE JOIN<br />\n 多列 HASH 左半连接， 用于实现多列 IN。<br />\nexplain select * from t1 where (c1, c2) not in (select c1, c2 from tx);<br />\n#NSET2: [35, 1, 0]<br />\n#PRJT2: [35, 1, 0]; exp_num(3), is_atom(FALSE)<br />\n#HASH LEFT SEMI MULTIPLE JOIN: [35, 1, 0]; (ANTI), join condition((exp11 AND exp11))<br />\n#CSCN2: [6, 1, 0]; INDEX33555480(T1)</p>\n</li>\n<li>\n<p>REMOTE / LSET<br />\n 实现外部连接 (DBLINK)。<br />\nREMOTE: 远程查询；<br />\nLSET: 远程的结果集</p>\n</li>\n</ol>\n<h2 id=\"关于索引\"><a class=\"anchor\" href=\"#关于索引\">#</a> 关于索引</h2>\n<h2 id=\"索引适用范围\"><a class=\"anchor\" href=\"#索引适用范围\">#</a> 索引适用范围</h2>\n<p>在以下场景下可考虑创建索引：</p>\n<p>・仅当要通过索引访问表中很少的一部分行（1%~20%）。</p>\n<p>・索引可覆盖查询所需的所有列，不需额外去访问表。</p>\n<p><strong>注意</strong></p>\n<p>对于一个表来说索引并非越多越好，过多的索引将影响该表的 DML 效率。</p>\n<p>存在下列情况将导致无法使用索引：</p>\n<p>・组合索引中，条件列中没有组合索引的首列。</p>\n<p>・条件列带有函数或计算。</p>\n<p>索引排序是按照字段值进行排序的，字段值通过函数或计算后的值索引无法获取。</p>\n<p>・索引过滤性能不好时。</p>\n<p>如对一张 10 万条记录的表进行条件查询，获取 5 万条数据，通过索引进行查找效率低于全表扫描，将放弃使用索引。</p>\n<h2 id=\"如何查看执行计划\"><a class=\"anchor\" href=\"#如何查看执行计划\">#</a> 如何查看执行计划</h2>\n<p>mysql: explain select * from table</p>\n<p>dm: 看执行 id</p>\n<p>sqlserver:</p>\n<h2 id=\"优化sql语句的记录\"><a class=\"anchor\" href=\"#优化sql语句的记录\">#</a> 优化 sql 语句的记录</h2>\n<p><strong>通用方法：</strong></p>\n<p>看执行计划 优先优化 sace2（全表扫描）、 blkup（回表扫描）</p>\n<ol>\n<li>\n<p>select count (*) from xxxx; -- 看看这个表有多少行</p>\n</li>\n<li>\n<p>select xx,count (*) from xxx group by xx ; --xx 为过滤条件，看看每一个过滤条件的数据分布情况，确定数据分布均匀并能过滤较多的条件上建索引</p>\n</li>\n<li>\n<p>stat 100 on xxxx (xx); -- 更新统计信息</p>\n</li>\n<li>\n<p>看 SLCT2 看是否存在表达式的值</p>\n</li>\n<li>\n<p>分组一个查询字段看分布情况 如果均匀且没有空的值可以考虑在该字段建立索引，如果分布不均匀查询出来的数据太大 过滤性差就会影响查询速度</p>\n</li>\n<li>\n<p>看 BLKUP2（回表查询）尽量避免出现回表查询，如果不能避免尽量使得走回表前的结果集少</p>\n</li>\n<li>\n<p>看 CSCN2 全表扫描的情况</p>\n</li>\n</ol>\n<p>优化过程中可以通过以下 sql 查询 sql 的执行情况</p>\n<p>执行时间、io 等待时间等待</p>\n<p>如果 io 等待时间过程就要看看服务器 io 的使用情况了</p>\n<p>命令：iostat -d -x -k 1 10</p>\n<h3 id=\"案例一-达梦\"><a class=\"anchor\" href=\"#案例一-达梦\">#</a> 案例一 （达梦）：</h3>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 有一条这样的语句</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>distno<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> ywlx <span class=\"token operator\">=</span> <span class=\"token number\">4</span> <span class=\"token keyword\">then</span> <span class=\"token number\">1</span> <span class=\"token keyword\">else</span> <span class=\"token number\">0</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> zcjy_tdnz<span class=\"token punctuation\">.</span>openreportrecord <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>distno<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> zcjy_tdnz<span class=\"token punctuation\">.</span>openreportrecord</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">--19255177</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>执行计划</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">1</span>   <span class=\"token comment\">#NSET2: [3447, 1189, 52] </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token number\">2</span>     <span class=\"token comment\">#PRJT2: [3447, 1189, 52]; exp_num(3), is_atom(FALSE) </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">3</span>       <span class=\"token comment\">#HAGR2: [3447, 1189, 52]; grp_num(1), sfun_num(2), distinct_flag[0,0]; slave_empty(2) keys(DMTEMPVIEW_16778393.TMPCOL0) </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token number\">4</span>         <span class=\"token comment\">#LOCAL COLLECT: [3447, 1189, 52]; op_id(1) n_grp_by (0) n_cols(0) n_keys(0) for_sync(FALSE)</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">5</span>           <span class=\"token comment\">#HAGR2: [3447, 1189, 52]; grp_num(1), sfun_num(2), distinct_flag[0,0]; slave_empty(0) keys(DMTEMPVIEW_16778393.TMPCOL0) </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">6</span>             <span class=\"token comment\">#PRJT2: [2144, 18554643, 52]; exp_num(2), is_atom(FALSE) </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token number\">7</span>               <span class=\"token comment\">#SSCN: [2144, 18554643, 52]; ywlx_distno_20220211(OPENREPORTRECORD)</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>                                                                                                 </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>看第<span class=\"token number\">7</span>行  SSCN 表示走了索引</pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">2144</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18554643</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>表示 耗时<span class=\"token number\">2144</span>毫秒，查询的记录数为<span class=\"token number\">18554643</span>， 输出的字节数是<span class=\"token number\">52</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>这里可以看到总数有<span class=\"token number\">19255177</span>  走了索引查询的记录数为<span class=\"token number\">18554643</span>，过滤性很差</pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">-- 接着修改 直接筛选 ywlx = 4 为过滤条件</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>distno<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> ywlx <span class=\"token operator\">=</span> <span class=\"token number\">4</span> <span class=\"token keyword\">then</span> <span class=\"token number\">1</span> <span class=\"token keyword\">else</span> <span class=\"token number\">0</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> zcjy_tdnz<span class=\"token punctuation\">.</span>openreportrecord <span class=\"token keyword\">where</span> ywlx <span class=\"token operator\">=</span> <span class=\"token number\">4</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>distno<span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">1</span>   <span class=\"token comment\">#NSET2: [92, 1189, 52] </span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">2</span>     <span class=\"token comment\">#PRJT2: [92, 1189, 52]; exp_num(3), is_atom(FALSE) </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">3</span>       <span class=\"token comment\">#HAGR2: [92, 1189, 52]; grp_num(1), sfun_num(2), distinct_flag[0,0]; slave_empty(2) keys(DMTEMPVIEW_16778398.TMPCOL0) </span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">4</span>         <span class=\"token comment\">#LOCAL COLLECT: [92, 1189, 52]; op_id(1) n_grp_by (0) n_cols(0) n_keys(0) for_sync(FALSE)</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">5</span>           <span class=\"token comment\">#HAGR2: [92, 1189, 52]; grp_num(1), sfun_num(2), distinct_flag[0,0]; slave_empty(0) keys(DMTEMPVIEW_16778398.TMPCOL0) </span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">6</span>             <span class=\"token comment\">#PRJT2: [60, 449698, 52]; exp_num(2), is_atom(FALSE) </span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token number\">7</span>               <span class=\"token comment\">#SSEK2: [60, 449698, 52]; scan_type(ASC), ywlx_distno_20220211(OPENREPORTRECORD), scan_range[(4,min),(4,max))</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>看第<span class=\"token number\">7</span>行  SSEK2 表示走了索引</pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">[</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span> <span class=\"token number\">449698</span><span class=\"token punctuation\">,</span> <span class=\"token number\">52</span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>表示 耗时<span class=\"token number\">60</span>毫秒，查询的记录数为<span class=\"token number\">449698</span>， 输出的字节数是<span class=\"token number\">52</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>这里可以看到总数有<span class=\"token number\">19255177</span>  走了索引查询的记录数为<span class=\"token number\">449698</span>，过滤性就很好</pre></td></tr></table></figure><p>在程序中和在 sql 工具中 执行同一条 sql 语句前者比后者慢很多？</p>\n<p>原因：</p>\n<p>1、因为分页参数传递引起，把 #{} 换成 ${} 快了很多</p>\n<p>如果需要在函数中写动态的 sql 执行并且返回结果集 可以用下面的方法：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">create</span> <span class=\"token operator\">or</span> <span class=\"token keyword\">replace</span> <span class=\"token keyword\">FUNCTION</span> f_sjcxfx_jyxxcx_result<span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>v_sql <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">8000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>v_distNo <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>v_level <span class=\"token keyword\">INT</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>v_xmmc <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>v_xmbh <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>v_bdate <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>v_edate <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>v_jybh <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>v_jgzt <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>v_jyjg <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>v_blzt <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>v_jysq_bdate <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>v_jysq_edate <span class=\"token keyword\">VARCHAR</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">)</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">RETURN</span> sjcxfx_jyxxcx_table</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token operator\">is</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>v_test sjcxfx_jyxxcx_table :<span class=\"token operator\">=</span> sjcxfx_jyxxcx_table<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>results   sjcxfx_jyxxcx_table<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">begin</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">-- 创建返回的结果</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">/*create or replace type sjcxfx_jyxxcx_report as object(</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>distNo  VARCHAR(50),</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>distName  VARCHAR(50),</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>prj_no VARCHAR(200),</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>title VARCHAR(8000),</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>ztname VARCHAR(1000),</pre></td></tr><tr><td data-num=\"31\"></td><td><pre>jyjffs VARCHAR(50)</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>);</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>create or replace type sjcxfx_jyxxcx_table as table of sjcxfx_jyxxcx_report;*/</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> <span class=\"token string\">'select sjcxfx_jyxxcx_report(distNo, distName, prj_no, title, ztname, jyjffs) from proj where jyokflag=1 '</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">if</span> v_distNo <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and distno like '''</span><span class=\"token operator\">||</span>v_distNo<span class=\"token operator\">||</span><span class=\"token string\">'%'''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">if</span> v_xmmc <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and title like ''%'</span><span class=\"token operator\">||</span>v_xmmc<span class=\"token operator\">||</span><span class=\"token string\">'%'''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token keyword\">if</span> v_xmbh <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and prj_no like ''%'</span><span class=\"token operator\">||</span>v_xmbh<span class=\"token operator\">||</span><span class=\"token string\">'%'''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre></pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token keyword\">if</span> v_bdate <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and zhaobiao_pub_date >= '''</span><span class=\"token operator\">||</span>v_bdate<span class=\"token operator\">||</span><span class=\"token string\">''''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token keyword\">if</span> v_edate <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and zhaobiao_pub_date &lt;= '''</span><span class=\"token operator\">||</span>v_edate<span class=\"token operator\">||</span><span class=\"token string\">''''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre><span class=\"token keyword\">if</span> v_jybh <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and prj_jiaoyi_no like ''%'</span><span class=\"token operator\">||</span>v_jybh<span class=\"token operator\">||</span><span class=\"token string\">'%'''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre><span class=\"token keyword\">if</span> v_jyjg <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and endway = '''</span><span class=\"token operator\">||</span>v_jyjg<span class=\"token operator\">||</span><span class=\"token string\">''''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre><span class=\"token comment\">--</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre><span class=\"token keyword\">if</span> v_blzt <span class=\"token operator\">&lt;></span> <span class=\"token string\">''</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre><span class=\"token keyword\">then</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>\t<span class=\"token keyword\">set</span> v_sql <span class=\"token operator\">=</span> v_sql<span class=\"token operator\">||</span><span class=\"token string\">' and jyokflag = '</span><span class=\"token operator\">||</span>v_blzt<span class=\"token operator\">||</span><span class=\"token string\">''</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre><span class=\"token keyword\">end</span> <span class=\"token keyword\">if</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre></pre></td></tr><tr><td data-num=\"85\"></td><td><pre><span class=\"token keyword\">EXECUTE</span> IMMEDIATE v_sql <span class=\"token keyword\">BULK</span> COLLECT <span class=\"token keyword\">INTO</span> results<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre><span class=\"token keyword\">return</span> results<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre></pre></td></tr><tr><td data-num=\"89\"></td><td><pre><span class=\"token keyword\">end</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"案例二-starrocks\"><a class=\"anchor\" href=\"#案例二-starrocks\">#</a> 案例二 （StarRocks）：</h3>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>建表语句：</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gz_balance3<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>sno<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>acc_set<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>months<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">tinyint</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>sy<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>acc_code<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>acc_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>dr_cr<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>bal_year_begin<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>bal_month_begin<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>debit_month<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>credit_month<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>bal_month_end<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>debit_year<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>credit_year<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>benifit_month<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>benifit_year<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>oldacc_code<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tmpplace<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>optstyle<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>linkDistId<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years_months<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>len_acc_code<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">tinyint</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>_clientId<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>_clientUser<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>update_time_zl<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span>OLAP </pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>sno<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token keyword\">DISTRIBUTED</span> <span class=\"token keyword\">BY</span> <span class=\"token keyword\">HASH</span><span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>sno<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span> BUCKETS <span class=\"token number\">8</span> </pre></td></tr><tr><td data-num=\"32\"></td><td><pre>PROPERTIES <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token string\">\"replication_num\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token string\">\"in_memory\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"false\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token string\">\"enable_persistent_index\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token string\">\"replicated_storage\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token string\">\"compression\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"LZ4\"</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>注意： 总数据量 <span class=\"token operator\">-</span> <span class=\"token number\">5</span>亿</pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>语句：</pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token keyword\">select</span>   <span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> length<span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span>  <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>linkdistid<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> a<span class=\"token punctuation\">.</span>linkdistid <span class=\"token keyword\">end</span> distno<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">distinct</span> ifnull<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>acc_set<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">.</span>acc_set<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> zts<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> bqs<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> sqs<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token keyword\">then</span> <span class=\"token number\">0</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">end</span> zxl </pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token keyword\">from</span> gz_acc_set a <span class=\"token keyword\">left</span> <span class=\"token keyword\">outer</span> <span class=\"token keyword\">join</span> gz_balance3 b <span class=\"token keyword\">on</span> a<span class=\"token punctuation\">.</span>acc_set<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>acc_set </pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>YEARs<span class=\"token operator\">=</span><span class=\"token number\">2015</span> <span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>months<span class=\"token operator\">=</span><span class=\"token number\">4</span> </pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>acc_code <span class=\"token operator\">like</span> <span class=\"token string\">'522%'</span> </pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token keyword\">left</span> <span class=\"token keyword\">outer</span> <span class=\"token keyword\">join</span>  gz_balance3 c <span class=\"token keyword\">on</span> a<span class=\"token punctuation\">.</span>acc_set<span class=\"token operator\">=</span>c<span class=\"token punctuation\">.</span>acc_set </pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>YEARs<span class=\"token operator\">*</span><span class=\"token number\">12</span><span class=\"token operator\">+</span>c<span class=\"token punctuation\">.</span>months<span class=\"token operator\">=</span><span class=\"token number\">2015</span><span class=\"token operator\">*</span><span class=\"token number\">12</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>acc_code <span class=\"token operator\">like</span> <span class=\"token string\">'522%'</span> </pre></td></tr><tr><td data-num=\"54\"></td><td><pre><span class=\"token keyword\">where</span> b<span class=\"token punctuation\">.</span>debit_month<span class=\"token operator\">+</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token operator\">>=</span><span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>dwlx <span class=\"token operator\">=</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token string\">'全部'</span><span class=\"token operator\">=</span><span class=\"token string\">'全部'</span> <span class=\"token keyword\">then</span> dwlx <span class=\"token keyword\">else</span> <span class=\"token string\">'全部'</span> <span class=\"token keyword\">end</span> </pre></td></tr><tr><td data-num=\"56\"></td><td><pre><span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>linkDistId <span class=\"token operator\">like</span> <span class=\"token string\">'01%'</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> <span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> length<span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span>  <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>linkdistid<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> a<span class=\"token punctuation\">.</span>linkdistid <span class=\"token keyword\">end</span> </pre></td></tr><tr><td data-num=\"57\"></td><td><pre><span class=\"token operator\">></span> OK</pre></td></tr><tr><td data-num=\"58\"></td><td><pre><span class=\"token operator\">></span> 查询时间: <span class=\"token number\">9.958</span>s  原本需要查询<span class=\"token number\">9</span>秒</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>上面的 <span class=\"token number\">01</span>、 <span class=\"token number\">2015</span>、 months <span class=\"token operator\">=</span> <span class=\"token number\">4</span> 中的<span class=\"token number\">4</span> 都是程序会替换的直接变量</pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>下面是<span class=\"token keyword\">explain</span> 的执行计划（只显示耗时最长的节点）</pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token keyword\">PLAN</span> FRAGMENT <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre> OUTPUT EXPRS:</pre></td></tr><tr><td data-num=\"66\"></td><td><pre>  <span class=\"token keyword\">PARTITION</span>: RANDOM</pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>  STREAM <span class=\"token keyword\">DATA</span> SINK</pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    EXCHANGE ID: <span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    UNPARTITIONED</pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>  <span class=\"token number\">7</span>:Project</pre></td></tr><tr><td data-num=\"73\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">60</span><span class=\"token operator\">></span> : <span class=\"token number\">60</span>: acc_set</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">68</span><span class=\"token operator\">></span> : <span class=\"token number\">68</span>: debit_month</pre></td></tr><tr><td data-num=\"75\"></td><td><pre>  <span class=\"token operator\">|</span>  </pre></td></tr><tr><td data-num=\"76\"></td><td><pre>  <span class=\"token number\">6</span>:OlapScanNode</pre></td></tr><tr><td data-num=\"77\"></td><td><pre>     <span class=\"token keyword\">TABLE</span>: gz_balance3</pre></td></tr><tr><td data-num=\"78\"></td><td><pre>     PREAGGREGATION: <span class=\"token keyword\">ON</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>     PREDICATES: CAST<span class=\"token punctuation\">(</span><span class=\"token number\">59</span>: years <span class=\"token keyword\">AS</span> <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">+</span> CAST<span class=\"token punctuation\">(</span><span class=\"token number\">61</span>: months <span class=\"token keyword\">AS</span> <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">24183</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>     rollup: gz_balance3</pre></td></tr><tr><td data-num=\"82\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>     tabletList<span class=\"token operator\">=</span><span class=\"token number\">45545</span><span class=\"token punctuation\">,</span><span class=\"token number\">45547</span><span class=\"token punctuation\">,</span><span class=\"token number\">45549</span><span class=\"token punctuation\">,</span><span class=\"token number\">45551</span><span class=\"token punctuation\">,</span><span class=\"token number\">45553</span><span class=\"token punctuation\">,</span><span class=\"token number\">45555</span><span class=\"token punctuation\">,</span><span class=\"token number\">45557</span><span class=\"token punctuation\">,</span><span class=\"token number\">45559</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>     cardinality<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>     avgRowSize<span class=\"token operator\">=</span><span class=\"token number\">17.700815</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre></pre></td></tr><tr><td data-num=\"88\"></td><td><pre><span class=\"token keyword\">explain</span> <span class=\"token keyword\">analyze</span>  查询Query Profile信息（只显示 最耗时的节点的信息）</pre></td></tr><tr><td data-num=\"89\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mFragment <span class=\"token number\">3</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"90\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mBackendNum: <span class=\"token number\">1</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"91\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mInstancePeakMemoryUsage: <span class=\"token number\">26.688</span> MB<span class=\"token punctuation\">,</span> InstanceAllocatedMemoryUsage: <span class=\"token number\">42.205</span> GB\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"92\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPrepareTime: <span class=\"token number\">409.670</span>us\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"93\"></td><td><pre>└──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mDATA_STREAM_SINK <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"94\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionType: UNPARTITIONED\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"95\"></td><td><pre>   └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPROJECT <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"96\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: ?<span class=\"token punctuation\">,</span> cpu: ?<span class=\"token punctuation\">,</span> memory: ?<span class=\"token punctuation\">,</span> network: ?<span class=\"token punctuation\">,</span> cost: ?<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"97\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mTotalTime: <span class=\"token number\">51.620</span>us <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">51.620</span>us<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"98\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mOutputRows: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"99\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mExpression: <span class=\"token punctuation\">[</span><span class=\"token number\">60</span>: acc_set<span class=\"token punctuation\">,</span> <span class=\"token number\">68</span>: debit_month<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"100\"></td><td><pre>      └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"101\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> cpu: <span class=\"token number\">17.70</span><span class=\"token punctuation\">,</span> memory: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> network: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> cost: <span class=\"token number\">8.85</span><span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"102\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTotalTime: <span class=\"token number\">11</span>s76ms <span class=\"token punctuation\">(</span><span class=\"token number\">86.07</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">39.997</span>ms<span class=\"token punctuation\">,</span> ScanTime: <span class=\"token number\">11</span>s36ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"103\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOutputRows: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"104\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTable: : gz_balance3\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"105\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSubordinateOperators: \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"106\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mCHUNK_ACCUMULATE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"107\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mNOOP\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"108\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN_PREPARE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"109\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mDetail Timers: <span class=\"token punctuation\">[</span>ScanTime <span class=\"token operator\">=</span> IOTaskExecTime <span class=\"token operator\">+</span> IOTaskWaitTime<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"110\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskExecTime: <span class=\"token number\">10</span>s491ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">9</span>s946ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">11</span>s20ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"111\"></td><td><pre>                     \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSegmentRead: <span class=\"token number\">10</span>s230ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">9</span>s655ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">10</span>s728ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"112\"></td><td><pre>                         \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mBlockFetch: <span class=\"token number\">9</span>s270ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">8</span>s756ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">9</span>s745ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"113\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskWaitTime: <span class=\"token number\">29.425</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">13.810</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">45.469</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"114\"></td><td><pre></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"116\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"117\"></td><td><pre>从上面的信息可以发现 Fragment <span class=\"token number\">3</span>的耗时最长，并且可以看到分配的内存也非常的高 InstanceAllocatedMemoryUsage: <span class=\"token number\">42.205</span> GB</pre></td></tr><tr><td data-num=\"118\"></td><td><pre>定位到对应的执行内容为：</pre></td></tr><tr><td data-num=\"119\"></td><td><pre>                                                                                 </pre></td></tr><tr><td data-num=\"120\"></td><td><pre><span class=\"token keyword\">PLAN</span> FRAGMENT <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre> OUTPUT EXPRS:</pre></td></tr><tr><td data-num=\"122\"></td><td><pre>  <span class=\"token keyword\">PARTITION</span>: RANDOM</pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>  STREAM <span class=\"token keyword\">DATA</span> SINK</pre></td></tr><tr><td data-num=\"125\"></td><td><pre>    EXCHANGE ID: <span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>    UNPARTITIONED</pre></td></tr><tr><td data-num=\"127\"></td><td><pre></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>  <span class=\"token number\">7</span>:Project</pre></td></tr><tr><td data-num=\"129\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">60</span><span class=\"token operator\">></span> : <span class=\"token number\">60</span>: acc_set</pre></td></tr><tr><td data-num=\"130\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">68</span><span class=\"token operator\">></span> : <span class=\"token number\">68</span>: debit_month</pre></td></tr><tr><td data-num=\"131\"></td><td><pre>  <span class=\"token operator\">|</span>  </pre></td></tr><tr><td data-num=\"132\"></td><td><pre>  <span class=\"token number\">6</span>:OlapScanNode</pre></td></tr><tr><td data-num=\"133\"></td><td><pre>     <span class=\"token keyword\">TABLE</span>: gz_balance3</pre></td></tr><tr><td data-num=\"134\"></td><td><pre>     PREAGGREGATION: <span class=\"token keyword\">ON</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>     PREDICATES: CAST<span class=\"token punctuation\">(</span><span class=\"token number\">59</span>: years <span class=\"token keyword\">AS</span> <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">+</span> CAST<span class=\"token punctuation\">(</span><span class=\"token number\">61</span>: months <span class=\"token keyword\">AS</span> <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">24183</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>     rollup: gz_balance3</pre></td></tr><tr><td data-num=\"138\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>     tabletList<span class=\"token operator\">=</span><span class=\"token number\">45545</span><span class=\"token punctuation\">,</span><span class=\"token number\">45547</span><span class=\"token punctuation\">,</span><span class=\"token number\">45549</span><span class=\"token punctuation\">,</span><span class=\"token number\">45551</span><span class=\"token punctuation\">,</span><span class=\"token number\">45553</span><span class=\"token punctuation\">,</span><span class=\"token number\">45555</span><span class=\"token punctuation\">,</span><span class=\"token number\">45557</span><span class=\"token punctuation\">,</span><span class=\"token number\">45559</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>     cardinality<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>     avgRowSize<span class=\"token operator\">=</span><span class=\"token number\">17.700815</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>  partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span>：表示总共一个分区，在一个分区里查询</pre></td></tr><tr><td data-num=\"144\"></td><td><pre>  tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span>： 表示总共<span class=\"token number\">8</span>个桶，扫描了<span class=\"token number\">8</span>个桶的内容</pre></td></tr><tr><td data-num=\"145\"></td><td><pre>  PREDICATES: CAST<span class=\"token punctuation\">(</span><span class=\"token number\">59</span>: years <span class=\"token keyword\">AS</span> <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">12</span> <span class=\"token operator\">+</span> CAST<span class=\"token punctuation\">(</span><span class=\"token number\">61</span>: months <span class=\"token keyword\">AS</span> <span class=\"token keyword\">BIGINT</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token number\">24183</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>  从这里可以看出 是这个过滤条件运算花费的时间比较长，从这里入手优化 要结合实际的情况优化</pre></td></tr><tr><td data-num=\"147\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"148\"></td><td><pre>  比如我这里的语句中过滤条件是：</pre></td></tr><tr><td data-num=\"149\"></td><td><pre>  <span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>YEARs<span class=\"token operator\">*</span><span class=\"token number\">12</span><span class=\"token operator\">+</span>c<span class=\"token punctuation\">.</span>months<span class=\"token operator\">=</span><span class=\"token number\">2015</span><span class=\"token operator\">*</span><span class=\"token number\">12</span><span class=\"token operator\">+</span><span class=\"token number\">4</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> 中 c<span class=\"token punctuation\">.</span>YEARs<span class=\"token operator\">*</span><span class=\"token number\">12</span><span class=\"token operator\">+</span>c<span class=\"token punctuation\">.</span>months 做了运算 无法直接过滤数据</pre></td></tr><tr><td data-num=\"150\"></td><td><pre>  这里想要的效果是表示我需要查询上一个月份的数据 那么其实可以 优化这个条件且不需要做运算<span class=\"token punctuation\">,</span>可以改成以下语句：</pre></td></tr><tr><td data-num=\"151\"></td><td><pre>  <span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>years <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token number\">2015</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token keyword\">else</span> <span class=\"token number\">2015</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>months <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token number\">12</span> <span class=\"token keyword\">else</span> <span class=\"token number\">4</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> 其中<span class=\"token number\">2015</span>、 <span class=\"token number\">4</span>、 都是传入的值</pre></td></tr><tr><td data-num=\"152\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"153\"></td><td><pre>修改之后的语句：</pre></td></tr><tr><td data-num=\"154\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> length<span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span>  <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>linkdistid<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> a<span class=\"token punctuation\">.</span>linkdistid <span class=\"token keyword\">end</span> distno<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"155\"></td><td><pre><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">distinct</span> ifnull<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>acc_set<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">.</span>acc_set<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> zts<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre><span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> bqs<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre><span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> sqs<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token keyword\">then</span> <span class=\"token number\">0</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">end</span> zxl </pre></td></tr><tr><td data-num=\"159\"></td><td><pre><span class=\"token keyword\">from</span> gz_acc_set a <span class=\"token keyword\">left</span> <span class=\"token keyword\">outer</span> <span class=\"token keyword\">join</span> gz_balance3 b <span class=\"token keyword\">on</span> a<span class=\"token punctuation\">.</span>acc_set<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>acc_set </pre></td></tr><tr><td data-num=\"160\"></td><td><pre><span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>YEARs<span class=\"token operator\">=</span><span class=\"token number\">2015</span> <span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>months<span class=\"token operator\">=</span><span class=\"token number\">4</span> </pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>acc_code <span class=\"token operator\">like</span> <span class=\"token string\">'522%'</span> </pre></td></tr><tr><td data-num=\"162\"></td><td><pre><span class=\"token keyword\">left</span> <span class=\"token keyword\">outer</span> <span class=\"token keyword\">join</span>  gz_balance3 c <span class=\"token keyword\">on</span> a<span class=\"token punctuation\">.</span>acc_set<span class=\"token operator\">=</span>c<span class=\"token punctuation\">.</span>acc_set </pre></td></tr><tr><td data-num=\"163\"></td><td><pre><span class=\"token comment\">--and c.YEARs*12+c.months=2015*12+4-1 </span></pre></td></tr><tr><td data-num=\"164\"></td><td><pre><span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>years <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token number\">2015</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token keyword\">else</span> <span class=\"token number\">2015</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>months <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token number\">12</span> <span class=\"token keyword\">else</span> <span class=\"token number\">4</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"165\"></td><td><pre><span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>acc_code <span class=\"token operator\">like</span> <span class=\"token string\">'522%'</span> </pre></td></tr><tr><td data-num=\"166\"></td><td><pre><span class=\"token keyword\">where</span> b<span class=\"token punctuation\">.</span>debit_month<span class=\"token operator\">+</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token operator\">>=</span><span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"167\"></td><td><pre><span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>dwlx <span class=\"token operator\">=</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token string\">'全部'</span><span class=\"token operator\">=</span><span class=\"token string\">'全部'</span> <span class=\"token keyword\">then</span> dwlx <span class=\"token keyword\">else</span> <span class=\"token string\">'全部'</span> <span class=\"token keyword\">end</span> </pre></td></tr><tr><td data-num=\"168\"></td><td><pre><span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>linkDistId <span class=\"token operator\">like</span> <span class=\"token string\">'01%'</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> <span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> length<span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span>  <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>linkdistid<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> a<span class=\"token punctuation\">.</span>linkdistid <span class=\"token keyword\">end</span> </pre></td></tr><tr><td data-num=\"169\"></td><td><pre><span class=\"token operator\">></span> OK</pre></td></tr><tr><td data-num=\"170\"></td><td><pre><span class=\"token operator\">></span> 查询时间: <span class=\"token number\">2.384</span>s</pre></td></tr><tr><td data-num=\"171\"></td><td><pre></pre></td></tr><tr><td data-num=\"172\"></td><td><pre>缩短了<span class=\"token number\">8</span>秒！</pre></td></tr><tr><td data-num=\"173\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"174\"></td><td><pre>执行计划：（只显示关心的）</pre></td></tr><tr><td data-num=\"175\"></td><td><pre><span class=\"token keyword\">PLAN</span> FRAGMENT <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"176\"></td><td><pre> OUTPUT EXPRS:</pre></td></tr><tr><td data-num=\"177\"></td><td><pre>  <span class=\"token keyword\">PARTITION</span>: RANDOM</pre></td></tr><tr><td data-num=\"178\"></td><td><pre></pre></td></tr><tr><td data-num=\"179\"></td><td><pre>  STREAM <span class=\"token keyword\">DATA</span> SINK</pre></td></tr><tr><td data-num=\"180\"></td><td><pre>    EXCHANGE ID: <span class=\"token number\">08</span></pre></td></tr><tr><td data-num=\"181\"></td><td><pre>    UNPARTITIONED</pre></td></tr><tr><td data-num=\"182\"></td><td><pre></pre></td></tr><tr><td data-num=\"183\"></td><td><pre>  <span class=\"token number\">7</span>:Project</pre></td></tr><tr><td data-num=\"184\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">60</span><span class=\"token operator\">></span> : <span class=\"token number\">60</span>: acc_set</pre></td></tr><tr><td data-num=\"185\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">68</span><span class=\"token operator\">></span> : <span class=\"token number\">68</span>: debit_month</pre></td></tr><tr><td data-num=\"186\"></td><td><pre>  <span class=\"token operator\">|</span>  </pre></td></tr><tr><td data-num=\"187\"></td><td><pre>  <span class=\"token number\">6</span>:OlapScanNode</pre></td></tr><tr><td data-num=\"188\"></td><td><pre>     <span class=\"token keyword\">TABLE</span>: gz_balance3</pre></td></tr><tr><td data-num=\"189\"></td><td><pre>     PREAGGREGATION: <span class=\"token keyword\">ON</span></pre></td></tr><tr><td data-num=\"190\"></td><td><pre>     PREDICATES: <span class=\"token number\">59</span>: years <span class=\"token operator\">=</span> <span class=\"token number\">2015</span><span class=\"token punctuation\">,</span> <span class=\"token number\">61</span>: months <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"191\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"192\"></td><td><pre>     rollup: gz_balance3</pre></td></tr><tr><td data-num=\"193\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"194\"></td><td><pre>     tabletList<span class=\"token operator\">=</span><span class=\"token number\">45545</span><span class=\"token punctuation\">,</span><span class=\"token number\">45547</span><span class=\"token punctuation\">,</span><span class=\"token number\">45549</span><span class=\"token punctuation\">,</span><span class=\"token number\">45551</span><span class=\"token punctuation\">,</span><span class=\"token number\">45553</span><span class=\"token punctuation\">,</span><span class=\"token number\">45555</span><span class=\"token punctuation\">,</span><span class=\"token number\">45557</span><span class=\"token punctuation\">,</span><span class=\"token number\">45559</span></pre></td></tr><tr><td data-num=\"195\"></td><td><pre>     cardinality<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"196\"></td><td><pre>     avgRowSize<span class=\"token operator\">=</span><span class=\"token number\">17.700815</span></pre></td></tr><tr><td data-num=\"197\"></td><td><pre></pre></td></tr><tr><td data-num=\"198\"></td><td><pre><span class=\"token keyword\">PLAN</span> FRAGMENT <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"199\"></td><td><pre> OUTPUT EXPRS:</pre></td></tr><tr><td data-num=\"200\"></td><td><pre>  <span class=\"token keyword\">PARTITION</span>: RANDOM</pre></td></tr><tr><td data-num=\"201\"></td><td><pre></pre></td></tr><tr><td data-num=\"202\"></td><td><pre>  STREAM <span class=\"token keyword\">DATA</span> SINK</pre></td></tr><tr><td data-num=\"203\"></td><td><pre>    EXCHANGE ID: <span class=\"token number\">04</span></pre></td></tr><tr><td data-num=\"204\"></td><td><pre>    UNPARTITIONED</pre></td></tr><tr><td data-num=\"205\"></td><td><pre></pre></td></tr><tr><td data-num=\"206\"></td><td><pre>  <span class=\"token number\">3</span>:Project</pre></td></tr><tr><td data-num=\"207\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">34</span><span class=\"token operator\">></span> : <span class=\"token number\">34</span>: acc_set</pre></td></tr><tr><td data-num=\"208\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">42</span><span class=\"token operator\">></span> : <span class=\"token number\">42</span>: debit_month</pre></td></tr><tr><td data-num=\"209\"></td><td><pre>  <span class=\"token operator\">|</span>  </pre></td></tr><tr><td data-num=\"210\"></td><td><pre>  <span class=\"token number\">2</span>:OlapScanNode</pre></td></tr><tr><td data-num=\"211\"></td><td><pre>     <span class=\"token keyword\">TABLE</span>: gz_balance3</pre></td></tr><tr><td data-num=\"212\"></td><td><pre>     PREAGGREGATION: <span class=\"token keyword\">ON</span></pre></td></tr><tr><td data-num=\"213\"></td><td><pre>     PREDICATES: <span class=\"token number\">33</span>: years <span class=\"token operator\">=</span> <span class=\"token number\">2015</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span>: months <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"214\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"215\"></td><td><pre>     rollup: gz_balance3</pre></td></tr><tr><td data-num=\"216\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"217\"></td><td><pre>     tabletList<span class=\"token operator\">=</span><span class=\"token number\">45545</span><span class=\"token punctuation\">,</span><span class=\"token number\">45547</span><span class=\"token punctuation\">,</span><span class=\"token number\">45549</span><span class=\"token punctuation\">,</span><span class=\"token number\">45551</span><span class=\"token punctuation\">,</span><span class=\"token number\">45553</span><span class=\"token punctuation\">,</span><span class=\"token number\">45555</span><span class=\"token punctuation\">,</span><span class=\"token number\">45557</span><span class=\"token punctuation\">,</span><span class=\"token number\">45559</span></pre></td></tr><tr><td data-num=\"218\"></td><td><pre>     cardinality<span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"219\"></td><td><pre>     avgRowSize<span class=\"token operator\">=</span><span class=\"token number\">17.700815</span></pre></td></tr><tr><td data-num=\"220\"></td><td><pre></pre></td></tr><tr><td data-num=\"221\"></td><td><pre><span class=\"token keyword\">explain</span> <span class=\"token keyword\">analyze</span></pre></td></tr><tr><td data-num=\"222\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"223\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mFragment <span class=\"token number\">3</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"224\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mBackendNum: <span class=\"token number\">1</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"225\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mInstancePeakMemoryUsage: <span class=\"token number\">11.233</span> MB<span class=\"token punctuation\">,</span> InstanceAllocatedMemoryUsage: <span class=\"token number\">1.892</span> GB\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"226\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPrepareTime: <span class=\"token number\">388.670</span>us\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"227\"></td><td><pre>└──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mDATA_STREAM_SINK <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"228\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionType: UNPARTITIONED\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"229\"></td><td><pre>   └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPROJECT <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">7</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"230\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: ?<span class=\"token punctuation\">,</span> cpu: ?<span class=\"token punctuation\">,</span> memory: ?<span class=\"token punctuation\">,</span> network: ?<span class=\"token punctuation\">,</span> cost: ?<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"231\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mTotalTime: <span class=\"token number\">39.300</span>us <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">39.300</span>us<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"232\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mOutputRows: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"233\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mExpression: <span class=\"token punctuation\">[</span><span class=\"token number\">60</span>: acc_set<span class=\"token punctuation\">,</span> <span class=\"token number\">68</span>: debit_month<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"234\"></td><td><pre>      └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"235\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> cpu: <span class=\"token number\">17.70</span><span class=\"token punctuation\">,</span> memory: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> network: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> cost: <span class=\"token number\">8.85</span><span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"236\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTotalTime: <span class=\"token number\">451.245</span>ms <span class=\"token punctuation\">(</span><span class=\"token number\">48.60</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">1.948</span>ms<span class=\"token punctuation\">,</span> ScanTime: <span class=\"token number\">449.296</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"237\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOutputRows: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"238\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTable: : gz_balance3\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"239\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSubordinateOperators: \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"240\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mCHUNK_ACCUMULATE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"241\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mNOOP\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"242\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN_PREPARE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"243\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mDetail Timers: <span class=\"token punctuation\">[</span>ScanTime <span class=\"token operator\">=</span> IOTaskExecTime <span class=\"token operator\">+</span> IOTaskWaitTime<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"244\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskExecTime: <span class=\"token number\">349.445</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">267.150</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">446.469</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"245\"></td><td><pre>                     \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSegmentRead: <span class=\"token number\">333.591</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">252.794</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">434.923</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"246\"></td><td><pre>                         \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mBlockFetch: <span class=\"token number\">274.072</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">198.346</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">368.110</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"247\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskWaitTime: <span class=\"token number\">6.920</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">143.380</span>us<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">28.939</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"248\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"249\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mFragment <span class=\"token number\">4</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"250\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mBackendNum: <span class=\"token number\">1</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"251\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mInstancePeakMemoryUsage: <span class=\"token number\">13.604</span> MB<span class=\"token punctuation\">,</span> InstanceAllocatedMemoryUsage: <span class=\"token number\">1.965</span> GB\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"252\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPrepareTime: <span class=\"token number\">419.470</span>us\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"253\"></td><td><pre>└──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mDATA_STREAM_SINK <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"254\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionType: UNPARTITIONED\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"255\"></td><td><pre>   └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPROJECT <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"256\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: ?<span class=\"token punctuation\">,</span> cpu: ?<span class=\"token punctuation\">,</span> memory: ?<span class=\"token punctuation\">,</span> network: ?<span class=\"token punctuation\">,</span> cost: ?<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"257\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mTotalTime: <span class=\"token number\">56.350</span>us <span class=\"token punctuation\">(</span><span class=\"token number\">0.01</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">56.350</span>us<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"258\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mOutputRows: <span class=\"token number\">71.245</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71245</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"259\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mExpression: <span class=\"token punctuation\">[</span><span class=\"token number\">34</span>: acc_set<span class=\"token punctuation\">,</span> <span class=\"token number\">42</span>: debit_month<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"260\"></td><td><pre>      └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"261\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> cpu: <span class=\"token number\">17.70</span><span class=\"token punctuation\">,</span> memory: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> network: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> cost: <span class=\"token number\">8.85</span><span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"262\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTotalTime: <span class=\"token number\">450.460</span>ms <span class=\"token punctuation\">(</span><span class=\"token number\">48.51</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">14.747</span>ms<span class=\"token punctuation\">,</span> ScanTime: <span class=\"token number\">435.712</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"263\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOutputRows: <span class=\"token number\">71.245</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71245</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"264\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTable: : gz_balance3\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"265\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSubordinateOperators: \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"266\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mCHUNK_ACCUMULATE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"267\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mNOOP\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"268\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN_PREPARE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"269\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mDetail Timers: <span class=\"token punctuation\">[</span>ScanTime <span class=\"token operator\">=</span> IOTaskExecTime <span class=\"token operator\">+</span> IOTaskWaitTime<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"270\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskExecTime: <span class=\"token number\">375.914</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">303.763</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">426.845</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"271\"></td><td><pre>                     \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSegmentRead: <span class=\"token number\">359.928</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">285.005</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">410.825</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"272\"></td><td><pre>                         \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mBlockFetch: <span class=\"token number\">281.056</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">223.391</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">328.108</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"273\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskWaitTime: <span class=\"token number\">9.453</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">214.510</span>us<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">24.273</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"274\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"275\"></td><td><pre></pre></td></tr><tr><td data-num=\"276\"></td><td><pre>从上面的执行计划中可以看出 时间大大缩短了 而且内存消耗也大大减少了 InstanceAllocatedMemoryUsage: <span class=\"token number\">1.965</span> GB</pre></td></tr><tr><td data-num=\"277\"></td><td><pre></pre></td></tr><tr><td data-num=\"278\"></td><td><pre>还可以继续优化，通过上面的执行计划可以发现我这里只有<span class=\"token number\">1</span>个分区，我们根据年份分组查询数据：</pre></td></tr><tr><td data-num=\"279\"></td><td><pre><span class=\"token keyword\">select</span> years<span class=\"token punctuation\">,</span> <span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> gz_balance <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> years</pre></td></tr><tr><td data-num=\"280\"></td><td><pre></pre></td></tr><tr><td data-num=\"281\"></td><td><pre><span class=\"token number\">2016</span>\t<span class=\"token number\">48503278</span></pre></td></tr><tr><td data-num=\"282\"></td><td><pre><span class=\"token number\">2019</span>\t<span class=\"token number\">56560829</span></pre></td></tr><tr><td data-num=\"283\"></td><td><pre><span class=\"token number\">2018</span>\t<span class=\"token number\">57214609</span></pre></td></tr><tr><td data-num=\"284\"></td><td><pre><span class=\"token number\">2015</span>\t<span class=\"token number\">44546275</span></pre></td></tr><tr><td data-num=\"285\"></td><td><pre><span class=\"token number\">2020</span>\t<span class=\"token number\">58545580</span></pre></td></tr><tr><td data-num=\"286\"></td><td><pre><span class=\"token number\">2021</span>\t<span class=\"token number\">58165822</span></pre></td></tr><tr><td data-num=\"287\"></td><td><pre><span class=\"token number\">2017</span>\t<span class=\"token number\">58700094</span></pre></td></tr><tr><td data-num=\"288\"></td><td><pre><span class=\"token number\">2023</span>\t<span class=\"token number\">56764942</span></pre></td></tr><tr><td data-num=\"289\"></td><td><pre><span class=\"token number\">2022</span>\t<span class=\"token number\">62766491</span></pre></td></tr><tr><td data-num=\"290\"></td><td><pre>看结果可以知道 每年的数据很平均 那么可以根据年份建立索引或者分区，这里选择分区</pre></td></tr><tr><td data-num=\"291\"></td><td><pre><span class=\"token keyword\">CREATE</span> <span class=\"token keyword\">TABLE</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>gz_balance<span class=\"token punctuation\">`</span></span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"292\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>sno<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"293\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"294\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>acc_set<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">NOT</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"295\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>months<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">tinyint</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"296\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>sy<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"297\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>acc_code<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"298\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>acc_name<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"299\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>dr_cr<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"300\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>bal_year_begin<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"301\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>bal_month_begin<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"302\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>debit_month<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"303\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>credit_month<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"304\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>bal_month_end<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"305\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>debit_year<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"306\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>credit_year<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"307\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>benifit_month<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"308\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>benifit_year<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">decimal</span><span class=\"token punctuation\">(</span><span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"309\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>oldacc_code<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"310\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>tmpplace<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"311\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>optstyle<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"312\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>linkDistId<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"313\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years_months<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"314\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>len_acc_code<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">tinyint</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"315\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>_clientId<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">int</span><span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"316\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>_clientUser<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">varchar</span><span class=\"token punctuation\">(</span><span class=\"token number\">65533</span><span class=\"token punctuation\">)</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"317\"></td><td><pre>  <span class=\"token identifier\"><span class=\"token punctuation\">`</span>update_time_zl<span class=\"token punctuation\">`</span></span> <span class=\"token keyword\">datetime</span> <span class=\"token boolean\">NULL</span> <span class=\"token keyword\">COMMENT</span> <span class=\"token string\">\"\"</span></pre></td></tr><tr><td data-num=\"318\"></td><td><pre><span class=\"token punctuation\">)</span> <span class=\"token keyword\">ENGINE</span><span class=\"token operator\">=</span>OLAP </pre></td></tr><tr><td data-num=\"319\"></td><td><pre><span class=\"token keyword\">PRIMARY</span> <span class=\"token keyword\">KEY</span><span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>sno<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"320\"></td><td><pre><span class=\"token keyword\">PARTITION</span> <span class=\"token keyword\">BY</span> RANGE <span class=\"token punctuation\">(</span>years<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"321\"></td><td><pre>    <span class=\"token keyword\">START</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"2014\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">END</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"2060\"</span><span class=\"token punctuation\">)</span> EVERY <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"322\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"323\"></td><td><pre><span class=\"token keyword\">DISTRIBUTED</span> <span class=\"token keyword\">BY</span> <span class=\"token keyword\">HASH</span><span class=\"token punctuation\">(</span><span class=\"token identifier\"><span class=\"token punctuation\">`</span>sno<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token identifier\"><span class=\"token punctuation\">`</span>years<span class=\"token punctuation\">`</span></span><span class=\"token punctuation\">)</span> BUCKETS <span class=\"token number\">8</span> </pre></td></tr><tr><td data-num=\"324\"></td><td><pre>PROPERTIES <span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"325\"></td><td><pre><span class=\"token string\">\"replication_num\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"326\"></td><td><pre><span class=\"token string\">\"in_memory\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"false\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"327\"></td><td><pre><span class=\"token string\">\"enable_persistent_index\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"328\"></td><td><pre><span class=\"token string\">\"replicated_storage\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"329\"></td><td><pre><span class=\"token string\">\"compression\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"LZ4\"</span></pre></td></tr><tr><td data-num=\"330\"></td><td><pre><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"331\"></td><td><pre>表示从<span class=\"token number\">2014</span> 开始创建分区 一直到<span class=\"token number\">2060</span></pre></td></tr><tr><td data-num=\"332\"></td><td><pre></pre></td></tr><tr><td data-num=\"333\"></td><td><pre>从新在查询：</pre></td></tr><tr><td data-num=\"334\"></td><td><pre><span class=\"token keyword\">select</span>   <span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> length<span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span>  <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>linkdistid<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> a<span class=\"token punctuation\">.</span>linkdistid <span class=\"token keyword\">end</span> distno<span class=\"token punctuation\">,</span> </pre></td></tr><tr><td data-num=\"335\"></td><td><pre><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">distinct</span> ifnull<span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>acc_set<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">.</span>acc_set<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> zts<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"336\"></td><td><pre><span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> bqs<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"337\"></td><td><pre><span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> sqs<span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"338\"></td><td><pre><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">0</span> <span class=\"token keyword\">then</span> <span class=\"token number\">0</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">convert</span><span class=\"token punctuation\">(</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token function\">sum</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token keyword\">DECIMAL</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">end</span> zxl </pre></td></tr><tr><td data-num=\"339\"></td><td><pre><span class=\"token keyword\">from</span> gz_acc_set a <span class=\"token keyword\">left</span> <span class=\"token keyword\">outer</span> <span class=\"token keyword\">join</span> gz_balance b <span class=\"token keyword\">on</span> a<span class=\"token punctuation\">.</span>acc_set<span class=\"token operator\">=</span>b<span class=\"token punctuation\">.</span>acc_set </pre></td></tr><tr><td data-num=\"340\"></td><td><pre><span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>YEARs<span class=\"token operator\">=</span><span class=\"token number\">2015</span> <span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>months<span class=\"token operator\">=</span><span class=\"token number\">4</span> </pre></td></tr><tr><td data-num=\"341\"></td><td><pre><span class=\"token operator\">and</span> b<span class=\"token punctuation\">.</span>acc_code <span class=\"token operator\">like</span> <span class=\"token string\">'522%'</span> </pre></td></tr><tr><td data-num=\"342\"></td><td><pre><span class=\"token keyword\">left</span> <span class=\"token keyword\">outer</span> <span class=\"token keyword\">join</span>  gz_balance c <span class=\"token keyword\">on</span> a<span class=\"token punctuation\">.</span>acc_set<span class=\"token operator\">=</span>c<span class=\"token punctuation\">.</span>acc_set </pre></td></tr><tr><td data-num=\"343\"></td><td><pre><span class=\"token comment\">--and c.YEARs*12+c.months=2015*12+4-1 </span></pre></td></tr><tr><td data-num=\"344\"></td><td><pre><span class=\"token operator\">and</span> <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>years <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token number\">2015</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token keyword\">else</span> <span class=\"token number\">2015</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>months <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token number\">4</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token keyword\">then</span> <span class=\"token number\">12</span> <span class=\"token keyword\">else</span> <span class=\"token number\">4</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"345\"></td><td><pre><span class=\"token operator\">and</span> c<span class=\"token punctuation\">.</span>acc_code <span class=\"token operator\">like</span> <span class=\"token string\">'522%'</span> </pre></td></tr><tr><td data-num=\"346\"></td><td><pre><span class=\"token keyword\">where</span> b<span class=\"token punctuation\">.</span>debit_month<span class=\"token operator\">+</span>c<span class=\"token punctuation\">.</span>debit_month<span class=\"token operator\">>=</span><span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"347\"></td><td><pre><span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>dwlx <span class=\"token operator\">=</span><span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> <span class=\"token string\">'全部'</span><span class=\"token operator\">=</span><span class=\"token string\">'全部'</span> <span class=\"token keyword\">then</span> dwlx <span class=\"token keyword\">else</span> <span class=\"token string\">'全部'</span> <span class=\"token keyword\">end</span> </pre></td></tr><tr><td data-num=\"348\"></td><td><pre><span class=\"token operator\">and</span> a<span class=\"token punctuation\">.</span>linkDistId <span class=\"token operator\">like</span> <span class=\"token string\">'01%'</span> <span class=\"token keyword\">group</span> <span class=\"token keyword\">by</span> <span class=\"token keyword\">case</span> <span class=\"token keyword\">when</span> length<span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">2</span> <span class=\"token keyword\">then</span>  <span class=\"token keyword\">left</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>linkdistid<span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>  <span class=\"token keyword\">else</span> a<span class=\"token punctuation\">.</span>linkdistid <span class=\"token keyword\">end</span></pre></td></tr><tr><td data-num=\"349\"></td><td><pre><span class=\"token operator\">></span> OK</pre></td></tr><tr><td data-num=\"350\"></td><td><pre><span class=\"token operator\">></span> 查询时间: <span class=\"token number\">0.209</span>s</pre></td></tr><tr><td data-num=\"351\"></td><td><pre>因为分区了 那么每个桶的数据量就会少，查询就会更快</pre></td></tr><tr><td data-num=\"352\"></td><td><pre></pre></td></tr><tr><td data-num=\"353\"></td><td><pre>执行计划：</pre></td></tr><tr><td data-num=\"354\"></td><td><pre><span class=\"token keyword\">PLAN</span> FRAGMENT <span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"355\"></td><td><pre> OUTPUT EXPRS:</pre></td></tr><tr><td data-num=\"356\"></td><td><pre>  <span class=\"token keyword\">PARTITION</span>: RANDOM</pre></td></tr><tr><td data-num=\"357\"></td><td><pre></pre></td></tr><tr><td data-num=\"358\"></td><td><pre>  STREAM <span class=\"token keyword\">DATA</span> SINK</pre></td></tr><tr><td data-num=\"359\"></td><td><pre>    EXCHANGE ID: <span class=\"token number\">05</span></pre></td></tr><tr><td data-num=\"360\"></td><td><pre>    HASH_PARTITIONED: <span class=\"token number\">60</span>: acc_set</pre></td></tr><tr><td data-num=\"361\"></td><td><pre></pre></td></tr><tr><td data-num=\"362\"></td><td><pre>  <span class=\"token number\">4</span>:Project</pre></td></tr><tr><td data-num=\"363\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">60</span><span class=\"token operator\">></span> : <span class=\"token number\">60</span>: acc_set</pre></td></tr><tr><td data-num=\"364\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">68</span><span class=\"token operator\">></span> : <span class=\"token number\">68</span>: debit_month</pre></td></tr><tr><td data-num=\"365\"></td><td><pre>  <span class=\"token operator\">|</span>  </pre></td></tr><tr><td data-num=\"366\"></td><td><pre>  <span class=\"token number\">3</span>:OlapScanNode</pre></td></tr><tr><td data-num=\"367\"></td><td><pre>     <span class=\"token keyword\">TABLE</span>: gz_balance</pre></td></tr><tr><td data-num=\"368\"></td><td><pre>     PREAGGREGATION: <span class=\"token keyword\">ON</span></pre></td></tr><tr><td data-num=\"369\"></td><td><pre>     PREDICATES: <span class=\"token number\">61</span>: months <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">63</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"370\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">21</span></pre></td></tr><tr><td data-num=\"371\"></td><td><pre>     rollup: gz_balance</pre></td></tr><tr><td data-num=\"372\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"373\"></td><td><pre>     tabletList<span class=\"token operator\">=</span><span class=\"token number\">46294</span><span class=\"token punctuation\">,</span><span class=\"token number\">46296</span><span class=\"token punctuation\">,</span><span class=\"token number\">46298</span><span class=\"token punctuation\">,</span><span class=\"token number\">46300</span><span class=\"token punctuation\">,</span><span class=\"token number\">46302</span><span class=\"token punctuation\">,</span><span class=\"token number\">46304</span><span class=\"token punctuation\">,</span><span class=\"token number\">46306</span><span class=\"token punctuation\">,</span><span class=\"token number\">46308</span></pre></td></tr><tr><td data-num=\"374\"></td><td><pre>     cardinality<span class=\"token operator\">=</span><span class=\"token number\">572172</span></pre></td></tr><tr><td data-num=\"375\"></td><td><pre>     avgRowSize<span class=\"token operator\">=</span><span class=\"token number\">23.7504</span></pre></td></tr><tr><td data-num=\"376\"></td><td><pre></pre></td></tr><tr><td data-num=\"377\"></td><td><pre><span class=\"token keyword\">PLAN</span> FRAGMENT <span class=\"token number\">5</span></pre></td></tr><tr><td data-num=\"378\"></td><td><pre> OUTPUT EXPRS:</pre></td></tr><tr><td data-num=\"379\"></td><td><pre>  <span class=\"token keyword\">PARTITION</span>: RANDOM</pre></td></tr><tr><td data-num=\"380\"></td><td><pre></pre></td></tr><tr><td data-num=\"381\"></td><td><pre>  STREAM <span class=\"token keyword\">DATA</span> SINK</pre></td></tr><tr><td data-num=\"382\"></td><td><pre>    EXCHANGE ID: <span class=\"token number\">02</span></pre></td></tr><tr><td data-num=\"383\"></td><td><pre>    HASH_PARTITIONED: <span class=\"token number\">34</span>: acc_set</pre></td></tr><tr><td data-num=\"384\"></td><td><pre></pre></td></tr><tr><td data-num=\"385\"></td><td><pre>  <span class=\"token number\">1</span>:Project</pre></td></tr><tr><td data-num=\"386\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">34</span><span class=\"token operator\">></span> : <span class=\"token number\">34</span>: acc_set</pre></td></tr><tr><td data-num=\"387\"></td><td><pre>  <span class=\"token operator\">|</span>  <span class=\"token operator\">&lt;</span>slot <span class=\"token number\">42</span><span class=\"token operator\">></span> : <span class=\"token number\">42</span>: debit_month</pre></td></tr><tr><td data-num=\"388\"></td><td><pre>  <span class=\"token operator\">|</span>  </pre></td></tr><tr><td data-num=\"389\"></td><td><pre>  <span class=\"token number\">0</span>:OlapScanNode</pre></td></tr><tr><td data-num=\"390\"></td><td><pre>     <span class=\"token keyword\">TABLE</span>: gz_balance</pre></td></tr><tr><td data-num=\"391\"></td><td><pre>     PREAGGREGATION: <span class=\"token keyword\">ON</span></pre></td></tr><tr><td data-num=\"392\"></td><td><pre>     PREDICATES: <span class=\"token number\">35</span>: months <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">37</span>: acc_code <span class=\"token operator\">LIKE</span> <span class=\"token string\">'522%'</span></pre></td></tr><tr><td data-num=\"393\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">21</span></pre></td></tr><tr><td data-num=\"394\"></td><td><pre>     rollup: gz_balance</pre></td></tr><tr><td data-num=\"395\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span></pre></td></tr><tr><td data-num=\"396\"></td><td><pre>     tabletList<span class=\"token operator\">=</span><span class=\"token number\">46294</span><span class=\"token punctuation\">,</span><span class=\"token number\">46296</span><span class=\"token punctuation\">,</span><span class=\"token number\">46298</span><span class=\"token punctuation\">,</span><span class=\"token number\">46300</span><span class=\"token punctuation\">,</span><span class=\"token number\">46302</span><span class=\"token punctuation\">,</span><span class=\"token number\">46304</span><span class=\"token punctuation\">,</span><span class=\"token number\">46306</span><span class=\"token punctuation\">,</span><span class=\"token number\">46308</span></pre></td></tr><tr><td data-num=\"397\"></td><td><pre>     cardinality<span class=\"token operator\">=</span><span class=\"token number\">572172</span></pre></td></tr><tr><td data-num=\"398\"></td><td><pre>     avgRowSize<span class=\"token operator\">=</span><span class=\"token number\">23.7504</span></pre></td></tr><tr><td data-num=\"399\"></td><td><pre>                                                                                 </pre></td></tr><tr><td data-num=\"400\"></td><td><pre>     partitions<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token operator\">/</span><span class=\"token number\">21</span>   表示总共有<span class=\"token number\">21</span>个分区走了其中一个                                                                             </pre></td></tr><tr><td data-num=\"401\"></td><td><pre>     tabletRatio<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token operator\">/</span><span class=\"token number\">8</span>   表示走一个分区的<span class=\"token number\">8</span>个桶</pre></td></tr><tr><td data-num=\"402\"></td><td><pre>  </pre></td></tr><tr><td data-num=\"403\"></td><td><pre>  \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"404\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mFragment <span class=\"token number\">4</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"405\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mBackendNum: <span class=\"token number\">1</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"406\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mInstancePeakMemoryUsage: <span class=\"token number\">27.611</span> MB<span class=\"token punctuation\">,</span> InstanceAllocatedMemoryUsage: <span class=\"token number\">171.213</span> MB\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"407\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPrepareTime: <span class=\"token number\">432.860</span>us\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"408\"></td><td><pre>└──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mDATA_STREAM_SINK <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"409\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionType: HASH_PARTITIONED\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"410\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionExprs: <span class=\"token punctuation\">[</span><span class=\"token number\">60</span>: acc_set<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"411\"></td><td><pre>   └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPROJECT <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"412\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: ?<span class=\"token punctuation\">,</span> cpu: ?<span class=\"token punctuation\">,</span> memory: ?<span class=\"token punctuation\">,</span> network: ?<span class=\"token punctuation\">,</span> cost: ?<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"413\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mTotalTime: <span class=\"token number\">29.300</span>us <span class=\"token punctuation\">(</span><span class=\"token number\">0.01</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">29.300</span>us<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"414\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mOutputRows: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"415\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mExpression: <span class=\"token punctuation\">[</span><span class=\"token number\">60</span>: acc_set<span class=\"token punctuation\">,</span> <span class=\"token number\">68</span>: debit_month<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"416\"></td><td><pre>      └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"417\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: <span class=\"token number\">572171</span><span class=\"token punctuation\">,</span> cpu: <span class=\"token number\">13589308.07</span><span class=\"token punctuation\">,</span> memory: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> network: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> cost: <span class=\"token number\">6794654.03</span><span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"418\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTotalTime: <span class=\"token number\">120.130</span>ms <span class=\"token punctuation\">(</span><span class=\"token number\">48.71</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">1.695</span>ms<span class=\"token punctuation\">,</span> ScanTime: <span class=\"token number\">118.434</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"419\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOutputRows: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"420\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mRuntimeFilter: <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token number\">71.199</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71199</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"421\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTable: : gz_balance\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"422\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSubordinateOperators: \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"423\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mCHUNK_ACCUMULATE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"424\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mNOOP\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"425\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN_PREPARE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"426\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mDetail Timers: <span class=\"token punctuation\">[</span>ScanTime <span class=\"token operator\">=</span> IOTaskExecTime <span class=\"token operator\">+</span> IOTaskWaitTime<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"427\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskExecTime: <span class=\"token number\">96.399</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">73.400</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">117.540</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"428\"></td><td><pre>                     \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSegmentRead: <span class=\"token number\">86.994</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">66.072</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">106.873</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"429\"></td><td><pre>                         \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mBlockFetch: <span class=\"token number\">53.470</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">43.348</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">74.015</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"430\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskWaitTime: <span class=\"token number\">431.071</span>us <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">105.350</span>us<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">894.680</span>us<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"431\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"432\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mFragment <span class=\"token number\">5</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"433\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mBackendNum: <span class=\"token number\">1</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"434\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mInstancePeakMemoryUsage: <span class=\"token number\">34.622</span> MB<span class=\"token punctuation\">,</span> InstanceAllocatedMemoryUsage: <span class=\"token number\">168.411</span> MB\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"435\"></td><td><pre>│   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPrepareTime: <span class=\"token number\">367.390</span>us\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"436\"></td><td><pre>└──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mDATA_STREAM_SINK <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"437\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionType: HASH_PARTITIONED\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"438\"></td><td><pre>   │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPartitionExprs: <span class=\"token punctuation\">[</span><span class=\"token number\">34</span>: acc_set<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"439\"></td><td><pre>   └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mPROJECT <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"440\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: ?<span class=\"token punctuation\">,</span> cpu: ?<span class=\"token punctuation\">,</span> memory: ?<span class=\"token punctuation\">,</span> network: ?<span class=\"token punctuation\">,</span> cost: ?<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"441\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mTotalTime: <span class=\"token number\">34.850</span>us <span class=\"token punctuation\">(</span><span class=\"token number\">0.01</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">34.850</span>us<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"442\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mOutputRows: <span class=\"token number\">71.245</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71245</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"443\"></td><td><pre>      │   \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>mExpression: <span class=\"token punctuation\">[</span><span class=\"token number\">34</span>: acc_set<span class=\"token punctuation\">,</span> <span class=\"token number\">42</span>: debit_month<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"444\"></td><td><pre>      └──\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN <span class=\"token punctuation\">(</span>id<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span> \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"445\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mEstimates: <span class=\"token punctuation\">[</span><span class=\"token keyword\">row</span>: <span class=\"token number\">572171</span><span class=\"token punctuation\">,</span> cpu: <span class=\"token number\">13589308.07</span><span class=\"token punctuation\">,</span> memory: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> network: <span class=\"token number\">0.00</span><span class=\"token punctuation\">,</span> cost: <span class=\"token number\">6794654.03</span><span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"446\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTotalTime: <span class=\"token number\">102.443</span>ms <span class=\"token punctuation\">(</span><span class=\"token number\">41.54</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>CPUTime: <span class=\"token number\">2.462</span>ms<span class=\"token punctuation\">,</span> ScanTime: <span class=\"token number\">99.980</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"447\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOutputRows: <span class=\"token number\">71.245</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71245</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"448\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mRuntimeFilter: <span class=\"token number\">71.245</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71245</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span><span class=\"token operator\">></span> <span class=\"token number\">71.245</span>K <span class=\"token punctuation\">(</span><span class=\"token number\">71245</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.00</span><span class=\"token operator\">%</span><span class=\"token punctuation\">)</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"449\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mTable: : gz_balance\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"450\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSubordinateOperators: \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"451\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mCHUNK_ACCUMULATE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"452\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mNOOP\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"453\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mOLAP_SCAN_PREPARE\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"454\"></td><td><pre>             \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mDetail Timers: <span class=\"token punctuation\">[</span>ScanTime <span class=\"token operator\">=</span> IOTaskExecTime <span class=\"token operator\">+</span> IOTaskWaitTime<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"455\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskExecTime: <span class=\"token number\">84.520</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">65.642</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">98.813</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"456\"></td><td><pre>                     \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mSegmentRead: <span class=\"token number\">69.156</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">53.675</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">82.214</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"457\"></td><td><pre>                         \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mBlockFetch: <span class=\"token number\">46.202</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">32.908</span>ms<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">58.337</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"458\"></td><td><pre>                 \u001b<span class=\"token punctuation\">[</span><span class=\"token number\">1</span>m\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">31</span>mIOTaskWaitTime: <span class=\"token number\">2.098</span>ms <span class=\"token punctuation\">[</span>min<span class=\"token operator\">=</span><span class=\"token number\">343.760</span>us<span class=\"token punctuation\">,</span> max<span class=\"token operator\">=</span><span class=\"token number\">9.110</span>ms<span class=\"token punctuation\">]</span>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"459\"></td><td><pre>\u001b<span class=\"token punctuation\">[</span><span class=\"token number\">0</span>m</pre></td></tr><tr><td data-num=\"460\"></td><td><pre></pre></td></tr><tr><td data-num=\"461\"></td><td><pre>  可以看到走了分区消耗的内存更少 因为可以快速定位到指定分区 InstanceAllocatedMemoryUsage: <span class=\"token number\">168.411</span> MB</pre></td></tr></table></figure>",
            "tags": [
                "计算机科学",
                "数据库"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/04/18/computer-science/eight-part-essay/eight-part-essay/",
            "url": "https://mytingting.gitee.io/tzblog/2024/04/18/computer-science/eight-part-essay/eight-part-essay/",
            "title": "八股文大全",
            "date_published": "2024-04-18T12:45:48.000Z",
            "content_html": "<h1 id=\"八股文大全\"><a class=\"anchor\" href=\"#八股文大全\">#</a> 八股文大全</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>记录所有面试相关的问题</p>\n<h3 id=\"java相关\"><a class=\"anchor\" href=\"#java相关\">#</a> java 相关</h3>\n<h4 id=\"1-在-java-中守护线程和本地线程区别\"><a class=\"anchor\" href=\"#1-在-java-中守护线程和本地线程区别\">#</a> 1、在 java 中守护线程和本地线程区别？</h4>\n<h5 id=\"解答\"><a class=\"anchor\" href=\"#解答\">#</a> 解答</h5>\n<p>java 中的线程分为两种：守护线程（Daemon）和用户线程（User）。</p>\n<p>任何线程都可以设置为守护线程和用户线程，通过方法 Thread.setDaemon (boolon)；true 则把该线程设置为守护线程，反之则为用户线程。</p>\n<p>Thread.setDaemon () 必须在 Thread.start () 之前调用，否则运行时会抛出异常。</p>\n<p><strong>两者的区别：</strong></p>\n<p>唯一的区别是判断虚拟机 (JVM) 何时离开，Daemon 是为其他线程提供服务，如果全部的 User Thread 已经撤离，Daemon 没有可服务的线程，JVM 撤离。也可以理解为守护线程是 JVM 自动创建的线程（但不一定），用户线程是程序创建的线程；</p>\n<p>比如 JVM 的垃圾回收线程是一个守护线程，当所有线程已经撤离，不再产生垃圾，守护线程自然就没事可干了，当垃圾回收线程是 Java 虚拟机上仅剩的线程时，Java 虚拟机会自动离开。</p>\n<p><strong>扩展：</strong></p>\n<p>Thread Dump 打印出来的线程信息，含有 daemon 字样的线程即为守护进程，可能会有：服务守护进程、编译守护进程、windows 下的监听 Ctrl+break 的守护进程、Finalizer 守护进程、引用处理守护进程、GC 守护进程。</p>\n<h5 id=\"举例\"><a class=\"anchor\" href=\"#举例\">#</a> 举例</h5>\n<h4 id=\"2-线程与进程的区别\"><a class=\"anchor\" href=\"#2-线程与进程的区别\">#</a> 2、线程与进程的区别？</h4>\n<h5 id=\"解答-2\"><a class=\"anchor\" href=\"#解答-2\">#</a> 解答</h5>\n<p>进程是操作系统分配资源的最小单元，线程是操作系统调度的最小单元。</p>\n<p>一个程序至少有一个进程，一个进程至少有一个线程。</p>\n<h5 id=\"举例-2\"><a class=\"anchor\" href=\"#举例-2\">#</a> 举例</h5>\n<p>就像我们运行的微信程序一样，本身是一个进程，而多个聊天窗口就是线程。</p>\n<h4 id=\"3-什么是多线程中的上下文切换\"><a class=\"anchor\" href=\"#3-什么是多线程中的上下文切换\">#</a> 3、什么是多线程中的上下文切换？</h4>\n<h5 id=\"解答-3\"><a class=\"anchor\" href=\"#解答-3\">#</a> 解答</h5>\n<p>多线程会共同使用一组计算机上的 CPU，而线程数大于给程序分配的 CPU 数量时，为了让各个线程都有执行的机会，就需要轮转使用 CPU。</p>\n<p>不同的线程切换使用 CPU 发生的切换数据等就是上下文切换。</p>\n<h5 id=\"举例-3\"><a class=\"anchor\" href=\"#举例-3\">#</a> 举例</h5>\n<p>比如一台计算机只有 8 个 cpu， 运行的程序有 16 个线程同时在跑，每个线程执行在一个 cpu 上，那么就会不够，这个时候为了 16 个线程同时跑，就会出现 cpu 切换，可能在 a 时间点 cpu 执行线程 1，到了 b 时间点就执行一下线程 2</p>\n<h4 id=\"4-死锁与活锁的区别死锁与饥饿的区别\"><a class=\"anchor\" href=\"#4-死锁与活锁的区别死锁与饥饿的区别\">#</a> 4、死锁与活锁的区别，死锁与饥饿的区别？</h4>\n<h5 id=\"解答-4\"><a class=\"anchor\" href=\"#解答-4\">#</a> 解答</h5>\n<p>死锁：是指两个或两个以上的进程（或线程）在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。</p>\n<p><strong>产生死锁的必要条件：</strong></p>\n<ol>\n<li>互斥条件：所谓互斥就是进程在某一时间内独占资源。</li>\n<li>请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放。</li>\n<li>不剥夺条件：进程已获得资源，在末使用完之前，不能强行剥夺。</li>\n<li>循环等待条件：若干进程之间形成一种头尾相接的循环等待资源关系。</li>\n</ol>\n<p><strong>活锁：</strong></p>\n<p>任务或者执行者没有被阻塞，由于某些条件没有满足，导致一直重复尝试，失败，尝试，失败。活锁和死锁的区别在于，处于活锁的实体是在不断的改变状态，所谓的 “活”， 而处于死锁的实体表现为等待；活锁有可能自行解开，死锁则不能。</p>\n<p><strong>饥饿：</strong></p>\n<p>一个或者多个线程因为种种原因无法获得所需要的资源，导致一直无法执行的状态。</p>\n<p><strong>Java 中导致饥饿的原因：</strong></p>\n<ol>\n<li>高优先级线程吞噬所有的低优先级线程的 CPU 时间。</li>\n<li>线程被永久堵塞在一个等待进入同步块的状态，因为其他线程总是能在它之前持续地对该同步块进行访问。</li>\n<li>线程在等待一个本身也处于永久等待完成的对象 (比如调用这个对象的 wait 方法)，因为其他线程总是被持续地获得唤醒。</li>\n</ol>\n<h5 id=\"举例-4\"><a class=\"anchor\" href=\"#举例-4\">#</a> 举例</h5>\n<h4 id=\"5-java-中用到的线程调度算法是什么\"><a class=\"anchor\" href=\"#5-java-中用到的线程调度算法是什么\">#</a> 5、Java 中用到的线程调度算法是什么？</h4>\n<h5 id=\"解答-5\"><a class=\"anchor\" href=\"#解答-5\">#</a> 解答</h5>\n<p>采用时间片轮转的方式。可以设置线程的优先级，会映射到下层的系统上面的优先级上，如非特别需要，尽量不要用，防止线程饥饿。</p>\n<h5 id=\"例子\"><a class=\"anchor\" href=\"#例子\">#</a> 例子</h5>\n<h4 id=\"5-线程与进程的区别\"><a class=\"anchor\" href=\"#5-线程与进程的区别\">#</a> 5、线程与进程的区别？</h4>\n<h5 id=\"解答-6\"><a class=\"anchor\" href=\"#解答-6\">#</a> 解答</h5>\n<h5 id=\"例子-2\"><a class=\"anchor\" href=\"#例子-2\">#</a> 例子</h5>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n",
            "tags": [
                "计算机科学",
                "八股文"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/04/14/computer-science/personal-projects/scaffold/",
            "url": "https://mytingting.gitee.io/tzblog/2024/04/14/computer-science/personal-projects/scaffold/",
            "title": "scaffold项目",
            "date_published": "2024-04-14T12:45:48.000Z",
            "content_html": "<h1 id=\"scaffold项目\"><a class=\"anchor\" href=\"#scaffold项目\">#</a> scaffold 项目</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>自用的项目骨架</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n",
            "tags": [
                "计算机科学",
                "个人项目"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/04/04/computer-science/tool-install/git-install/",
            "url": "https://mytingting.gitee.io/tzblog/2024/04/04/computer-science/tool-install/git-install/",
            "title": "git安装与使用",
            "date_published": "2024-04-04T11:12:45.000Z",
            "content_html": "<h1 id=\"git安装与使用\"><a class=\"anchor\" href=\"#git安装与使用\">#</a> git 安装与使用</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p><strong>Git 是一个免费、开源的分布式版本控制系统</strong>，主要用于管理软件代码的变化，记录每一次修改，并允许开发者回滚到之前的版本或进行分支开发，方便团队协作开发。</p>\n<h2 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h2>\n<ol>\n<li>\n<p>进入官方网站下载系统对应的版本<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXQtc2NtLmNvbS9kb3dubG9hZA==\">下载地址</span></p>\n</li>\n<li>\n<p>下载完成后直接无脑下一步即可</p>\n</li>\n<li>\n<p>校验是否安装成功，在文件夹下鼠标右键出现下列 git 的选项，如图</p>\n</li>\n</ol>\n<p><img data-src=\"git/git-1.jpg\" alt=\"\" /></p>\n<p><img data-src=\"git/git-2.png\" alt=\"\" /></p>\n<h2 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h2>\n<h3 id=\"基础使用\"><a class=\"anchor\" href=\"#基础使用\">#</a> 基础使用</h3>\n<ol>\n<li>\n<p>原理说明</p>\n<p>git 底层是类似于 hashmap 的结构 key-value 的形式存储数据（直接把文件的内容拿出来存储到数据库中）key 是唯一的 value 就是文件的类容</p>\n</li>\n<li>\n<p>常用命令</p>\n</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#可以查看这个文件的 key 值（8fe5f63999dd11e8ed17f7ba4d4a68b6b2fafbfc）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">git</span> hash-object <span class=\"token parameter variable\">-w</span> README.MF </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#根据 key 值查询对应数据</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">git</span> cat-file <span class=\"token parameter variable\">-p</span> 8fe5f63999dd11e8ed17f7ba4d4a68b6b2fafbfc</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#查看状态</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">git</span> status </pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#添加文件到本地缓存区</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token function\">git</span> <span class=\"token function\">add</span> filename</pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">#添加所有文件</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token parameter variable\">-A</span> </pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#从本地缓存区删除文件（并不会删除实际的文件）</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">git</span> <span class=\"token function\">rm</span> <span class=\"token parameter variable\">--cached</span> filename </pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#提交文件到本地仓库</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token function\">git</span> commit filename <span class=\"token parameter variable\">-m</span> <span class=\"token string\">'备注'</span> </pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">#本地添加远程仓库地址</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">git</span> remote <span class=\"token function\">add</span> 分支名 https://gitee.com/xxx/xxx.git</pre></td></tr></table></figure><ol start=\"3\">\n<li>操作流程图</li>\n</ol>\n<p><img data-src=\"git/git-3.png\" alt=\"\" /></p>\n<p>​\t提交远程仓库流程：本地开发 - 添加到本地缓存 - 提交到本地仓库 - 推送到远程仓库</p>\n<p>​\t拉去远程仓库流程：克隆远程仓库</p>\n<ol start=\"4\">\n<li>\n<p>多个远程仓库</p>\n<p>git 可以搭建多个远程仓库</p>\n<p>多个远程仓库的好处： 可以将一份代码一次上传到多个仓库中（某些场景用到）图片说明</p>\n<p><img data-src=\"git/git-4.png\" alt=\"\" /></p>\n<p>具体配置方法：</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#本地仓库与远程仓库地址管理命令</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#执行多次就添加多个</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">git</span> remote <span class=\"token function\">add</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#列如 这里同时添加了名为 origin 的 gitee 仓库和名为 origin 的 github 仓库</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">git</span> remote <span class=\"token function\">add</span> origin git@github.com:myusername/myrepository.git</pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">git</span> remote <span class=\"token function\">add</span> origin git@gitee.com:myusername/myrepository.git</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#查看关联的远程仓库</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">git</span> remote <span class=\"token parameter variable\">-v</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#删除名为 origin 的远程仓库</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">git</span> remote <span class=\"token function\">rm</span> origin</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#向指定远程仓库推送到指定分支</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#这个命令将在本地仓库中查找 master 分支，并将其推送到名为 origin 的远程仓库中</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token function\">git</span> push origin master</pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#向指定远程仓库拉取指定分支的内容</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#这个命令将从名为 origin 的远程仓库中下载最新的代码，并将其合并到本地的 master 分支中</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token function\">git</span> pull origin master</pre></td></tr></table></figure><p>​</p>\n</li>\n</ol>\n<h3 id=\"分支管理\"><a class=\"anchor\" href=\"#分支管理\">#</a> 分支管理</h3>\n<p>在 git 中分支是用来将特性开发工作从主仓库分离开的，分支可以基于以下几点创建</p>\n<ul>\n<li>基于当前分支创建分支</li>\n<li>基于远程分支创建分支</li>\n<li>基于一个提交创建分支</li>\n<li>基于 tag 创建分支</li>\n</ul>\n<p>常用管理分支操作</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#根据现有分支创建分支（继承分支内容）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span> <span class=\"token punctuation\">[</span>依据的分支<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#无任何内容</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#切换分支</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token function\">git</span> checkout <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#创建并切换到新分支</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">git</span> checkout <span class=\"token parameter variable\">-b</span> <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#查看所有分支</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token function\">git</span> branch </pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#所有分支</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-a</span> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#可以查看本地和远程分支的关联信息</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-avv</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#合并分支</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">#如果已经在主分支上，想要将功能分支合并进来</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token function\">git</span> merge <span class=\"token operator\">&lt;</span>feature_branch<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">#删除分支</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-d</span> <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token comment\">#强制删除一个未合并的分支</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-D</span> <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token comment\">#查看分支图</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token function\">git</span> log <span class=\"token parameter variable\">--graph</span> <span class=\"token parameter variable\">--all</span> <span class=\"token parameter variable\">--oneline</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">#重命名分支</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token comment\">#首先切换到要重命名的分支</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token function\">git</span> checkout <span class=\"token operator\">&lt;</span>old_branch<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token comment\">#然后使用以下命令重命名分支</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token function\">git</span> branch <span class=\"token parameter variable\">-m</span> <span class=\"token operator\">&lt;</span>new_branch<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre><span class=\"token comment\">#推送分支到远程仓库 这里会推送到 origin 远程仓库</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token function\">git</span> push origin <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token comment\">#拉取远程分支到本地</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre><span class=\"token function\">git</span> checkout <span class=\"token parameter variable\">-b</span> <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span> origin/<span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\">#删除远程分支</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token function\">git</span> push origin <span class=\"token parameter variable\">--delete</span> <span class=\"token operator\">&lt;</span>branch_name<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre></pre></td></tr><tr><td data-num=\"49\"></td><td><pre><span class=\"token comment\">#拉取远程分支列表</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token function\">git</span> fetch</pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre><span class=\"token comment\">#拉取所有远程分支到本地</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre><span class=\"token function\">git</span> fetch <span class=\"token parameter variable\">--all</span></pre></td></tr></table></figure><p>​</p>\n<h3 id=\"远程管理\"><a class=\"anchor\" href=\"#远程管理\">#</a> 远程管理</h3>\n<p>1</p>\n<h2 id=\"搭建私有仓库\"><a class=\"anchor\" href=\"#搭建私有仓库\">#</a> 搭建私有仓库</h2>\n<h3 id=\"为什么搭建私有仓库\"><a class=\"anchor\" href=\"#为什么搭建私有仓库\">#</a> 为什么搭建私有仓库</h3>\n<p>首先需要知道既然是远程那么就需要有通讯协议，而 git 支持的通信协议有：</p>\n<ol>\n<li>\n<p>local</p>\n<p><span class=\"label success\">✔️优点</span> 搭建简单，管理轻松</p>\n<p><span class=\"label danger\">💔danger</span> 只能在局域网中使用</p>\n<p>例子 git init --bare 主服务（文件共享）</p>\n<p>注意点：如果拉取项目用全路径会全部打包</p>\n<p>如果用 “file:///&quot; 方式会先 执行 gc 命令 在打包</p>\n</li>\n<li>\n<p>ssh</p>\n<p><span class=\"label success\">✔️优点</span> 搭设简单 访问安全 高效 传输数据会尽量压缩</p>\n<p><span class=\"label danger\">💔danger</span> 权限不好控制 必须提供系统账号密码</p>\n</li>\n<li>\n<p>http</p>\n<p>首先搭建 nginx 如果映射到 git 项目 需要开启 git 提交的钩子</p>\n<p>本地克隆远程服务：</p>\n<p>git clone <span class=\"exturl\" data-url=\"aHR0cDovL3h4eC54eHgueHh4L3Rlc3QuZ2l0\">http://xxx.xxx.xxx/test.git</span></p>\n</li>\n</ol>\n<h3 id=\"方案\"><a class=\"anchor\" href=\"#方案\">#</a> 方案</h3>\n<ol>\n<li>gogs</li>\n<li>gitlab</li>\n<li>gitblit</li>\n</ol>\n<h2 id=\"扩展1gitflow\"><a class=\"anchor\" href=\"#扩展1gitflow\">#</a> 扩展 1：gitflow</h2>\n<h2 id=\"扩展2git-common\"><a class=\"anchor\" href=\"#扩展2git-common\">#</a> 扩展 2：git common</h2>\n",
            "tags": [
                "计算机科学",
                "工具安装与使用",
                "git",
                "gitflow"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/example/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/example/",
            "title": "xxx",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"使用spring-boot框架构建web应用\"><a class=\"anchor\" href=\"#使用spring-boot框架构建web应用\">#</a> 使用 Spring Boot 框架构建 Web 应用</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>介绍 Spring Boot 框架的背景和优势，以及本文要讨论的主题和目的。</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "xxx",
                "test1",
                "test2"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/big-data-processing/dinky-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/big-data-processing/dinky-1/",
            "title": "dinky",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"大数据管理框架之dinky\"><a class=\"anchor\" href=\"#大数据管理框架之dinky\">#</a> 大数据管理框架之 dinky</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>实时即未来，Dinky 为 Apache Flink 而生，让 Flink SQL 纵享丝滑，并致力于实时计算平台建设。</p>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5kbGluay50b3Av\">http://www.dlink.top/</span></p>\n<p>选择版本下载：<span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5kbGluay50b3AvZG93bmxvYWQvZG93bmxvYWQ=\">http://www.dlink.top/download/download</span></p>\n<h2 id=\"下载\"><a class=\"anchor\" href=\"#下载\">#</a> 下载</h2>\n<p>下载对应的版本，建议下载最新版本 后面启动可以指定 flink 的版本 无需担心版本问题</p>\n<h2 id=\"部署\"><a class=\"anchor\" href=\"#部署\">#</a> 部署</h2>\n<h3 id=\"1-数据库初始化\"><a class=\"anchor\" href=\"#1-数据库初始化\">#</a> 1、数据库初始化</h3>\n<p>Dinky 采用 mysql 作为后端的存储库，mysql 支持 5.7+。这里假设你已经安装了 mysql 。首先需要创建 Dinky 的后端数据库，这里以配置文件中默认库创建。</p>\n<p>在 Dinky 根目录 sql 文件夹下分别放置了 dinky.sql 、 upgrade/${version}_schema/mysql/ddl 和 dml。如果第一次部署，可以直接将 sql/dinky.sql 文件在 dinky 数据库下执行。（如果之前已经部署，那 upgrade  目录下 存放了各版本的升级 sql ，根据版本号按需执行即可）</p>\n<h3 id=\"2-dinky-部署\"><a class=\"anchor\" href=\"#2-dinky-部署\">#</a> 2、Dinky 部署</h3>\n<ul>\n<li>Linux</li>\n</ul>\n<p><strong>解压到指定目录</strong></p>\n<p>Dinky 不依赖任何外部的 Hadoop 或者 Flink 环境，可以单独部署在 flink、 hadoop 和 K8S 集群之外，完全解耦，支持同时连接多个不同的集群实例进行运维。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">tar</span> <span class=\"token parameter variable\">-zxvf</span> dinky-release-<span class=\"token variable\">$&#123;version&#125;</span>.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mv</span> dinky-release-<span class=\"token variable\">$&#123;version&#125;</span> dinky</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">cd</span> dinky</pre></td></tr></table></figure><h3 id=\"3-配置文件\"><a class=\"anchor\" href=\"#3-配置文件\">#</a> 3、配置文件</h3>\n<p>创建好数据库后，修改 Dinky 连接 mysql 的配置文件。</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#切换目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">cd</span> /opt/dinky/config/</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">vim</span> application.yml</pre></td></tr></table></figure><h3 id=\"4-在nginx下配置\"><a class=\"anchor\" href=\"#4-在nginx下配置\">#</a> 4、在 nginx 下配置</h3>\n<p>注：使用当前目录下打包好的项目可以手动配置访问路径</p>\n<h3 id=\"5-chunjun环境下使用dinky\"><a class=\"anchor\" href=\"#5-chunjun环境下使用dinky\">#</a> 5、chunjun 环境下使用 dinky</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9tcC53ZWl4aW4ucXEuY29tL3M/X19iaXo9TXpnM09EWXhPVFF4TUE9PSZhbXA7bWlkPTIyNDc0ODU3NzAmYW1wO2lkeD0xJmFtcDtzbj1hNGMzODM0ZjYyNDc2ZTE3N2ViOWIwZWNkMDVjN2EzOCZhbXA7Y2hrc209Y2YxMWI3MzdmODY2M2UyMWEzOWEyNzhjZTdlNTFjNTM4YWM3MmIyMTRiYzE0MTA2MzkxZjM0YWUzZjE2YjViZmYyM2JiNzUxYjI1YSZhbXA7c2NlbmU9MjEjd2VjaGF0X3JlZGlyZWN0\">https://mp.weixin.qq.com/s?__biz=Mzg3ODYxOTQxMA==&amp;mid=2247485770&amp;idx=1&amp;sn=a4c3834f62476e177eb9b0ecd05c7a38&amp;chksm=cf11b737f8663e21a39a278ce7e51c538ac72b214bc14106391f34ae3f16b5bff23bb751b25a&amp;scene=21#wechat_redirect</span></p>\n<ul>\n<li>\n<p>修改 flink.yml 配置文件</p>\n<p><strong>classloader.resolve-order</strong> 改成 <strong>parent-first</strong></p>\n</li>\n<li>\n<p>需要将 chunjun 用到的包复制到 flink/lib 下</p>\n<p>如图：<img data-src=\"images%5Cdinky1.jpg\" alt=\"\" /></p>\n</li>\n<li>\n<p>将 flink/lib 下的 jar 包放到 dlink/plugins/</p>\n</li>\n<li>\n<p>注册 flink 启动测试</p>\n</li>\n</ul>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n",
            "tags": [
                "计算机科学",
                "框架",
                "大数据处理框架",
                "java",
                "大数据"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/big-data-processing/flink-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/big-data-processing/flink-1/",
            "title": "flink",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"大数据处理框架之flink\"><a class=\"anchor\" href=\"#大数据处理框架之flink\">#</a> 大数据处理框架之 flink</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>Apache Flink 是一个流式计算框架，具有强大的处理能力和灵活性，被广泛应用于实时数据处理、大数据分析等领域。本文将全方位介绍 Apache Flink 的相关知识点，包括核心概念、架构、特点、应用场景等。</p>\n<h2 id=\"flink简介\"><a class=\"anchor\" href=\"#flink简介\">#</a> flink 简介</h2>\n<ul>\n<li>Apache Flink 是什么？</li>\n<li>Flink 的历史和发展</li>\n<li>Flink 的核心组件和架构</li>\n</ul>\n<h2 id=\"flink-核心概念\"><a class=\"anchor\" href=\"#flink-核心概念\">#</a> Flink 核心概念</h2>\n<ul>\n<li>流处理和批处理的统一</li>\n<li>有状态的计算</li>\n<li>事件时间和处理时间</li>\n<li>窗口操作和触发器</li>\n<li>检查点和容错机制</li>\n</ul>\n<h2 id=\"flink-特点\"><a class=\"anchor\" href=\"#flink-特点\">#</a> Flink 特点</h2>\n<ul>\n<li>低延迟和高吞吐量</li>\n<li>支持 Exactly-Once 语义</li>\n<li>可以与多种数据存储和计算引擎集成</li>\n<li>支持复杂的数据流处理逻辑</li>\n<li>可以运行在各种环境中，如本地、集群、云端等</li>\n</ul>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"flink-应用场景\"><a class=\"anchor\" href=\"#flink-应用场景\">#</a> Flink 应用场景</h2>\n<ul>\n<li>Flink SQL 和 Table API</li>\n<li>Flink ML 和 Graph</li>\n<li>Flink CEP</li>\n<li>Flink Gelly</li>\n<li>Flink 应用程序部署和管理</li>\n</ul>\n<h2 id=\"flink-最佳实践\"><a class=\"anchor\" href=\"#flink-最佳实践\">#</a> Flink 最佳实践</h2>\n<ul>\n<li>如何优化 Flink 作业性能</li>\n<li>如何设计可靠的 Flink 应用</li>\n<li>如何调试和监控 Flink 作业</li>\n</ul>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "框架",
                "大数据处理框架",
                "java",
                "大数据"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/java-application/spring-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/java-application/spring-1/",
            "title": "spring",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"java应用程序框架之spring\"><a class=\"anchor\" href=\"#java应用程序框架之spring\">#</a> java 应用程序框架之 spring</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>介绍 Spring 框架的背景和优势，以及本文要讨论的主题和目的。</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "框架",
                "java应用程序框架",
                "spring"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/java-application/springboot-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/java-application/springboot-1/",
            "title": "Spring Boot框架",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"spring-boot框架\"><a class=\"anchor\" href=\"#spring-boot框架\">#</a> Spring Boot 框架</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>介绍 Spring Boot 框架的背景和优势，以及本文要讨论的主题和目的。</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "框架",
                "java应用程序框架",
                "springboot"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/cache/ehcache-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/cache/ehcache-1/",
            "title": "Ehcache",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"缓存之ehcache\"><a class=\"anchor\" href=\"#缓存之ehcache\">#</a> 缓存之 Ehcache</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>Ehcache</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "中间件",
                "缓存",
                "缓存"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/cache/redis-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/cache/redis-1/",
            "title": "redis",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"缓存之redis\"><a class=\"anchor\" href=\"#缓存之redis\">#</a> 缓存之 redis</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>redis</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "中间件",
                "缓存",
                "缓存"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/message-queue/kafkamq-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/message-queue/kafkamq-1/",
            "title": "kafka消息队列",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"消息队列之kafka\"><a class=\"anchor\" href=\"#消息队列之kafka\">#</a> 消息队列之 kafka</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>kafka</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "中间件",
                "消息队列",
                "消息队列"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/message-queue/rabbitmq-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/message-queue/rabbitmq-1/",
            "title": "rabbit消息队列",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"消息队列之rabbit\"><a class=\"anchor\" href=\"#消息队列之rabbit\">#</a> 消息队列之 rabbit</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>rabbit</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "中间件",
                "消息队列",
                "消息队列"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/message-queue/rocketmq-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/middleware/message-queue/rocketmq-1/",
            "title": "rocket消息队列",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"消息队列之rocket\"><a class=\"anchor\" href=\"#消息队列之rocket\">#</a> 消息队列之 rocket</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>rocket</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "中间件",
                "消息队列",
                "消息队列"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/program-language/java/java-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/program-language/java/java-1/",
            "title": "java编程语言",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"java编程语言\"><a class=\"anchor\" href=\"#java编程语言\">#</a> java 编程语言</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>java</p>\n<h2 id=\"spring-boot简介\"><a class=\"anchor\" href=\"#spring-boot简介\">#</a> Spring Boot 简介</h2>\n<p>介绍 Spring Boot 框架的特点、优势和适用场景，以及与传统 Spring 框架的区别。</p>\n<h2 id=\"搭建spring-boot项目\"><a class=\"anchor\" href=\"#搭建spring-boot项目\">#</a> 搭建 Spring Boot 项目</h2>\n<p>详细说明如何创建一个简单的 Spring Boot 项目，包括项目结构、依赖管理和配置文件等。</p>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"部署与测试\"><a class=\"anchor\" href=\"#部署与测试\">#</a> 部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "编程语言",
                "Java",
                "java"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/big-data-processing/chunjun-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/big-data-processing/chunjun-1/",
            "title": "chunjun",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"大数据管理框架之chunjun\"><a class=\"anchor\" href=\"#大数据管理框架之chunjun\">#</a> 大数据管理框架之 chunjun</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>是一款稳定、易用、高效、批流一体的数据集成框架，目前基于实时计算引擎 Flink 实现多种异构数据源之间的数据同步与计算，已在上千家公司部署且稳定运行。</p>\n<p>官网：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9kdHN0YWNrLmdpdGh1Yi5pby9jaHVuanVuLw==\">https://dtstack.github.io/chunjun/</span></p>\n<p>选择版本下载：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL0RUU3RhY2svY2h1bmp1bg==\">https://github.com/DTStack/chunjun</span></p>\n<h2 id=\"部署\"><a class=\"anchor\" href=\"#部署\">#</a> 部署</h2>\n<ol>\n<li>下载安装包</li>\n</ol>\n<h2 id=\"扩展\"><a class=\"anchor\" href=\"#扩展\">#</a> 扩展</h2>\n<p>扩展达梦不支持实时更新操作，其实就是达梦端需要监听到修改的记录如何通过 chunjun 更新到 sink 端，达梦和 oracle 非常类似，所有这里改造 oracle 的 logminer（达梦也有）</p>\n<h3 id=\"logminer是什么\"><a class=\"anchor\" href=\"#logminer是什么\">#</a> logminer 是什么</h3>\n<p>LogMiner 是 Oracle 公司从产品 8i 以后提供的一个实际非常有用的分析工具，使用该工具可以轻松获得 Oracle  重做日志文件（归档日志文件）中的具体内容，LogMiner 分析工具实际上是由一组 PL/SQL 包和一些动态视图组成，它作为 Oracle  数据库的一部分来发布，是 oracle 公司提供的一个完全免费的工具。</p>\n<p>具体的说： 对用户数据或数据库字典所做的所有更改都记录在 Oracle 重做日志文件 RedoLog 中，Logminer 就是一个解析 RedoLog 的工具，通过 Logminer 解析 RedoLog 可以得到对应的 SQL 数据。</p>\n<p>Oracle 中的 RedoLog 写入流程: Oracle 重做日志采用<strong>循环写入</strong>的方式，每一个 Oracle 实例至少拥有<strong> 2 组日志组</strong>。Oracle 重做日志一般由 Oracle 自动切换，重做日志文件在当 LGWR 进程停止写入并开始写入下一个日志组时发生切换，或在用户收到发出 ALTER SYSTEM SWITCH LOGFILE 时发生切换。如果 Oracle  数据库开启了归档功能，则在日志组发生切换的时候，上一个日志组的日志文件会被归档到归档目录里</p>\n<p>从上面可知 Oracle 里的 RedoLog 文件分为两种：</p>\n<ul>\n<li>当前写的日志组的文件，可通过 v<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mtext>和</mtext><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">log 和 v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord cjk_fallback\">和</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>logfile 得到</li>\n<li>归档的 redoLog 文件，可通过 v$archived_log 得到</li>\n</ul>\n<p>v$log 文档 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vY2QvQjE5MzA2XzAxL3NlcnZlci4xMDIvYjE0MjM3L2R5bnZpZXdzXzExNTAuaHRtI1JFRlJOMzAxMjc=\">https://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_1150.htm#REFRN30127</span></p>\n<p>v$logfile 文档 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vY2QvQjI4MzU5XzAxL3NlcnZlci4xMTEvYjI4MzIwL2R5bnZpZXdzXzIwMzEuaHRtI1JFRlJOMzAxMjk=\">https://docs.oracle.com/cd/B28359_01/server.111/b28320/dynviews_2031.htm#REFRN30129</span></p>\n<p>v$archived_log 文档 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vY2QvRTE4MjgzXzAxL3NlcnZlci4xMTIvZTE3MTEwL2R5bnZpZXdzXzEwMTYuaHRt\">https://docs.oracle.com/cd/E18283_01/server.112/e17110/dynviews_1016.htm</span></p>\n<p><strong>通过循环查找到最新符合要求的 RedoLog 并让 Logminer 加载分析，分析的数据在视图 v<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mi>m</mi><mi>n</mi><msub><mi>r</mi><mi>c</mi></msub><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>s</mi><mtext>里，通过读取</mtext><mi>v</mi></mrow><annotation encoding=\"application/x-tex\">logmnr_contents 里，通过读取 v</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">n</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord cjk_fallback\">里</span><span class=\"mord cjk_fallback\">，</span><span class=\"mord cjk_fallback\">通</span><span class=\"mord cjk_fallback\">过</span><span class=\"mord cjk_fallback\">读</span><span class=\"mord cjk_fallback\">取</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span>logmnr_contents 就可以得到 Oracle 的实时数据</strong></p>\n<h3 id=\"dm配置logminer\"><a class=\"anchor\" href=\"#dm配置logminer\">#</a> Dm 配置 LogMiner</h3>\n<p>注意：</p>\n<p>若数据量太大导致日志组频繁切换需要增加日志组数量，增大单个日志组存储大小</p>\n<h3 id=\"一-dm-8单机版\"><a class=\"anchor\" href=\"#一-dm-8单机版\">#</a> 一、Dm 8 (单机版)</h3>\n<h4 id=\"1-查询dm版本信息这里配置的是dm-8\"><a class=\"anchor\" href=\"#1-查询dm版本信息这里配置的是dm-8\">#</a> 1、查询 Dm 版本信息，这里配置的是 <code>Dm 8</code></h4>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 查看 dm 版本</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">select</span> <span class=\"token operator\">*</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">from</span> v$version<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p><img data-src=\"images%5Cchunjun-1.png\" alt=\"image\" /></p>\n<p>本章 DM 的版本如上图所示。</p>\n<h4 id=\"2-查看dm是否开启日志归档\"><a class=\"anchor\" href=\"#2-查看dm是否开启日志归档\">#</a> 2、查看 Dm 是否开启日志归档</h4>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 查询数据库归档模式</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> PARA_NAME<span class=\"token punctuation\">,</span> PARA_VALUE <span class=\"token keyword\">FROM</span> V$DM_INI <span class=\"token keyword\">WHERE</span> PARA_NAME <span class=\"token operator\">IN</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'ARCH_INI'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">select</span> ARCH_MODE <span class=\"token keyword\">from</span> v$<span class=\"token keyword\">database</span></pre></td></tr></table></figure><p><img data-src=\"images%5Cchunjun-2.png\" alt=\"image\" /></p>\n<p><img data-src=\"images%5Cchunjun-3.png\" alt=\"image\" /></p>\n<p>图中显示 <code>PARA_VALUE=1</code>  表示开启日志归档。</p>\n<p>图中显示 `ARCH_MODE=Y 表示开启日志归档。</p>\n<h4 id=\"3-开启日志归档\"><a class=\"anchor\" href=\"#3-开启日志归档\">#</a> 3、开启日志归档</h4>\n<p>注意：开启日志归档需要重启数据库</p>\n<h5 id=\"a-配置归档日志保存的路径\"><a class=\"anchor\" href=\"#a-配置归档日志保存的路径\">#</a> a、配置归档日志保存的路径</h5>\n<p>根据自身环境配置归档日志保存路径，需要提前创建相应目录及赋予相应访问权限</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># 创建归档日志保存目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /dm8/arch</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\"># 对归档日志保存目录赋予相应权限</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">chown</span> <span class=\"token parameter variable\">-R</span> <span class=\"token number\">777</span> /dm8/arch</pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\"># 开启归档日志解析内容包含所有字段</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>alter SYSTEM <span class=\"token builtin class-name\">set</span> <span class=\"token string\">'RLOG_APPEND_LOGIC'</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span> both<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#可通过下面语句查看修改的情况</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">select</span> PARA_NAME, PARA_VALUE from <span class=\"token function\">v</span><span class=\"token variable\">$dm_ini</span> where para_name <span class=\"token operator\">=</span> <span class=\"token string\">'RLOG_APPEND_LOGIC'</span></pre></td></tr></table></figure><p><img data-src=\"images%5Cchunjun-4.png\" alt=\"image\" /></p>\n<h5 id=\"b-切换数据库到配置状态\"><a class=\"anchor\" href=\"#b-切换数据库到配置状态\">#</a> b、切换数据库到配置状态</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">alter</span> <span class=\"token keyword\">database</span> mount<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"c-设置本地归档\"><a class=\"anchor\" href=\"#c-设置本地归档\">#</a> c、设置本地归档</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 设置本地归档，归档路径，归档尺寸</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">alter</span> <span class=\"token keyword\">database</span> <span class=\"token keyword\">add</span> ARCHIVELOG <span class=\"token string\">'type=local, dest=/dm8/arch, file_size=64,space_limit=10240'</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"d-开启日志归档\"><a class=\"anchor\" href=\"#d-开启日志归档\">#</a> d、开启日志归档</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 开启日志归档</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">alter</span> <span class=\"token keyword\">database</span> ARCHIVELOG<span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h5 id=\"e-开启数据库\"><a class=\"anchor\" href=\"#e-开启数据库\">#</a> e、开启数据库</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">alter</span> <span class=\"token keyword\">database</span> <span class=\"token keyword\">open</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"4-配置日志组\"><a class=\"anchor\" href=\"#4-配置日志组\">#</a> 4、配置日志组</h4>\n<h5 id=\"a-新增日志组与删除原有日志组\"><a class=\"anchor\" href=\"#a-新增日志组与删除原有日志组\">#</a> a、新增日志组与删除原有日志组</h5>\n<p>请与 DBA 联系，决定是否可以删除原有日志组。</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 查看归档日志</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">select</span> arch_seq<span class=\"token punctuation\">,</span>path<span class=\"token punctuation\">,</span><span class=\"token keyword\">status</span><span class=\"token punctuation\">,</span>arch_lsn <span class=\"token keyword\">from</span> v$arch_file<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 增加一个新的归档日志</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">ALTER</span> SYSTEM ARCHIVE LOG <span class=\"token keyword\">CURRENT</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 删除 10 天前的归档日志文件</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> SF_ARCHIVELOG_DELETE_BEFORE_TIME<span class=\"token punctuation\">(</span>SYSDATE <span class=\"token operator\">-</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 删除 LSN 值小于 38858 之前的归档日志文件</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">SELECT</span> SF_ARCHIVELOG_DELETE_BEFORE_LSN<span class=\"token punctuation\">(</span><span class=\"token number\">38858</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"5-检查是否安装logminer工具\"><a class=\"anchor\" href=\"#5-检查是否安装logminer工具\">#</a> 5、检查是否安装 LogMiner 工具</h4>\n<p>使用包内的过程和函数之前，如果还未创建过系统包，请先调用系统过程创建系统包：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>SP_CREATE_SYSTEM_PACKAGES <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">'DBMS_LOGMNR'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h4 id=\"6-尝试使用logminer工具分析日志文件\"><a class=\"anchor\" href=\"#6-尝试使用logminer工具分析日志文件\">#</a> 6、尝试使用 LogMiner 工具分析日志文件</h4>\n<h5 id=\"a-查看可以分析的归档日志\"><a class=\"anchor\" href=\"#a-查看可以分析的归档日志\">#</a> a、查看可以分析的归档日志</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 查看所有归档日志</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> NAME <span class=\"token punctuation\">,</span> FIRST_TIME <span class=\"token punctuation\">,</span> NEXT_TIME <span class=\"token punctuation\">,</span> FIRST_CHANGE<span class=\"token comment\"># , NEXT_CHANGE# FROM V$ARCHIVED_LOG;</span></pre></td></tr></table></figure><h5 id=\"b-添加一条归档日志\"><a class=\"anchor\" href=\"#b-添加一条归档日志\">#</a> b、添加一条归档日志</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 添加要分析的文件名</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>DBMS_LOGMNR<span class=\"token punctuation\">.</span>ADD_LOGFILE<span class=\"token punctuation\">(</span><span class=\"token string\">'/dmdata/dmarch/ARCHIVE_LOCAL1_0x2921FFFA[0]_2023-04-10_16-43-20.log'</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 可以查看已经添加分析的归档日志</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">SELECT</span> LOW_SCN<span class=\"token punctuation\">,</span> NEXT_SCN<span class=\"token punctuation\">,</span> LOW_TIME<span class=\"token punctuation\">,</span> HIGH_TIME<span class=\"token punctuation\">,</span> LOG_ID<span class=\"token punctuation\">,</span> FILENAME <span class=\"token keyword\">FROM</span> V$LOGMNR_LOGS</pre></td></tr></table></figure><h5 id=\"c-启动归档日志文件分析\"><a class=\"anchor\" href=\"#c-启动归档日志文件分析\">#</a> c、启动归档日志文件分析</h5>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 开始分析</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>dbms_logmnr<span class=\"token punctuation\">.</span>start_logmnr<span class=\"token punctuation\">(</span>Options<span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token number\">2128</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">-- 关于 Options 参数说明看下图</span></pre></td></tr></table></figure><p><img data-src=\"images%5Cchunjun-5.png\" alt=\"\" /></p>\n<p>d、查看分析结果</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 查看分析结果</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> V$LOGMNR_CONTENTS</pre></td></tr></table></figure><p>e、关闭分析结果</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">-- 关闭分析结果</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>DBMS_LOGMNR<span class=\"token punctuation\">.</span>END_LOGMNR<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><p>注意：在重新分析一个新的归档日志前需要关闭分析结果才能开始</p>\n<p>至此，Dm 数据库 LogMiner 实时采集配置完毕。</p>\n<h3 id=\"达梦-logminer-source\"><a class=\"anchor\" href=\"#达梦-logminer-source\">#</a> 达梦 LogMiner Source</h3>\n<h4 id=\"介绍\"><a class=\"anchor\" href=\"#介绍\">#</a> 介绍</h4>\n<p>DmLogMiner 插件支持配置监听表名称以及读取起点读取日志数据。DmLogMiner 在 checkpoint 时保存当前消费的位点，因此支持续跑。</p>\n<p>其实就是持续读取达梦归档日志的内容并解析归档日志就能得到是什么类型的操作，读取成功并且写入到 sink 端后，将 lsn 后移</p>\n<h4 id=\"支持版本\"><a class=\"anchor\" href=\"#支持版本\">#</a> 支持版本</h4>\n<p>dm7,dm8</p>\n<h4 id=\"插件名称\"><a class=\"anchor\" href=\"#插件名称\">#</a> 插件名称</h4>\n<table>\n<thead>\n<tr>\n<th>Sync</th>\n<th>DmLogMinerreader、DmLogMinersource</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>SQL</td>\n<td>DmLogMiner-x</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"参数说明\"><a class=\"anchor\" href=\"#参数说明\">#</a> 参数说明</h4>\n<h5 id=\"1-sync\"><a class=\"anchor\" href=\"#1-sync\">#</a> 1、Sync</h5>\n<ul>\n<li>\n<p><strong>jdbcUrl</strong></p>\n<ul>\n<li>描述：Dm 数据库的 JDBC URL 链接</li>\n<li>必选：是</li>\n<li>参数类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>username</strong></p>\n<ul>\n<li>描述：用户名</li>\n<li>必选：是</li>\n<li>参数类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>password</strong></p>\n<ul>\n<li>描述：密码</li>\n<li>必选：是</li>\n<li>参数类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>table</strong></p>\n<ul>\n<li>描述： 需要监听的表，格式为：schema.table，schema 不能配置为 *，但 table 可以配置<em>监听指定库下所有的表，如：[&quot;schema1.table1&quot;,&quot;schema1.table2&quot;,&quot;schema2.</em>&quot;]</li>\n<li>必选：否，不配置则监听除 <code>SYS</code>  库以外的所有库的所有表变更信息</li>\n<li>字段类型：数组</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>splitUpdate</strong></p>\n<ul>\n<li>描述：当数据更新类型为 update 时，是否将 update 拆分为两条数据，具体见【七、数据结构说明】</li>\n<li>必选：否</li>\n<li>字段类型：boolean</li>\n<li>默认值：false</li>\n</ul>\n</li>\n<li>\n<p><strong>cat</strong></p>\n<ul>\n<li>描述：需要监听的操作数据操作类型，有 UPDATE,INSERT,DELETE 三种可选，大小写不敏感，多个以，分割</li>\n<li>必选：否</li>\n<li>字段类型：String</li>\n<li>默认值：UPDATE,INSERT,DELETE</li>\n</ul>\n</li>\n<li>\n<p><strong>readPosition</strong></p>\n<ul>\n<li>描述：Dm 实时采集的采集起点</li>\n<li>可选值：\n<ul>\n<li>all： 从 Dm 数据库中最早的归档日志组开始采集 (不建议使用)</li>\n<li>current：从任务运行时开始采集</li>\n<li>time： 从指定时间点开始采集</li>\n<li>scn： 从指定 SCN 号处开始采集</li>\n</ul>\n</li>\n<li>必选：否</li>\n<li>字段类型：String</li>\n<li>默认值：current</li>\n</ul>\n</li>\n<li>\n<p><strong>startTime</strong></p>\n<ul>\n<li>描述： 指定采集起点的毫秒级时间戳</li>\n<li>必选：当 <code>readPosition</code>  为 <code>time</code>  时，该参数必填</li>\n<li>字段类型：Long (毫秒级时间戳)</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>startSCN</strong></p>\n<ul>\n<li>描述： 指定采集起点的 SCN 号</li>\n<li>必选：当 <code>readPosition</code>  为 <code>scn</code>  时，该参数必填</li>\n<li>字段类型：String</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>fetchSize</strong></p>\n<ul>\n<li>描述： 批量从 v$logmnr_contents 视图中拉取的数据条数，对于大数据量的数据变更，调大该值可一定程度上增加任务的读取速度</li>\n<li>必选：否</li>\n<li>字段类型：Integer</li>\n<li>默认值：1000</li>\n</ul>\n</li>\n<li>\n<p><strong>queryTimeout</strong></p>\n<ul>\n<li>描述： LogMiner 执行查询 SQL 的超时参数，单位秒</li>\n<li>必选：否</li>\n<li>字段类型：Long</li>\n<li>默认值：300</li>\n</ul>\n</li>\n<li>\n<p><strong>supportAutoAddLog</strong></p>\n<ul>\n<li>描述：启动 LogMiner 是否自动添加日志组 (不建议使用)</li>\n<li>必选：否</li>\n<li>字段类型：Boolean</li>\n<li>默认值：false</li>\n</ul>\n</li>\n<li>\n<p><strong>pavingData</strong></p>\n<ul>\n<li>描述：是否将解析出的 json 数据拍平，具体见【七、数据结构说明】</li>\n<li>必选：否</li>\n<li>字段类型：boolean</li>\n<li>默认值：false</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"2-sql\"><a class=\"anchor\" href=\"#2-sql\">#</a> 2、SQL</h5>\n<ul>\n<li>\n<p><strong>url</strong></p>\n<ul>\n<li>描述：Dm 数据库的 JDBC URL 链接</li>\n<li>必选：是</li>\n<li>参数类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>username</strong></p>\n<ul>\n<li>描述：用户名</li>\n<li>必选：是</li>\n<li>参数类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>password</strong></p>\n<ul>\n<li>描述：密码</li>\n<li>必选：是</li>\n<li>参数类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>table</strong></p>\n<ul>\n<li>描述：需要解析的数据表。</li>\n<li>注意：SQL 任务只支持监听单张表，且数据格式为 schema.table</li>\n<li>必选：否</li>\n<li>字段类型：string</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>cat</strong></p>\n<ul>\n<li>描述：需要监听的操作数据操作类型，有 UPDATE,INSERT,DELETE 三种可选，大小写不敏感，多个以，分割</li>\n<li>必选：否</li>\n<li>字段类型：String</li>\n<li>默认值：UPDATE,INSERT,DELETE</li>\n</ul>\n</li>\n<li>\n<p><strong>read-position</strong></p>\n<ul>\n<li>描述：Dm 实时采集的采集起点</li>\n<li>可选值：\n<ul>\n<li>all： 从 Dm 数据库中最早的归档日志组开始采集 (不建议使用)</li>\n<li>current：从任务运行时开始采集</li>\n<li>time： 从指定时间点开始采集</li>\n<li>scn： 从指定 SCN 号处开始采集</li>\n</ul>\n</li>\n<li>必选：否</li>\n<li>字段类型：String</li>\n<li>默认值：current</li>\n</ul>\n</li>\n<li>\n<p><strong>start-time</strong></p>\n<ul>\n<li>描述： 指定采集起点的毫秒级时间戳</li>\n<li>必选：当 <code>readPosition</code>  为 <code>time</code>  时，该参数必填</li>\n<li>字段类型：Long (毫秒级时间戳)</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>start-scn</strong></p>\n<ul>\n<li>描述： 指定采集起点的 SCN 号</li>\n<li>必选：当 <code>readPosition</code>  为 <code>scn</code>  时，该参数必填</li>\n<li>字段类型：String</li>\n<li>默认值：无</li>\n</ul>\n</li>\n<li>\n<p><strong>fetch-size</strong></p>\n<ul>\n<li>描述： 批量从 v$logmnr_contents 视图中拉取的数据条数，对于大数据量的数据变更，调大该值可一定程度上增加任务的读取速度</li>\n<li>必选：否</li>\n<li>字段类型：Integer</li>\n<li>默认值：1000</li>\n</ul>\n</li>\n<li>\n<p><strong>query-timeout</strong></p>\n<ul>\n<li>描述： LogMiner 执行查询 SQL 的超时参数，单位秒</li>\n<li>必选：否</li>\n<li>字段类型：Long</li>\n<li>默认值：300</li>\n</ul>\n</li>\n<li>\n<p><strong>support-auto-add-log</strong></p>\n<ul>\n<li>描述：启动 LogMiner 是否自动添加日志组 (不建议使用)</li>\n<li>必选：否</li>\n<li>字段类型：Boolean</li>\n<li>默认值：false</li>\n</ul>\n</li>\n<li>\n<p><strong>io-threads</strong></p>\n<ul>\n<li>描述：IO 处理线程数，最大线程数为 3</li>\n<li>必选：否</li>\n<li>字段类型：int</li>\n<li>默认值：1</li>\n</ul>\n</li>\n<li>\n<p><strong>max-log-file-size</strong></p>\n<ul>\n<li>描述：logminer 一次性加载的日志文件的大小，默认 5g，单位 byte</li>\n<li>必选：否</li>\n<li>字段类型：long</li>\n<li>默认值：5<em>1024</em>1024*1024</li>\n</ul>\n</li>\n<li>\n<p><strong>transaction-cache-num-size</strong></p>\n<ul>\n<li>描述：logminer 可缓存 DML 的数量</li>\n<li>必选：否</li>\n<li>字段类型：long</li>\n<li>默认值：800</li>\n</ul>\n</li>\n<li>\n<p><strong>transaction-expire-time</strong></p>\n<ul>\n<li>描述：logminer 可缓存的失效时间，单位分钟</li>\n<li>必选：否</li>\n<li>字段类型：int</li>\n<li>默认值：20</li>\n</ul>\n</li>\n<li>\n<p><strong>start-mode</strong></p>\n<ul>\n<li>描述：执行的模式，当为 <code>full</code>  则等待全量执行完毕才会执行增量， 当为 <code>increment</code>  则直接执行增量</li>\n<li>必选：否</li>\n<li>字段类型：string</li>\n<li>默认值：full</li>\n</ul>\n</li>\n<li>\n<p><strong>case-sensitive</strong></p>\n<ul>\n<li>描述：配置的 flinksql 的 ddl 结构表是否和数据的表字段区分大小写</li>\n<li>必选：否</li>\n<li>字段类型：Boolean</li>\n<li>默认值：false</li>\n</ul>\n</li>\n<li>\n<p><strong>file-cache-path</strong></p>\n<ul>\n<li>描述：当内存中存储的数据超过阈值，内存数据转存到文件的文件路径</li>\n<li>必选：否</li>\n<li>字段类型：String</li>\n<li>默认值：System.getProperty (&quot;user.dir&quot;) + &quot;/dm_file_cache&quot;</li>\n</ul>\n</li>\n<li>\n<p><strong>file-cache-critical-value</strong></p>\n<ul>\n<li>描述：内存存储归档日志数据的记录数大小的阈值，超过阈值则会转存到 <code>file-cache-path</code> ，根据机器性能调整</li>\n<li>必选：否</li>\n<li>字段类型：Long</li>\n<li>默认值：2000</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"数据结构\"><a class=\"anchor\" href=\"#数据结构\">#</a> 数据结构</h4>\n<p>在 2021-06-29 23:42:19 (时间戳：1624981339000) 执行：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">INSERT</span> <span class=\"token keyword\">INTO</span> TIEZHU<span class=\"token punctuation\">.</span>RESULT1 <span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"name\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"age\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">VALUES</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span></pre></td></tr></table></figure><p>在 2021-06-29 23:42:29 (时间戳：1624981349000) 执行：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">UPDATE</span> TIEZHU<span class=\"token punctuation\">.</span>RESULT1 t</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">SET</span> t<span class=\"token punctuation\">.</span><span class=\"token string\">\"id\"</span>  <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    t<span class=\"token punctuation\">.</span><span class=\"token string\">\"age\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">112</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">WHERE</span> t<span class=\"token punctuation\">.</span><span class=\"token string\">\"id\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span></pre></td></tr></table></figure><p>在 2021-06-29 23:42:34 (时间戳：1624981354000) 执行：</p>\n<figure class=\"highlight sql\"><figcaption data-lang=\"SQL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">DELETE</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> <span class=\"token keyword\">FROM</span> TIEZHU<span class=\"token punctuation\">.</span>RESULT1</pre></td></tr><tr><td data-num=\"3\"></td><td><pre> <span class=\"token keyword\">WHERE</span> <span class=\"token string\">\"id\"</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span></pre></td></tr></table></figure><p>1、pavingData = true, splitUpdate = false RowData 中的数据依次为：</p>\n<pre><code>//scn schema, table, ts, opTime, type, before_id, before_name, before_age, after_id, after_name, after_age\n[49982945,&quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665753853923328, &quot;2021-06-29 23:42:19.0&quot;, &quot;INSERT&quot;, null, null, null, 1, &quot;a&quot;, 12]\n[49982969,&quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796098953216, &quot;2021-06-29 23:42:29.0&quot;, &quot;UPDATE&quot;, 1, &quot;a&quot;, 12 , 2, &quot;a&quot;, 112]\n[49982973,&quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796140896256, &quot;2021-06-29 23:42:34.0&quot;, &quot;DELETE&quot;, 2, &quot;a&quot;,112 , null, null, null]\n</code></pre>\n<p>2、pavingData = false, splitUpdate = false RowData 中的数据依次为：</p>\n<pre><code>//scn, schema, table,  ts, opTime, type, before, after\n[49982945, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665753853923328, &quot;2021-06-29 23:42:19.0&quot;, &quot;INSERT&quot;, null, &#123;&quot;id&quot;:1, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:12&#125;]\n[49982969, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796098953216, &quot;2021-06-29 23:42:29.0&quot;, &quot;UPDATE&quot;, &#123;&quot;id&quot;:1, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:12&#125;, &#123;&quot;id&quot;:2, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:112&#125;]\n[49982973, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796140896256, &quot;2021-06-29 23:42:34.0&quot;, &quot;DELETE&quot;, &#123;&quot;id&quot;:2, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:112&#125;, null]\n</code></pre>\n<p>3、pavingData = true, splitUpdate = true RowData 中的数据依次为：</p>\n<pre><code>//scn, schema, table, ts, opTime, type, before_id, before_name, before_age, after_id, after_name, after_age\n[49982945,&quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665753853923328, &quot;2021-06-29 23:42:19.0&quot;, &quot;INSERT&quot;, null, null, null, 1, &quot;a&quot;,12 ]\n\n//scn, schema, table, opTime, ts, type, before_id, before_name, before_age\n[49982969, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796098953216, &quot;2021-06-29 23:42:29.0&quot;, &quot;UPDATE_BEFORE&quot;, 1, &quot;a&quot;, 12]\n//scn, schema, table, opTime, ts, type, after_id, after_name, after_age\n[49982969, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796098953216, &quot;2021-06-29 23:42:29.0&quot;, &quot;UPDATE_AFTER&quot;, 2, &quot;a&quot;, 112]\n\n//scn, schema, table, ts, opTime, type, before_id, before_name, before_age, after_id, after_name, after_age\n[49982973, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796140896256,  &quot;2021-06-29 23:42:34.0&quot;, &quot;DELETE&quot;, 2, &quot;a&quot;, 112, null, null, null]\n\n\n</code></pre>\n<p>4、pavingData = false, splitUpdate = true RowData 中的数据依次为：</p>\n<pre><code>//scn, schema, table,  ts, opTime, type, before, after\n[49982945, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665753853923328, &quot;2021-06-29 23:42:19.0&quot;, &quot;INSERT&quot;, null, &#123;&quot;id&quot;:1, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:12&#125;]\n//scn, schema, table,  ts, opTime, type, before\n[49982969, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796098953216, &quot;2021-06-29 23:42:29.0&quot;, &quot;UPDATE_BEFORE&quot;, &#123;&quot;id&quot;:1, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:12&#125;]\n//scn, schema, table,  ts, opTime, type, after\n[49982969, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796098953216, &quot;2021-06-29 23:42:29.0&quot;, &quot;UPDATE_AFTER&quot;, &#123;&quot;id&quot;:2, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:112&#125;]\n//scn, schema, table, ts, opTime, type, before, after\n[49982973, &quot;TIEZHU&quot;, &quot;RESULT1&quot;, 6815665796140896256, &quot;2021-06-29 23:42:34.0&quot;,  &quot;DELETE&quot;, &#123;&quot;id&quot;:2, &quot;name&quot;:&quot;a&quot;, &quot;age&quot;:112&#125;, null]\n\n</code></pre>\n<ul>\n<li>scn：Dm 数据库变更记录对应的 scn 号</li>\n<li>type：变更类型，INSERT，UPDATE、DELETE</li>\n<li>opTime：数据库中 SQL 的执行时间</li>\n<li>ts：自增 ID，不重复，可用于排序，解码后为 ChunJun 的事件时间，解码规则如下:</li>\n</ul>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">long</span> id<span class=\"token operator\">=</span><span class=\"token class-name\">Long</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseLong</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"6815665753853923328\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token keyword\">long</span> res<span class=\"token operator\">=</span>id<span class=\"token operator\">>></span><span class=\"token number\">22</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token class-name\">DateFormat</span> sdf<span class=\"token operator\">=</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">SimpleDateFormat</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"yyyy-MM-dd HH:mm:ss\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>sdf<span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">//2021-06-29 23:42:24</span></pre></td></tr></table></figure><h4 id=\"数据类型\"><a class=\"anchor\" href=\"#数据类型\">#</a> 数据类型</h4>\n<table>\n<thead>\n<tr>\n<th>是否支持</th>\n<th>数据类型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>支持</td>\n<td>DATE,TIMESTAMP,TIMESTAMP WITH LOCAL TIME ZONE,TIMESTAMP WITH TIME ZONE, CHAR,NCHAR,NVARCHAR2,ROWID,VARCHAR2,VARCHAR,LONG,RAW,LONG RAW,INTERVAL YEAR,INTERVAL DAY,BLOB,CLOB,NCLOB, NUMBER,SMALLINT,INT INTEGER,FLOAT,DECIMAL,NUMERIC,BINARY_FLOAT,BINARY_DOUBLE</td>\n</tr>\n<tr>\n<td>不支持</td>\n<td>BFILE,XMLTYPE,Collections</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"脚本示例\"><a class=\"anchor\" href=\"#脚本示例\">#</a> 脚本示例</h4>\n<p>见项目内 <code>ChunJun : Local : Test</code>  模块中的 <code>demo</code>  文件夹。</p>\n<h2 id=\"总结\"><a class=\"anchor\" href=\"#总结\">#</a> 总结</h2>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n",
            "tags": [
                "计算机科学",
                "框架",
                "大数据处理框架",
                "java",
                "大数据"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/liquibase/liquibase-1/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/framework/liquibase/liquibase-1/",
            "title": "数据库版本控制-liqiubase",
            "date_published": "2024-03-24T12:46:25.000Z",
            "content_html": "<h1 id=\"数据库版本控制-liqiubase\"><a class=\"anchor\" href=\"#数据库版本控制-liqiubase\">#</a> 数据库版本控制 - liqiubase</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>LiquiBase 是一个用于数据库重构和迁移的开源工具，通过日志文件的形式记录数据库的变更，然后执行日志文件中的修改，将数据库更新或回滚到一致的状态。</p>\n<ul>\n<li>LiquiBase 的主要特点有：<br />\n支持几乎所有主流的数据库，如 MySQL, PostgreSQL, Oracle, Sql Server, DB2 等</li>\n<li>支持多开发者的协作维护</li>\n<li>日志文件支持多种格式，如 XML, YAML, JSON, SQL 等</li>\n<li>支持多种运行方式，如命令行、Spring 集成、Maven 插件、Gradle 插件等</li>\n</ul>\n<h2 id=\"同类型其他产品\"><a class=\"anchor\" href=\"#同类型其他产品\">#</a> 同类型其他产品</h2>\n<p>liquibase 主要特性</p>\n<ul>\n<li>灵活的 Schema 变更：支持 SQL, XML, JSON, and YAML 语言</li>\n<li>自动生成可 review 的 SQL 脚本</li>\n<li>支持可重复和不可重复执行的变更</li>\n<li>集成和扩展能力</li>\n<li>自动或者通过自定义回滚 SQL 撤销数据库的变更</li>\n<li>使用上下文和前提条件来微调脚本的执行</li>\n<li>Liquibase hub 实时监控和可观测能力</li>\n</ul>\n<p>Flyway 主要特性</p>\n<ul>\n<li>基于 SQL/JAVA 变更</li>\n<li>重复变更</li>\n<li>撤销变更</li>\n<li>Callback</li>\n<li>批量变更</li>\n<li>....</li>\n</ul>\n<p>这里为什么使用 liquibase 是因为我在用集成 flyway 对旧版本的 sqlserver 需要社区版才支持，而 liquibase 对 sql 变更更灵活</p>\n<h2 id=\"整合spring-boot\"><a class=\"anchor\" href=\"#整合spring-boot\">#</a> 整合 spring boot</h2>\n<p>本章 liquibase 整合 springboot 是以组件的方式封装的，通过自定义配置项目是否需要启用数据库版本控制。</p>\n<p>本项目是一个用 mybatis 实现可动态添加多数据源的项目，所以 liquibase 也需要动态的为多数据源添加版本控制</p>\n<p>要实现多数据源的版本控制需要先实现单个的，下面是单个数据源的整合步骤：</p>\n<h3 id=\"单数据源整合\"><a class=\"anchor\" href=\"#单数据源整合\">#</a> 单数据源整合</h3>\n<ol>\n<li>\n<p><code>pox.xml</code>  文件</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.liquibase<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>liquibase-core<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><p>​</p>\n</li>\n<li>\n<p>配置 application.yml</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">liquibase</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">change-log</span><span class=\"token punctuation\">:</span> classpath<span class=\"token punctuation\">:</span>liquibase/master.xml <span class=\"token comment\">#指定 master.xml 文件的位置</span></pre></td></tr></table></figure></li>\n<li>\n<p>新建 master.xml（用于配置你的增量脚本）</p>\n<p>master.xml 配置如下（示例）</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token prolog\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>databaseChangeLog</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token attr-name\">xmlns</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.liquibase.org/xml/ns/dbchangelog<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>xsi</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.w3.org/2001/XMLSchema-instance<span class=\"token punctuation\">\"</span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token attr-name\"><span class=\"token namespace\">xsi:</span>schemaLocation</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.liquibase.org/xml/ns/dbchangelog</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">&lt;!-- id：唯一 id author：修改人 --></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>changeSet</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>1.0.0-20240318-001<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">author</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Tz<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">&lt;!-- 使用 sql 脚本 一些建表语句和插入语句 --></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>sqlFile</span> <span class=\"token attr-name\">path</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>classpath:db/mysql/master/scaffold_init.sql<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>changeSet</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>databaseChangeLog</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure></li>\n<li>\n<p>注册 liquibase bean</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LiquibaseConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@ConfigurationProperties</span><span class=\"token punctuation\">(</span>prefix <span class=\"token operator\">=</span> <span class=\"token string\">\"spring.liquibase\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">LiquibaseProperties</span> <span class=\"token function\">getLiquibaseProperties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LiquibaseProperties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringLiquibase</span> <span class=\"token function\">liquibase</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token class-name\">LiquibaseProperties</span> liquibaseProperties <span class=\"token operator\">=</span> <span class=\"token function\">getLiquibaseProperties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token class-name\">SpringLiquibase</span> liquibase <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringLiquibase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">setChangeLog</span><span class=\"token punctuation\">(</span>liquibaseProperties<span class=\"token punctuation\">.</span><span class=\"token function\">getChangeLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>       </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">setShouldRun</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token keyword\">return</span> liquibase<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure></li>\n<li>\n<p>到此就实现了单数据源的数据库版本控制了，思考两个问题</p>\n<p>一般项目基本会有多个数据源，而且是不同的数据库，这个时候怎么办</p>\n<p>​</p>\n</li>\n</ol>\n<h3 id=\"多数据源整合\"><a class=\"anchor\" href=\"#多数据源整合\">#</a> 多数据源整合</h3>\n<p>需要达到的效果：</p>\n<ul class=\"task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_0\" disabled=\"true\" /><label for=\"cbx_0\"> 添加数据源的时候不需要再修改代码，自动注册 liquibase bean</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_1\" disabled=\"true\" /><label for=\"cbx_1\"> 对多种不同的数据库类型都支持，根据 jdbc 连接识别对应的 sql 语句</label></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" id=\"cbx_2\" disabled=\"true\" /><label for=\"cbx_2\"> 在项目启动的时候还可以自动创建数据库，在执行对应的 sql</label></li>\n</ul>\n<p>开始：</p>\n<ol>\n<li>\n<p>项目结构</p>\n<p><img data-src=\"images/liquibase-1.jpg\" alt=\"\" /></p>\n<ol start=\"2\">\n<li>\n<p>pom.xml</p>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependencies</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.liquibase<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>liquibase-core<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.baomidou<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mybatis-plus-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token comment\">&lt;!-- DB 相关 --></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.mysql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mysql-connector-j<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.oracle.database.jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>ojdbc8<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>optional</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>optional</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.postgresql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>postgresql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>optional</span><span class=\"token punctuation\">></span></span>true<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>optional</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.microsoft.sqlserver<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mssql-jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.dameng<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>DmJdbcDriver18<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">&lt;!--            &lt;optional>true&lt;/optional>--></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.baomidou<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>dynamic-datasource-spring-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span> <span class=\"token comment\">&lt;!-- 多数据源 --></span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependencies</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure></li>\n<li>\n<p>application.yml 这里不在是用原来 liquibase 的配置，而是自己定义的</p>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">liquibase</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">changelog</span><span class=\"token punctuation\">:</span> changelog<span class=\"token punctuation\">-</span>master.xml</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>  <span class=\"token comment\"># 数据源配置项</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>  <span class=\"token key atrule\">autoconfigure</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">exclude</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> com.alibaba.druid.spring.boot.autoconfigure.DruidDataSourceAutoConfigure <span class=\"token comment\"># 排除 Druid 的自动配置，使用 dynamic-datasource-spring-boot-starter 配置多数据源</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>  <span class=\"token key atrule\">datasource</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">druid</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># Druid 【监控】相关的全局配置</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token key atrule\">web-stat-filter</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token key atrule\">stat-view-servlet</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token key atrule\">allow</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 设置白名单，不填则允许所有访问</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token key atrule\">url-pattern</span><span class=\"token punctuation\">:</span> /druid/*</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token key atrule\">login-username</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 控制台管理用户名和密码</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token key atrule\">login-password</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token key atrule\">filter</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token key atrule\">stat</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>          <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          <span class=\"token key atrule\">log-slow-sql</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span> <span class=\"token comment\"># 慢 SQL 记录</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          <span class=\"token key atrule\">slow-sql-millis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>          <span class=\"token key atrule\">merge-sql</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token key atrule\">wall</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>          <span class=\"token key atrule\">config</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token key atrule\">multi-statement-allow</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token key atrule\">dynamic</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 多数据源配置</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>      <span class=\"token key atrule\">druid</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># Druid 【连接池】相关的全局配置</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token key atrule\">initial-size</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token comment\"># 初始连接数</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token key atrule\">min-idle</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token comment\"># 最小连接池数量</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token key atrule\">max-active</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span> <span class=\"token comment\"># 最大连接池数量</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        <span class=\"token key atrule\">max-wait</span><span class=\"token punctuation\">:</span> <span class=\"token number\">600000</span> <span class=\"token comment\"># 配置获取连接等待超时的时间，单位：毫秒</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        <span class=\"token key atrule\">time-between-eviction-runs-millis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">60000</span> <span class=\"token comment\"># 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位：毫秒</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        <span class=\"token key atrule\">min-evictable-idle-time-millis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">300000</span> <span class=\"token comment\"># 配置一个连接在池中最小生存的时间，单位：毫秒</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token key atrule\">max-evictable-idle-time-millis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">900000</span> <span class=\"token comment\"># 配置一个连接在池中最大生存的时间，单位：毫秒</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token key atrule\">validation-query</span><span class=\"token punctuation\">:</span> SELECT 1 <span class=\"token comment\"># 配置检测连接是否有效</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        <span class=\"token key atrule\">test-while-idle</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        <span class=\"token key atrule\">test-on-borrow</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        <span class=\"token key atrule\">test-on-return</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>      <span class=\"token key atrule\">primary</span><span class=\"token punctuation\">:</span> master</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>      <span class=\"token key atrule\">datasource</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>        <span class=\"token key atrule\">master</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> scaffold1</pre></td></tr><tr><td data-num=\"46\"></td><td><pre>          <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>mysql<span class=\"token punctuation\">:</span>//127.0.0.1<span class=\"token punctuation\">:</span>3306/$<span class=\"token punctuation\">&#123;</span>spring.datasource.dynamic.datasource.master.name<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">?</span>useSSL=false<span class=\"token important\">&amp;serverTimezone=Asia/Shanghai&amp;allowPublicKeyRetrieval=true&amp;nullCatalogMeansCurrent=true&amp;createDatabaseIfNotExist=true</span> <span class=\"token comment\"># MySQL Connector/J 8.X 连接的示例</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>          <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> root</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>          <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> <span class=\"token number\">123456</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token key atrule\">slave</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 模拟从库，可根据自己需要修改</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> scaffold3</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>          <span class=\"token key atrule\">lazy</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span> <span class=\"token comment\"># 开启懒加载，保证启动速度</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>          <span class=\"token key atrule\">url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>sqlserver<span class=\"token punctuation\">:</span>//127.0.0.1<span class=\"token punctuation\">:</span>1433;DatabaseName=$<span class=\"token punctuation\">&#123;</span>spring.datasource.dynamic.datasource.slave.name<span class=\"token punctuation\">&#125;</span>;createTablesIfNotExist=true;encrypt=false;trustServerCertificate=true; <span class=\"token comment\"># SQLServer 连接的示例</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>          <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> sa</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>          <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> <span class=\"token number\">123456</span></pre></td></tr></table></figure></li>\n<li>\n<p>代码</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"2\"></td><td><pre> * &lt;p> Project: scaffold - LiquibaseProperties &lt;/p></pre></td></tr><tr><td data-num=\"3\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * 数据库版本控制 liquibase 配置类</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> * @author Tz</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> * @version 1.0.0</pre></td></tr><tr><td data-num=\"7\"></td><td><pre> * @date 2024/02/29 19:13</pre></td></tr><tr><td data-num=\"8\"></td><td><pre> * @since 1.0.0</pre></td></tr><tr><td data-num=\"9\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token annotation punctuation\">@ConfigurationProperties</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"liquibase\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token annotation punctuation\">@Validated</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">LiquibaseProperties</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>     * Change log configuration path.</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> changeLog <span class=\"token operator\">=</span> <span class=\"token string\">\"changelog-master.yaml\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>     * Whether to clear all checksums in the current changelog, so they will be</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>     * recalculated upon the next update.</pre></td></tr><tr><td data-num=\"24\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> clearChecksums<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>     * Comma-separated list of runtime contexts to use.</pre></td></tr><tr><td data-num=\"29\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> contexts<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>     * Default database schema.</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> defaultSchema<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"38\"></td><td><pre>     * Schema to use for Liquibase objects.</pre></td></tr><tr><td data-num=\"39\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> liquibaseSchema<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"43\"></td><td><pre>     * Tablespace to use for Liquibase objects.</pre></td></tr><tr><td data-num=\"44\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> liquibaseTablespace<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>     * Name of table to use for tracking change history.</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> databaseChangeLogTable <span class=\"token operator\">=</span> <span class=\"token string\">\"DATABASECHANGELOG\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>     * Name of table to use for tracking concurrent Liquibase usage.</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> databaseChangeLogLockTable <span class=\"token operator\">=</span> <span class=\"token string\">\"DATABASECHANGELOGLOCK\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>     * Whether to first drop the database schema.</pre></td></tr><tr><td data-num=\"59\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> dropFirst<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"63\"></td><td><pre>     * Whether to enable Liquibase support.</pre></td></tr><tr><td data-num=\"64\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> enabled <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"68\"></td><td><pre>     * Login user of the database to migrate.</pre></td></tr><tr><td data-num=\"69\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> user<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"73\"></td><td><pre>     * Login password of the database to migrate.</pre></td></tr><tr><td data-num=\"74\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> password<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"78\"></td><td><pre>     * Fully qualified name of the JDBC driver. Auto-detected based on the URL by default.</pre></td></tr><tr><td data-num=\"79\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> driverClassName<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"83\"></td><td><pre>     * JDBC URL of the database to migrate. If not set, the primary configured data source</pre></td></tr><tr><td data-num=\"84\"></td><td><pre>     * is used.</pre></td></tr><tr><td data-num=\"85\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> url<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"89\"></td><td><pre>     * Comma-separated list of runtime labels to use.</pre></td></tr><tr><td data-num=\"90\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> labels<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"94\"></td><td><pre>     * Change log parameters.</pre></td></tr><tr><td data-num=\"95\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> parameters<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"99\"></td><td><pre>     * File to which rollback SQL is written when an update is performed.</pre></td></tr><tr><td data-num=\"100\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">File</span> rollbackFile<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre></pre></td></tr><tr><td data-num=\"103\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"104\"></td><td><pre>     * Whether rollback should be tested before update is performed.</pre></td></tr><tr><td data-num=\"105\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">boolean</span> testRollbackOnUpdate<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"107\"></td><td><pre></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"109\"></td><td><pre>     * Tag name to use when applying database changes. Can also be used with</pre></td></tr><tr><td data-num=\"110\"></td><td><pre>     * \"rollbackFile\" to generate a rollback script for all existing changes associated</pre></td></tr><tr><td data-num=\"111\"></td><td><pre>     * with that tag.</pre></td></tr><tr><td data-num=\"112\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"113\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> tag<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"114\"></td><td><pre></pre></td></tr><tr><td data-num=\"115\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre></pre></td></tr><tr><td data-num=\"117\"></td><td><pre></pre></td></tr><tr><td data-num=\"118\"></td><td><pre></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre></pre></td></tr><tr><td data-num=\"121\"></td><td><pre></pre></td></tr><tr><td data-num=\"122\"></td><td><pre></pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre></pre></td></tr><tr><td data-num=\"125\"></td><td><pre></pre></td></tr><tr><td data-num=\"126\"></td><td><pre></pre></td></tr><tr><td data-num=\"127\"></td><td><pre><span class=\"token comment\">// 数据库版本控制启动类</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"129\"></td><td><pre> * &lt;p> Project: scaffold - ScaffoldLiquibaseAutoConfiguration &lt;/p></pre></td></tr><tr><td data-num=\"130\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"131\"></td><td><pre> * Liquibase 数据库版本控制启动类</pre></td></tr><tr><td data-num=\"132\"></td><td><pre> * @author Tz</pre></td></tr><tr><td data-num=\"133\"></td><td><pre> * @version 1.0.0</pre></td></tr><tr><td data-num=\"134\"></td><td><pre> * @date 2024/02/23 18:56</pre></td></tr><tr><td data-num=\"135\"></td><td><pre> * @since 1.0.0</pre></td></tr><tr><td data-num=\"136\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"137\"></td><td><pre><span class=\"token annotation punctuation\">@AutoConfiguration</span><span class=\"token punctuation\">(</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>        after <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">DataSourceAutoConfiguration</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre><span class=\"token annotation punctuation\">@ConditionalOnProperty</span><span class=\"token punctuation\">(</span>prefix <span class=\"token operator\">=</span> <span class=\"token string\">\"liquibase\"</span><span class=\"token punctuation\">,</span> value <span class=\"token operator\">=</span> <span class=\"token string\">\"enabled\"</span><span class=\"token punctuation\">,</span> matchIfMissing <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre><span class=\"token annotation punctuation\">@EnableConfigurationProperties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span><span class=\"token class-name\">LiquibaseProperties</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ScaffoldLiquibaseAutoConfiguration</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringLiquibase</span> <span class=\"token function\">liquibase</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">LiquibaseProperties</span> liquibaseProperties<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DynamicRoutingDataSource</span> dataSource<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DynamicDataSourceProperties</span> dynamicDataSourceProperties<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SQLException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">LiquibaseException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>        <span class=\"token comment\">// 本来想弄成返回一个 list 集合，或者用 beanfactory 但是不行</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre>      \t<span class=\"token comment\">// 投机做法 因为这里会被 liquibase 读取到 会在动态数据源初始化完毕执行，所有在 DynamicLiquibaseSource 中动态注册多个</span></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DynamicLiquibaseSource</span><span class=\"token punctuation\">(</span>liquibaseProperties<span class=\"token punctuation\">,</span> dataSource<span class=\"token punctuation\">,</span> dynamicDataSourceProperties<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">initDynamicLiquibase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre></pre></td></tr><tr><td data-num=\"151\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><strong>DynamicLiquibaseSource.java</strong></p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>dynamic<span class=\"token punctuation\">.</span>datasource<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DynamicRoutingDataSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>dynamic<span class=\"token punctuation\">.</span>datasource<span class=\"token punctuation\">.</span>ds<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ItemDataSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>dynamic<span class=\"token punctuation\">.</span>datasource<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>autoconfigure<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataSourceProperty</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>dynamic<span class=\"token punctuation\">.</span>datasource<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span>boot<span class=\"token punctuation\">.</span>autoconfigure<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DynamicDataSourceProperties</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DbType</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>baomidou<span class=\"token punctuation\">.</span>mybatisplus<span class=\"token punctuation\">.</span>extension<span class=\"token punctuation\">.</span>toolkit<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JdbcUtils</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>tz<span class=\"token punctuation\">.</span>scaffold<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>liquibase<span class=\"token punctuation\">.</span>config<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LiquibaseProperties</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>tz<span class=\"token punctuation\">.</span>scaffold<span class=\"token punctuation\">.</span>framework<span class=\"token punctuation\">.</span>liquibase<span class=\"token punctuation\">.</span>core<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JdbcUrlMetaDataUtil</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Contexts</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LabelExpression</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Liquibase</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span>database<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Database</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span>database<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DatabaseFactory</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span>database<span class=\"token punctuation\">.</span>jvm<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JdbcConnection</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span>exception<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">LiquibaseException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span>integration<span class=\"token punctuation\">.</span>spring<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SpringLiquibase</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">liquibase<span class=\"token punctuation\">.</span>resource<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ClassLoaderResourceAccessor</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">lombok<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">AllArgsConstructor</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">lombok<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Data</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DataSource</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">DatabaseMetaData</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>sql<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">SQLException</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Map</span></span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"27\"></td><td><pre> * &lt;p> Project: scaffold - DynamicLiquibaseSource &lt;/p></pre></td></tr><tr><td data-num=\"28\"></td><td><pre> *</pre></td></tr><tr><td data-num=\"29\"></td><td><pre> * liquibase 动态数据源数据库版本控制初始化器</pre></td></tr><tr><td data-num=\"30\"></td><td><pre> * @author Tz</pre></td></tr><tr><td data-num=\"31\"></td><td><pre> * @version 1.0.0</pre></td></tr><tr><td data-num=\"32\"></td><td><pre> * @date 2024/03/02 19:49</pre></td></tr><tr><td data-num=\"33\"></td><td><pre> * @since 1.0.0</pre></td></tr><tr><td data-num=\"34\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token annotation punctuation\">@Data</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token annotation punctuation\">@AllArgsConstructor</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">DynamicLiquibaseSource</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">LiquibaseProperties</span> liquibaseProperties<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">DynamicRoutingDataSource</span> dataSource<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">DynamicDataSourceProperties</span> dynamicDataSourceProperties<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"47\"></td><td><pre>     * 初始化动态数据库版本控制</pre></td></tr><tr><td data-num=\"48\"></td><td><pre>     * @return liquibase 版本控制器</pre></td></tr><tr><td data-num=\"49\"></td><td><pre>     * @throws SQLException</pre></td></tr><tr><td data-num=\"50\"></td><td><pre>     * @throws LiquibaseException</pre></td></tr><tr><td data-num=\"51\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SpringLiquibase</span> <span class=\"token function\">initDynamicLiquibase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">SQLException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">LiquibaseException</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token comment\">// 读取到多个数据源的配置</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>        <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">DataSourceProperty</span><span class=\"token punctuation\">></span></span> dataSourcePropertyMap <span class=\"token operator\">=</span> dynamicDataSourceProperties<span class=\"token punctuation\">.</span><span class=\"token function\">getDatasource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">DataSource</span> tempDataSource <span class=\"token operator\">:</span> dataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getDataSources</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            <span class=\"token class-name\">String</span> name <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ItemDataSource</span><span class=\"token punctuation\">)</span> tempDataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token comment\">// 根据配置替换数据类型、数据源的名称（master、slav 等）</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            <span class=\"token class-name\">String</span> changeLogPath <span class=\"token operator\">=</span> <span class=\"token string\">\"classpath:db/&#123;JdbcType&#125;/&#123;relation&#125;/\"</span> <span class=\"token operator\">+</span> liquibaseProperties<span class=\"token punctuation\">.</span><span class=\"token function\">getChangeLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token class-name\">DataSourceProperty</span> dataSourceProperty <span class=\"token operator\">=</span> dataSourcePropertyMap<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>          \t<span class=\"token comment\">// 如果不存在数据库则自动创建</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>            <span class=\"token class-name\">JdbcUrlMetaDataUtil</span><span class=\"token punctuation\">.</span><span class=\"token function\">createDataBasesIfNotExists</span><span class=\"token punctuation\">(</span>dataSourceProperty<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dataSourceProperty<span class=\"token punctuation\">.</span><span class=\"token function\">getUsername</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> dataSourceProperty<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>            <span class=\"token class-name\">DatabaseMetaData</span> metaData <span class=\"token operator\">=</span> tempDataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getMetaData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>            <span class=\"token class-name\">DbType</span> dbType <span class=\"token operator\">=</span> <span class=\"token class-name\">JdbcUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDbType</span><span class=\"token punctuation\">(</span>metaData<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dbType<span class=\"token punctuation\">.</span><span class=\"token function\">getDb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sqlserver\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>                changeLogPath <span class=\"token operator\">=</span> changeLogPath<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;JdbcType&#125;\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"sqlserver\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;relation&#125;\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                changeLogPath <span class=\"token operator\">=</span> changeLogPath<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;JdbcType&#125;\"</span><span class=\"token punctuation\">,</span> dbType<span class=\"token punctuation\">.</span><span class=\"token function\">getDb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;relation&#125;\"</span><span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            <span class=\"token comment\">// 手动注册 liquibase</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token class-name\">Database</span> database <span class=\"token operator\">=</span> <span class=\"token class-name\">DatabaseFactory</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">findCorrectDatabaseImplementation</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">JdbcConnection</span><span class=\"token punctuation\">(</span>tempDataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>            <span class=\"token class-name\">Liquibase</span> liquibase <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Liquibase</span><span class=\"token punctuation\">(</span>changeLogPath<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ClassLoaderResourceAccessor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> database<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Contexts</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">LabelExpression</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>      \t<span class=\"token comment\">// 随便返回一个</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>        <span class=\"token class-name\">SpringLiquibase</span> liquibase <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SpringLiquibase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token class-name\">String</span> changeLogPath <span class=\"token operator\">=</span> <span class=\"token string\">\"classpath:db/&#123;JdbcType&#125;/&#123;relation&#125;/\"</span> <span class=\"token operator\">+</span> liquibaseProperties<span class=\"token punctuation\">.</span><span class=\"token function\">getChangeLog</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token class-name\">DatabaseMetaData</span> metaData <span class=\"token operator\">=</span> dataSource<span class=\"token punctuation\">.</span><span class=\"token function\">getConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getMetaData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token class-name\">DbType</span> dbType <span class=\"token operator\">=</span> <span class=\"token class-name\">JdbcUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDbType</span><span class=\"token punctuation\">(</span>metaData<span class=\"token punctuation\">.</span><span class=\"token function\">getURL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        changeLogPath <span class=\"token operator\">=</span> changeLogPath<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;JdbcType&#125;\"</span><span class=\"token punctuation\">,</span> dbType<span class=\"token punctuation\">.</span><span class=\"token function\">getDb</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&#123;relation&#125;\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"master\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">setChangeLog</span><span class=\"token punctuation\">(</span>changeLogPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>        liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>        liquibase<span class=\"token punctuation\">.</span><span class=\"token function\">setShouldRun</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token keyword\">return</span> liquibase<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>​</p>\n</li>\n</ol>\n</li>\n</ol>\n<h2 id=\"编写restful-api\"><a class=\"anchor\" href=\"#编写restful-api\">#</a> 编写 RESTful API</h2>\n<p>演示如何使用 Spring Boot 框架编写 RESTful API，包括控制器、服务层和数据访问层的代码示例。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$<span class=\"token comment\">// 在这里展示 Java 代码示例 $</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@RestController</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HelloController</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/hello\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">sayHello</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, Spring Boot!\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"第四部分部署与测试\"><a class=\"anchor\" href=\"#第四部分部署与测试\">#</a> 第四部分：部署与测试</h2>\n<p>介绍如何将 Spring Boot 应用程序打包部署到服务器上，并进行简单的测试和调试。</p>\n<h2 id=\"第五部分总结\"><a class=\"anchor\" href=\"#第五部分总结\">#</a> 第五部分：总结</h2>\n<p>总结本文介绍的内容，强调 Spring Boot 框架的便利性和灵活性，以及未来的学习和应用方向。</p>\n<h2 id=\"参考资料\"><a class=\"anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9zcHJpbmcuaW8vcHJvamVjdHMvc3ByaW5nLWJvb3Q=\">Spring Boot 官方文档</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL3NwcmluZy1wcm9qZWN0cy9zcHJpbmctYm9vdA==\">Spring Boot GitHub 仓库</span></li>\n</ul>\n",
            "tags": [
                "计算机科学",
                "框架",
                "数据库版本控制",
                "版本控制"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/databases/mysql/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/databases/mysql/",
            "title": "mysql数据库",
            "date_published": "2024-03-24T11:12:45.000Z",
            "content_html": "<h1 id=\"mysql数据库\"><a class=\"anchor\" href=\"#mysql数据库\">#</a> mysql 数据库</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n<p>MySQL 是一个 <code>关系型数据库管理系统</code> ，由瑞典  <code>MySQL AB</code>  公司开发，属于  <code>Oracle</code>  旗下产品。MySQL 是最流行的 <code>关系型数据库管理系统</code> 之一，在  <code>WEB</code>  应用方面，MySQL 是最好的 <code>RDBMS</code>  (Relational Database Management System) 应用软件之一</p>\n<h2 id=\"常用的语法\"><a class=\"anchor\" href=\"#常用的语法\">#</a> 常用的语法</h2>\n<ol>\n<li>​</li>\n</ol>\n",
            "tags": [
                "计算机科学",
                "数据库",
                "mysql"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/tool-install/everything-install/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/tool-install/everything-install/",
            "title": "Everyting本地文件搜索引擎的安装与使用",
            "date_published": "2024-03-24T11:12:45.000Z",
            "content_html": "<h1 id=\"everyting本地文件搜索引擎的安装与使用\"><a class=\"anchor\" href=\"#everyting本地文件搜索引擎的安装与使用\">#</a> Everyting 本地文件搜索引擎的安装与使用</h1>\n<h2 id=\"简介\"><a class=\"anchor\" href=\"#简介\">#</a> 简介</h2>\n",
            "tags": [
                "计算机科学",
                "工具安装与使用",
                "搜索"
            ]
        },
        {
            "id": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/tool-install/jprofile-install/",
            "url": "https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/tool-install/jprofile-install/",
            "title": "jprofile-java性能监视工具",
            "date_published": "2024-03-24T11:12:45.000Z",
            "content_html": "<h1 id=\"jprofile安装与使用\"><a class=\"anchor\" href=\"#jprofile安装与使用\">#</a> jprofile 安装与使用</h1>\n<h2 id=\"介绍\"><a class=\"anchor\" href=\"#介绍\">#</a> 介绍</h2>\n<h2 id=\"安装\"><a class=\"anchor\" href=\"#安装\">#</a> 安装</h2>\n<h2 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h2>\n",
            "tags": [
                "计算机科学",
                "工具安装与使用",
                "sqlserver"
            ]
        }
    ]
}