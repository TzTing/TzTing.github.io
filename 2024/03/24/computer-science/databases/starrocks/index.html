<!-- build time:Tue Apr 23 2024 00:46:46 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/tzblog/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/tzblog/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="一些记录" href="https://mytingting.gitee.io/tzblog/rss.xml"><link rel="alternate" type="application/atom+xml" title="一些记录" href="https://mytingting.gitee.io/tzblog/atom.xml"><link rel="alternate" type="application/json" title="一些记录" href="https://mytingting.gitee.io/tzblog/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/tzblog/css/app.css?v=0.2.5"><meta name="keywords" content="StarRocks"><link rel="canonical" href="https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/databases/starrocks/"><title>StarRocks数据库 - 数据库 - 计算机科学 | Tz = 一些记录 = = 编程、羽毛球、游戏、骑行 =</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">StarRocks数据库</h1><div class="meta"><span class="item" title="创建时间：2024-03-24 19:12:45"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-03-24T19:12:45+08:00">2024-03-24</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>14k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>13 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/tzblog/" rel="start">Tz</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tzting.github.io/images/sky6.jpg"></li><li class="item" data-background-image="https://tzting.github.io/images/sky1.jpg"></li><li class="item" data-background-image="https://tzting.github.io/images/sky2.jpg"></li><li class="item" data-background-image="https://tzting.github.io/images/sky7.jpg"></li><li class="item" data-background-image="https://tzting.github.io/images/sky3.jpg"></li><li class="item" data-background-image="https://tzting.github.io/images/sky10.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/tzblog/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/tzblog/categories/computer-science/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/tzblog/categories/computer-science/databases/" itemprop="item" rel="index" title="分类于 数据库"><span itemprop="name">数据库</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/databases/starrocks/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/tzblog/images/avatar.jpg"><meta itemprop="name" content="Tz"><meta itemprop="description" content="= 编程、羽毛球、游戏、骑行 =, 君将自由, 我心亦然"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="一些记录"></span><div class="body md" itemprop="articleBody"><div class="note info"><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc3RhcnJvY2tzLmlvLw==">官网地址</span></p></div><h1 id="starrocks数据库"><a class="anchor" href="#starrocks数据库">#</a> StarRocks 数据库</h1><h2 id="简介"><a class="anchor" href="#简介">#</a> 简介</h2><p>StarRocks 是开源的新一代极速全场景 MPP 数据库。它采用新一代的弹性 MPP 架构，可以高效支持大数据量级的多维分析、实时分析、 <code>高并发</code> 分析等多种 <code>数据分析</code> 场景。StarRocks 性能出色，它采用了全面 <code>向量化</code> 技术，比 <code>同类产品</code> 平均快 3-5 倍。</p><p>MPP:Massively Parallel Processing (大规模并行处理)</p><h2 id="环境"><a class="anchor" href="#环境">#</a> 环境</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>版本</td><td>2.4.3</td></tr><tr><td>系统</td><td>linux x86</td></tr><tr><td>编程语言</td><td>jdk1.8（大于也行，环境变量已配置）</td></tr></tbody></table><h2 id="安装与部署"><a class="anchor" href="#安装与部署">#</a> 安装与部署</h2><h3 id="前提条件"><a class="anchor" href="#前提条件">#</a> 前提条件</h3><ol><li>需要系统支持 <code>avx2</code> 指令，你可以通过以下命令查看系统是否支持</li></ol><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">cat</span> /proc/cpuinfo <span class="token operator">|</span> <span class="token function">grep</span> avx2</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#如果有返回内容则代表支持，如：</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /proc/cpuinfo | grep avx2</span></pre></td></tr><tr><td data-num="5"></td><td><pre>flags		<span class="token builtin class-name">:</span> fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch epb cat_l3 cdp_l3 intel_pt ssbd ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm rdt_a rdseed adx smap xsaveopt cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm arat pln pts spec_ctrl intel_stibp flush_l1d</pre></td></tr></table></figure><ol start="2"><li>如果系统不支持，可能是 arm 架构的系统。可以自己打包，或者找打包好的运行</li></ol><h3 id="安装"><a class="anchor" href="#安装">#</a> 安装</h3><ol><li><p>在官网下载对应系统的安装包。<span class="exturl" data-url="aHR0cHM6Ly93d3cuc3RhcnJvY2tzLmlvL2Rvd25sb2FkL2NvbW11bml0eQ==">下载</span></p></li><li><p>上传到服务后解压</p></li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>root@localhost starrocks<span class="token punctuation">]</span><span class="token comment"># tar -zxvf StarRocks-2.4.3</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#解压后的结构</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>root@localhost StarRocks-2.4.3<span class="token punctuation">]</span><span class="token comment"># ll</span></pre></td></tr><tr><td data-num="4"></td><td><pre>总用量 <span class="token number">2028</span></pre></td></tr><tr><td data-num="5"></td><td><pre>drwxr-xr-x  <span class="token number">5</span> <span class="token number">1007</span> <span class="token number">1007</span>      <span class="token number">40</span> <span class="token number">1</span>月  <span class="token number">18</span> <span class="token number">2023</span> apache_hdfs_broker</pre></td></tr><tr><td data-num="6"></td><td><pre>drwxr-xr-x  <span class="token number">8</span> <span class="token number">1007</span> <span class="token number">1007</span>      <span class="token number">77</span> <span class="token number">5</span>月  <span class="token number">12</span> <span class="token number">2023</span> be</pre></td></tr><tr><td data-num="7"></td><td><pre>drwxr-xr-x <span class="token number">11</span> <span class="token number">1007</span> <span class="token number">1007</span>     <span class="token number">126</span> <span class="token number">5</span>月  <span class="token number">12</span> <span class="token number">2023</span> fe</pre></td></tr><tr><td data-num="8"></td><td><pre>-rw-rw-r--  <span class="token number">1</span> <span class="token number">1007</span> <span class="token number">1007</span>    <span class="token number">3858</span> <span class="token number">1</span>月  <span class="token number">18</span> <span class="token number">2023</span> LICENSE.txt</pre></td></tr><tr><td data-num="9"></td><td><pre>-rw-r--r--  <span class="token number">1</span> <span class="token number">1007</span> <span class="token number">1007</span> <span class="token number">2071942</span> <span class="token number">1</span>月  <span class="token number">18</span> <span class="token number">2023</span> NOTICE.txt</pre></td></tr><tr><td data-num="10"></td><td><pre>drwxr-xr-x  <span class="token number">4</span> <span class="token number">1007</span> <span class="token number">1007</span>      <span class="token number">32</span> <span class="token number">1</span>月  <span class="token number">18</span> <span class="token number">2023</span> udf</pre></td></tr></table></figure><table><thead><tr><th><strong>路径 / 文件</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><strong>apache_hdfs_broker</strong></td><td>Broker 节点的部署路径。</td></tr><tr><td><strong>fe</strong></td><td>FE 节点的部署路径。</td></tr><tr><td><strong>be</strong></td><td>BE 节点的部署路径。</td></tr><tr><td><strong>LICENSE.txt</strong></td><td>StarRocks license 文件。</td></tr><tr><td><strong>NOTICE.txt</strong></td><td>StarRocks notice 文件。</td></tr></tbody></table><h3 id="部署"><a class="anchor" href="#部署">#</a> 部署</h3><ol><li>首先配置 FE 节点</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#创建元数据存储路径。建议将元数据存储在与 FE 部署文件不同的路径中。请确保此路径存在并且您拥有写入权限</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 进入 fe 目录</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">cd</span> fe</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 将 &lt;meta_dir> 替换为您要创建的元数据目录。 &lt;meta_dir > 和你配置的目录一致</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token operator">&lt;</span>meta_dir<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 这里的目录直接就叫</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> meta</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 修改配置</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 在配置项 meta_dir 中指定元数据路径</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">vi</span> fe/conf/fe.conf</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># 将 &lt;meta_dir> 替换为您已创建的元数据目录。</span></pre></td></tr><tr><td data-num="15"></td><td><pre>meta_dir <span class="token operator">=</span> <span class="token operator">&lt;</span>meta_dir<span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 上面指定目录维 meta, 那么这里的目录为下面的</span></pre></td></tr><tr><td data-num="17"></td><td><pre>meta_dir <span class="token operator">=</span> meta</pre></td></tr></table></figure><p><code>fe.conf</code> 更多高级配置项请参考 <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnN0YXJyb2Nrcy5pby96aC9kb2NzL2FkbWluaXN0cmF0aW9uL21hbmFnZW1lbnQvRkVfY29uZmlndXJhdGlvbi8=">参数配置 - FE 配置项</span></p><ol start="2"><li>启动 FE 节点</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#后台启动</span></pre></td></tr><tr><td data-num="2"></td><td><pre>./fe/bin/start_fe.sh <span class="token parameter variable">--daemon</span></pre></td></tr></table></figure><ol start="3"><li>确定 FE 节点成功启动</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#通过查看指定日志内容确定启动情况</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">cat</span> fe/log/fe.log <span class="token operator">|</span> <span class="token function">grep</span> thrift</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#如果日志打印以下内容，则说明该 FE 节点启动成功：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token string">"2022-08-10 16:12:29,911 INFO (UNKNOWN x.x.x.x_9010_1660119137253(-1)|1) [FeServer.start():52] thrift server started with port 9020."</span></pre></td></tr></table></figure><ol start="4"><li>使用 mysql 连接工具连接 FE 节点确定状态</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#通过 MySQL 客户端连接到 StarRocks。您需要使用初始用户 root 登录，密码默认为空</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 将 &lt;fe_address> 替换为 Leader FE 节点的 IP 地址（priority_networks）或 FQDN，</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 并将 &lt;query_port>（默认：9030）替换为您在 fe.conf 中指定的 query_port。</span></pre></td></tr><tr><td data-num="4"></td><td><pre>mysql <span class="token parameter variable">-h</span> <span class="token operator">&lt;</span>fe_address<span class="token operator">></span> -P<span class="token operator">&lt;</span>query_port<span class="token operator">></span> <span class="token parameter variable">-uroot</span></pre></td></tr><tr><td data-num="5"></td><td><pre>例如：mysql <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.0.1 <span class="token parameter variable">-P9030</span> <span class="token parameter variable">-uroot</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">#可以用 navicat 或 sqlyago 工具连接</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">#连接后查看状态</span></pre></td></tr><tr><td data-num="10"></td><td><pre>SHOW PROC <span class="token string">'/frontends'</span><span class="token punctuation">\</span>G</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">#示例：</span></pre></td></tr><tr><td data-num="13"></td><td><pre>MySQL <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">></span> SHOW PROC <span class="token string">'/frontends'</span><span class="token punctuation">\</span>G</pre></td></tr><tr><td data-num="14"></td><td><pre>*************************** <span class="token number">1</span>. row ***************************</pre></td></tr><tr><td data-num="15"></td><td><pre>             Name: x.x.x.x_9010_1686810741121</pre></td></tr><tr><td data-num="16"></td><td><pre>               IP: x.x.x.x</pre></td></tr><tr><td data-num="17"></td><td><pre>      EditLogPort: <span class="token number">9010</span></pre></td></tr><tr><td data-num="18"></td><td><pre>         HttpPort: <span class="token number">8030</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        QueryPort: <span class="token number">9030</span></pre></td></tr><tr><td data-num="20"></td><td><pre>          RpcPort: <span class="token number">9020</span></pre></td></tr><tr><td data-num="21"></td><td><pre>             Role: LEADER</pre></td></tr><tr><td data-num="22"></td><td><pre>        ClusterId: <span class="token number">919351034</span></pre></td></tr><tr><td data-num="23"></td><td><pre>             Join: <span class="token boolean">true</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            Alive: <span class="token boolean">true</span></pre></td></tr><tr><td data-num="25"></td><td><pre>ReplayedJournalId: <span class="token number">1220</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    LastHeartbeat: <span class="token number">2023</span>-06-15 <span class="token number">15</span>:39:04</pre></td></tr><tr><td data-num="27"></td><td><pre>         IsHelper: <span class="token boolean">true</span></pre></td></tr><tr><td data-num="28"></td><td><pre>           ErrMsg: </pre></td></tr><tr><td data-num="29"></td><td><pre>        StartTime: <span class="token number">2023</span>-06-15 <span class="token number">14</span>:32:28</pre></td></tr><tr><td data-num="30"></td><td><pre>          Version: <span class="token number">3.0</span>.0-48f4d81</pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>如果字段 Alive 为 true，说明该 FE 节点正常启动并加入集群。</pre></td></tr><tr><td data-num="35"></td><td><pre>如果字段 Role 为 FOLLOWER，说明该 FE 节点有资格被选为 Leader FE 节点。</pre></td></tr><tr><td data-num="36"></td><td><pre>如果字段 Role 为 LEADER，说明该 FE 节点为 Leader FE 节点。</pre></td></tr></table></figure><ol start="5"><li>配置 BE 节点</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#创建数据存储路径。建议将数据存储在与 BE 部署文件不同的路径中。请确保此路径存在并且您拥有写入权限</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 进入 be 目录</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">cd</span> be</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 将 &lt;storage_root_path> 替换为您要创建的数据存储路径。 &lt;storage_root_path > 和你配置的目录一致</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> <span class="token operator">&lt;</span>storage_root_path<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 这里的目录直接就叫</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> storage</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 修改配置</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 在配置项 storage_root_path 中指定元数据路径</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token function">vi</span> be/conf/be.conf</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># 将 &lt;storage_root_path> 替换为您已创建的元数据目录。</span></pre></td></tr><tr><td data-num="15"></td><td><pre>storage_root_path <span class="token operator">=</span> <span class="token operator">&lt;</span>storage_root_path<span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 上面指定目录为 storage, 那么这里的目录为下面的</span></pre></td></tr><tr><td data-num="17"></td><td><pre>storage_root_path <span class="token operator">=</span> storage</pre></td></tr></table></figure><p><code>be.conf</code> 更多高级配置项请参考 <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnN0YXJyb2Nrcy5pby96aC9kb2NzL2FkbWluaXN0cmF0aW9uL21hbmFnZW1lbnQvQkVfY29uZmlndXJhdGlvbi8=">参数配置 - BE 配置项</span></p><ol start="6"><li>启动 BE 节点</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>./be/bin/start_be.sh <span class="token parameter variable">--daemon</span></pre></td></tr></table></figure><ol start="7"><li>确定 FE 节点成功启动</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#通过查看指定日志内容确定启动情况</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">cat</span> be/log/be.INFO <span class="token operator">|</span> <span class="token function">grep</span> heartbeat</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#如果日志打印以下内容，则说明该 BE 节点启动成功：</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token string">"I0614 17:41:39.782819 3717531 thrift_server.cpp:388] heartbeat has started listening port on 9050"</span></pre></td></tr></table></figure><ol start="8"><li>将 BE 节点添加到 FE 中，查看 BE 状态</li></ol><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#通过 MySQL 客户端连接到 StarRocks FE 节点。您需要使用初始用户 root 登录，密码默认为空</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 将 &lt;fe_address> 替换为 Leader FE 节点的 IP 地址（priority_networks）或 FQDN，</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 并将 &lt;query_port>（默认：9030）替换为您在 fe.conf 中指定的 query_port。</span></pre></td></tr><tr><td data-num="4"></td><td><pre>mysql <span class="token parameter variable">-h</span> <span class="token operator">&lt;</span>fe_address<span class="token operator">></span> -P<span class="token operator">&lt;</span>query_port<span class="token operator">></span> <span class="token parameter variable">-uroot</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">#可以用 navicat 或 sqlyago 工具连接</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#将 BE 节点添加到 FE</span></pre></td></tr><tr><td data-num="9"></td><td><pre>-- 将 <span class="token operator">&lt;</span>be_address<span class="token operator">></span> 替换为 BE 节点的 IP 地址（priority_networks），</pre></td></tr><tr><td data-num="10"></td><td><pre>-- 并将 <span class="token operator">&lt;</span>heartbeat_service_port<span class="token operator">></span>（默认：9050）替换为您在 be.conf 中指定的 heartbeat_service_port。</pre></td></tr><tr><td data-num="11"></td><td><pre>ALTER SYSTEM ADD BACKEND <span class="token string">"&lt;be_address>:&lt;heartbeat_service_port>"</span>, <span class="token string">"&lt;be2_address>:&lt;heartbeat_service_port>"</span>, <span class="token string">"&lt;be3_address>:&lt;heartbeat_service_port>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>例如：ALTER SYSTEM ADD BACKEND <span class="token string">"192.168.0.1:9050"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">#添加成功后 查看添加结果</span></pre></td></tr><tr><td data-num="15"></td><td><pre>SHOW PROC <span class="token string">'/backends'</span><span class="token punctuation">\</span>G</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>MySQL <span class="token punctuation">[</span><span class="token punctuation">(</span>none<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">></span> SHOW PROC <span class="token string">'/backends'</span><span class="token punctuation">\</span>G</pre></td></tr><tr><td data-num="18"></td><td><pre>*************************** <span class="token number">1</span>. row ***************************</pre></td></tr><tr><td data-num="19"></td><td><pre>            BackendId: <span class="token number">10007</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                   IP: <span class="token number">172.26</span>.195.67</pre></td></tr><tr><td data-num="21"></td><td><pre>        HeartbeatPort: <span class="token number">9050</span></pre></td></tr><tr><td data-num="22"></td><td><pre>               BePort: <span class="token number">9060</span></pre></td></tr><tr><td data-num="23"></td><td><pre>             HttpPort: <span class="token number">8040</span></pre></td></tr><tr><td data-num="24"></td><td><pre>             BrpcPort: <span class="token number">8060</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        LastStartTime: <span class="token number">2023</span>-06-15 <span class="token number">15</span>:23:08</pre></td></tr><tr><td data-num="26"></td><td><pre>        LastHeartbeat: <span class="token number">2023</span>-06-15 <span class="token number">15</span>:57:30</pre></td></tr><tr><td data-num="27"></td><td><pre>                Alive: <span class="token boolean">true</span></pre></td></tr><tr><td data-num="28"></td><td><pre> SystemDecommissioned: <span class="token boolean">false</span></pre></td></tr><tr><td data-num="29"></td><td><pre>ClusterDecommissioned: <span class="token boolean">false</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            TabletNum: <span class="token number">30</span></pre></td></tr><tr><td data-num="31"></td><td><pre>     DataUsedCapacity: <span class="token number">0.000</span> </pre></td></tr><tr><td data-num="32"></td><td><pre>        AvailCapacity: <span class="token number">341.965</span> GB</pre></td></tr><tr><td data-num="33"></td><td><pre>        TotalCapacity: <span class="token number">1.968</span> TB</pre></td></tr><tr><td data-num="34"></td><td><pre>              UsedPct: <span class="token number">83.04</span> %</pre></td></tr><tr><td data-num="35"></td><td><pre>       MaxDiskUsedPct: <span class="token number">83.04</span> %</pre></td></tr><tr><td data-num="36"></td><td><pre>               ErrMsg: </pre></td></tr><tr><td data-num="37"></td><td><pre>              Version: <span class="token number">3.0</span>.0-48f4d81</pre></td></tr><tr><td data-num="38"></td><td><pre>               Status: <span class="token punctuation">&#123;</span><span class="token string">"lastSuccessReportTabletsTime"</span><span class="token builtin class-name">:</span><span class="token string">"2023-06-15 15:57:08"</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    DataTotalCapacity: <span class="token number">341.965</span> GB</pre></td></tr><tr><td data-num="40"></td><td><pre>          DataUsedPct: <span class="token number">0.00</span> %</pre></td></tr><tr><td data-num="41"></td><td><pre>             CpuCores: <span class="token number">16</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    NumRunningQueries: <span class="token number">0</span></pre></td></tr><tr><td data-num="43"></td><td><pre>           MemUsedPct: <span class="token number">0.01</span> %</pre></td></tr><tr><td data-num="44"></td><td><pre>           CpuUsedPct: <span class="token number">0.0</span> %</pre></td></tr><tr><td data-num="45"></td><td><pre>           </pre></td></tr><tr><td data-num="46"></td><td><pre>如果字段 Alive 为 true，说明该 BE 节点正常启动并加入集群。</pre></td></tr></table></figure><h2 id="使用"><a class="anchor" href="#使用">#</a> 使用</h2><ol><li>基本的使用和 mysql 的语法差不多，可能只有少部分不兼容</li><li>数据基本是外部导入产生的</li></ol><h3 id="表设计"><a class="anchor" href="#表设计">#</a> 表设计</h3><h4 id="表概述"><a class="anchor" href="#表概述">#</a> 表概述</h4><p>表是数据存储单元。理解 StarRocks 中的表结构，以及如何设计合理的表结构，有利于优化数据组织，提高查询效率。相比于传统的数据库，StarRocks 会以列的方式存储 JSON、ARRAY 等复杂的半结构化数据，保证高效查询。</p><ol><li><p>与其他关系型数据库一样，StarRocks 表在逻辑上由行（Row）和列（Column）构成</p></li><li><p>建表只需要在 CREATE TABLE 语句中定义列和列的数据类型，即可创建一张表</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> example_db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">USE</span> example_db<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_access <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    uid <span class="token keyword">int</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    name <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    age <span class="token keyword">int</span><span class="token punctuation">,</span> </pre></td></tr><tr><td data-num="9"></td><td><pre>    phone <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    last_access <span class="token keyword">datetime</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    credits <span class="token keyword">double</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">DUPLICATE</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>uid<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">-- 上述建表示例创建了明细表，该表中数据不具有任何约束，相同的数据行可能会重复存在。并且指定明细表中前两列为排序列，构成排序键。数据按排序键排序后存储，有助于查询时的快速索引</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">-- 可以执行 DESCRIBE 查看表结构</span></pre></td></tr><tr><td data-num="18"></td><td><pre>MySQL <span class="token punctuation">[</span>example_db<span class="token punctuation">]</span><span class="token operator">></span> <span class="token keyword">DESCRIBE</span> user_access<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token operator">+</span><span class="token comment">-------------+-------------+------+-------+---------+-------+</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token operator">|</span> Field       <span class="token operator">|</span> <span class="token keyword">Type</span>        <span class="token operator">|</span> <span class="token boolean">Null</span> <span class="token operator">|</span> <span class="token keyword">Key</span>   <span class="token operator">|</span> <span class="token keyword">Default</span> <span class="token operator">|</span> Extra <span class="token operator">|</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token operator">+</span><span class="token comment">-------------+-------------+------+-------+---------+-------+</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token operator">|</span> uid         <span class="token operator">|</span> <span class="token keyword">int</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token boolean">true</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token operator">|</span> name        <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token boolean">true</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token operator">|</span> age         <span class="token operator">|</span> <span class="token keyword">int</span>         <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token boolean">false</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token operator">|</span> phone       <span class="token operator">|</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token boolean">false</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token operator">|</span> last_access <span class="token operator">|</span> <span class="token keyword">datetime</span>    <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token boolean">false</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token operator">|</span> credits     <span class="token operator">|</span> <span class="token keyword">double</span>      <span class="token operator">|</span> YES  <span class="token operator">|</span> <span class="token boolean">false</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span>       <span class="token operator">|</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token operator">+</span><span class="token comment">-------------+-------------+------+-------+---------+-------+</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token number">6</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span></pre></td></tr></table></figure><p>-- 执行 SHOW CREATE TABLE 来查看建表语句 mysql 也是根据这个语句来查看建表语句<br>MySQL [example_db]&gt; SHOW CREATE TABLE user_access\G<br>*************************** 1. row ***************************<br>Table: user_access<br>Create Table: CREATE TABLE <code>user_access</code> (<br><code>uid</code> int(11) NULL COMMENT &quot;&quot;,<br><code>name</code> varchar(64) NULL COMMENT &quot;&quot;,<br><code>age</code> int(11) NULL COMMENT &quot;&quot;,<br><code>phone</code> varchar(16) NULL COMMENT &quot;&quot;,<br><code>last_access</code> datetime NULL COMMENT &quot;&quot;,<br><code>credits</code> double NULL COMMENT &quot;&quot;<br>) ENGINE=OLAP<br>DUPLICATE KEY( <code>uid</code> , <code>name</code> )<br>DISTRIBUTED BY RANDOM<br>PROPERTIES (<br>&quot;replication_num&quot; = &quot;3&quot;,<br>&quot;in_memory&quot; = &quot;false&quot;,<br>&quot;enable_persistent_index&quot; = &quot;false&quot;,<br>&quot;replicated_storage&quot; = &quot;true&quot;,<br>&quot;compression&quot; = &quot;LZ4&quot;<br>);<br>1 row in set (0.00 sec)</p><pre><code>
::info::

如果测试环境中集群仅包含一个 BE，可以在 `PROPERTIES` 中将副本数设置为 `1`，即 `PROPERTIES( &quot;replication_num&quot; = &quot;1&quot; )`。默认副本数为 `3`，也是生产集群推荐的副本数。如果您需要使用默认设置，也可以不配置 `replication_num` 参数。

::::

</code></pre></li><li><p>表类型</p><p>StarRocks 提供四种类型的表，包括明细表、主键表、聚合表和更新表，适用于存储多种业务数据，例如原始数据、实时频繁更新的数据和聚合数据。</p><ul><li>明细表简单易用，表中数据不具有任何约束，相同的数据行可以重复存在。该表适用于存储不需要约束和预聚合的原始数据，例如日志等。</li><li>主键表能力强大，具有唯一性非空约束。该表能够在支撑实时更新、部分列更新等场景的同时，保证查询性能，适用于实时查询（一般用在实时报表）。</li><li>聚合表适用于存储预聚合后的数据，可以降低聚合查询时所需扫描和计算的数据量，极大提高聚合查询的效率。</li><li>更新表适用于实时更新的业务场景，目前已逐渐被主键表取代。</li></ul></li><li><p>数据分布</p><p>StarRocks 采用分区 + 分桶的两级数据分布策略，将数据均匀分布各个 BE 节点。查询时能够有效裁剪数据扫描量，最大限度地利用集群的并发性能，从而提升查询性能。</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 通过 show 相关命令可以查询到分区、分桶情况</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">-- 分区的情况</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">SHOW</span> TABLET <span class="token keyword">FROM</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>db_name<span class="token operator">></span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token operator">&lt;</span>table_name<span class="token operator">></span> <span class="token keyword">PARTITION</span><span class="token punctuation">(</span>partition_name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">-- 分桶的情况</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">SHOW</span> TABLET <span class="token operator">&lt;</span>tablet_id<span class="token operator">></span></pre></td></tr></table></figure><p>分区：</p><p>相当于把数据分成多个区间，一般是根据时间范围分成多个区间（比如一个星期分一次区间）， 或者是特定的值列表分区（比如特定的城市分区）</p><p>​</p><p>分桶：</p><p>在一个分区中在分一层，将数据存储在更小的单元中</p><p>StarRocks 提供两种分桶方式：</p><ul><li>哈希分桶：根据数据的分桶键值，将数据划分至分桶。选择查询时经常使用的条件列组成分桶键，能有效提高查询效率。</li><li>随机分桶：随机划分数据至分桶。这种分桶方式更加简单易用。</li></ul></li></ol><h4 id="表对比"><a class="anchor" href="#表对比">#</a> 表对比</h4><p>starrocks 的表提供了特定的几个类型。下面是各类表的能力对比</p><table><thead><tr><th></th><th><strong>主键表 (Primary Key table)</strong></th><th><strong>明细表 (Duplicate Key table)</strong></th><th><strong>聚合表 (Aggregate table)</strong></th><th><strong>更新表 (Unique Key table)</strong></th></tr></thead><tbody><tr><td><strong>Key 列和唯一约束</strong></td><td>主键（Primary Key）具有唯一约束和非空约束。</td><td>Duplicate Key 不具有唯一约束。</td><td>聚合键（Aggregate Key）具有唯一约束。</td><td>唯一键（Unique Key）具有唯一约束。</td></tr><tr><td><strong>Key 列和数据变更的关系（逻辑关系）</strong></td><td>基于主键对数据进行增删改操作。如果新数据的主键值与表中原数据的主键值相同，则存在唯一约束冲突，此时新数据会替代原数据。与更新表相比，主键表增强了其底层存储引擎，已经可以取代更新表。</td><td>Duplicate Key 不具有唯一约束，因此如果新数据的 Duplicate Key 与表中原数据相同，则新旧数据都会存在表中。</td><td>基于聚合键对数据进行增删改操作。如果新数据与表中原数据存在唯一约束冲突，则会根据聚合键和 Value 列的聚合函数聚合新旧数据。</td><td>基于唯一键对数据进行增删改操作。如果新数据与表中原数据存在唯一约束冲突，则新数据会替代原数据。更新表实际可以视为聚合函数为 replace 的聚合表。</td></tr><tr><td><strong>Key 列和排序键的关系</strong></td><td>自 3.0 起，两者解耦。</td><td>两者耦合。</td><td></td><td></td></tr><tr><td><strong>Key 列和排序键支持的数据类型</strong></td><td>数值（包括整型、布尔）、字符串、时间日期。</td><td>数值（包括整型、布尔、Decimal）、字符串、时间日期。</td><td></td><td></td></tr><tr><td><strong>Key 和分区 / 分桶列的关系</strong></td><td>分区列、分桶列必须在主键中。</td><td>无</td><td>分区列、分桶列必须在聚合键中。</td><td>分区列、分桶列必须在唯一键中。</td></tr></tbody></table><h4 id="主键表"><a class="anchor" href="#主键表">#</a> 主键表</h4><ol><li><p>主键表能够在支撑实时数据更新的同时，也能保证高效的查询性能</p><p>场景：</p><ul><li>实时对接数据，数据是唯一的，并且数据的更新和删除操作多。实时同步增删改的数据至主键表，可以简化数据同步流程</li><li>有实时统计的报表，保证数据是最新的统计结果</li></ul></li><li><p>使用说明</p><p>建表例子：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> orders1 <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    order_id <span class="token keyword">bigint</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    dt <span class="token keyword">date</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    user_id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    good_id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    cnt <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    revenue <span class="token keyword">int</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>order_id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">DISTRIBUTED</span> <span class="token keyword">BY</span> <span class="token keyword">HASH</span> <span class="token punctuation">(</span>order_id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>::info::</p><p>由于主键表仅支持分桶策略为哈希分桶，因此您还需要通过 <code>DISTRIBUTED BY HASH ()</code> 定义哈希分桶键。</p><p>::::</p></li></ol><h4 id="明细表"><a class="anchor" href="#明细表">#</a> 明细表</h4><ol><li><p>明细表是默认创建的表类型。如果在建表时未指定任何 key，默认创建的是明细表。</p><p>创建表时，支持定义排序键。如果查询的过滤条件包含排序键，则 StarRocks 能够快速地过滤数据，提高查询效率。明细表适用于日志数据分析等场景，支持追加新数据，不支持修改历史数据。</p><p>场景:</p><ul><li>分析原始数据，例如原始日志、原始操作记录等</li><li>查询方式灵活，不需要局限于预聚合的分析方式。</li><li>导入日志数据或者时序数据，主要特点是旧数据不会更新，只会追加新的数据。</li></ul></li><li><p>使用说明</p><p>例如，需要分析某时间范围的某一类事件的数据，则可以将事件时间（ <code>event_time</code> ）和事件类型（ <code>event_type</code> ）作为排序键。</p><p>在该业务场景下，建表语句如下：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> detail <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    event_time <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">"datetime of event"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    event_type <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">"type of event"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    user_id <span class="token keyword">INT</span> <span class="token keyword">COMMENT</span> <span class="token string">"id of user"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    device_code <span class="token keyword">INT</span> <span class="token keyword">COMMENT</span> <span class="token string">"device code"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    channel <span class="token keyword">INT</span> <span class="token keyword">COMMENT</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">DUPLICATE</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>event_time<span class="token punctuation">,</span> event_type<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">DISTRIBUTED</span> <span class="token keyword">BY</span> <span class="token keyword">HASH</span><span class="token punctuation">(</span>user_id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>PROPERTIES <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token string">"replication_num"</span> <span class="token operator">=</span> <span class="token string">"3"</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><h4 id="聚合表"><a class="anchor" href="#聚合表">#</a> 聚合表</h4><ol><li><p>建表时，支持定义排序键和指标列，并为指标列指定聚合函数。当多条数据具有相同的排序键时，指标列会进行聚合。在分析统计和汇总数据时，聚合表能够减少查询时所需要处理的数据，提升查询效率。适用于分析统计和汇总数据。</p><p>场景：</p><ul><li>通过分析网站或 APP 的访问流量，统计用户的访问总时长、访问总次数。</li><li>广告厂商为广告主提供的广告点击总量、展示总量、消费统计等。</li><li>通过分析电商的全年交易数据，获得指定季度或者月份中，各类消费人群的爆款商品。</li></ul><p>上面这些情况不需要知道数据的明细是什么，只关心 max、sum、count 等聚合的结果</p></li><li><p>创建表</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">-- 例如需要分析某一段时间内，来自不同城市的用户，访问不同网页的总次数。则可以将网页地址 site_id、日期 date 和城市代码 city_code 作为排序键，将访问次数 pv 作为指标列，并为指标列 pv 指定聚合函数为 SUM。</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>在该业务场景下，建表语句如下：</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> example_db<span class="token punctuation">.</span>aggregate_tbl <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    site_id LARGEINT <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">"id of site"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">date</span> <span class="token keyword">DATE</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">"time of event"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    city_code <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">"city_code of user"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    pv <span class="token keyword">BIGINT</span> SUM <span class="token keyword">DEFAULT</span> <span class="token string">"0"</span> <span class="token keyword">COMMENT</span> <span class="token string">"total page views"</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>AGGREGATE <span class="token keyword">KEY</span><span class="token punctuation">(</span>site_id<span class="token punctuation">,</span> <span class="token keyword">date</span><span class="token punctuation">,</span> city_code<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">DISTRIBUTED</span> <span class="token keyword">BY</span> <span class="token keyword">HASH</span><span class="token punctuation">(</span>site_id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>PROPERTIES <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token string">"replication_num"</span> <span class="token operator">=</span> <span class="token string">"3"</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><h3 id="语法注意点"><a class="anchor" href="#语法注意点">#</a> 语法注意点</h3><table><thead><tr><th></th><th>mysql</th><th>starrocks</th></tr></thead><tbody><tr><td>自动生成汇总行</td><td>with rollup</td><td>不支持，需要用 union all 在统计汇总行</td></tr><tr><td>子查询</td><td>select a, (select b from B) from A;</td><td>不支持，需要想办法拆分条件</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h3 id="常用的sql语句"><a class="anchor" href="#常用的sql语句">#</a> 常用的 sql 语句</h3><ol><li><p>修改用户密码</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">'jack'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> jack<span class="token variable">@'172.10.1.10'</span> IDENTIFIED <span class="token keyword">WITH</span> mysql_native_password <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><h3 id="优化经验"><a class="anchor" href="#优化经验">#</a> 优化经验</h3><ol><li><p>有一张几亿的表查询很慢，当时我的统计表会根据年份筛选，那么这里我就选择根据年份分区，这样查询就会很快</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> gz_balance <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    sno <span class="token keyword">int</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    years <span class="token keyword">INT</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	name string</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">ENGINE</span><span class="token operator">=</span>olap</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>sno<span class="token punctuation">,</span> years<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">PARTITION</span> <span class="token keyword">BY</span> RANGE <span class="token punctuation">(</span>years<span class="token punctuation">)</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">START</span> <span class="token punctuation">(</span><span class="token string">"2014"</span><span class="token punctuation">)</span> <span class="token keyword">END</span> <span class="token punctuation">(</span><span class="token string">"2060"</span><span class="token punctuation">)</span> EVERY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">DISTRIBUTED</span> <span class="token keyword">BY</span> <span class="token keyword">HASH</span><span class="token punctuation">(</span>sno<span class="token punctuation">,</span> years<span class="token punctuation">)</span> BUCKETS <span class="token number">8</span></pre></td></tr><tr><td data-num="12"></td><td><pre>PROPERTIES <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token string">"replication_num"</span> <span class="token operator">=</span> <span class="token string">"1"</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure></li></ol><p>select a.<em>,dd.distname,2015 nf,4 yf,' 全部 ' lx from<br>(select ifnull(distno,'01') distno,zts,bqs,sqs,zxl from<br>(select case when LENGTH('01')&lt;=4 then left(a.linkdistid,6) else a.linkdistid end distno,<br>count(distinct ifnull(b.acc_set,c.acc_set)) zts,<br>convert(sum(b.debit_month),DECIMAL) bqs,<br>convert(sum(c.debit_month),DECIMAL) sqs,<br>case when sum(c.debit_month)=0 then 0 else convert(sum(b.debit_month)/sum(c.debit_month)<em>100,DECIMAL) end zxl<br>from gz_acc_set a left outer join gz_balance1 b on a.acc_set=b.acc_set and b.YEARs=2015 and b.months=4 and b.acc_code like '522%' left outer join gz_balance1 c on a.acc_set=c.acc_set and c.YEARs</em>12+c.months=2015</em>12+4-1 and c.acc_code like '522%' where b.debit_month+c.debit_month&gt;=1 and a.dwlx =case when ' 全部 '=' 全部 ' then dwlx else ' 全部 ' end and a.linkDistId like '01%' group by case when LENGTH ('01')&lt;=4 then left (a.linkdistid,6) else a.linkdistid end ) a) a,scandist dd where a.distno=dd.distno</p><p>从原本的 10 几秒 缩减到 2 秒以内</p><pre><code>






### smt工具使用

StarRocks Migration Tool工具是StarRocks专门为了从其他关系型数据生成对应到starrocks数据库表结构的工具， 支持从mysql、sqlserver(2014)、oracle等数据库导出，还可以生产对应的`flinksql`

1. 官方下载[地址](https://releases.starrocks.io/resources/smt.tar.gz)

2. 修改配置文件 config_prod.conf

```properties
[db]
host = 127.0.0.1
port = 1433
user = sa
password = 123456
# currently available types: `mysql`, `pgsql`, `oracle`, `hive`, `clickhouse`, `sqlserver`, `tidb`
type = sqlserver
# # only takes effect on `type == hive`. 
# # Available values: kerberos, none, nosasl, kerberos_http, none_http, zk, ldap
# authentication = kerberos

[other]
# number of backends in StarRocks
# be节点数
be_num = 1
# `decimal_v3` is supported since StarRocks-1.8.1
use_decimal_v3 = true
# directory to save the converted DDL SQL
# 输出的目录
output_dir = shq_bjaccount

# !!!`database` `table` `schema` are case sensitive in `oracle`!!!
[table-rule.1]
# pattern to match databases for setting properties
# !!! database should be a `whole instance(or pdb) name` but not a regex when it comes with an `oracle db` !!!
database = shq_bjaccount
# pattern to match tables for setting properties
table = .*
# `schema` only takes effect on `postgresql` and `oracle` and `sqlserver`
schema = dbo

############################################
### starrocks table configurations
############################################
# # set a column as the partition_key
# partition_key = p_key
# # override the auto-generated partitions
# partitions = START (&quot;2021-01-02&quot;) END (&quot;2021-01-04&quot;) EVERY (INTERVAL 1 day)
# # only take effect on tables without primary keys or unique indexes
# duplicate_keys=k1,k2
# # override the auto-generated distributed keys
# distributed_by=k1,k2
# # override the auto-generated distributed buckets
bucket_num=8
# # properties.xxxxx: properties used to create tables
# properties.in_memory = false
properties.replication_num = 1
properties.enable_persistent_index = true

############################################
### flink sink configurations
### DO NOT set `connector`, `table-name`, `database-name`, they are auto-generated
############################################
flink.starrocks.jdbc-url=$&#123;sink_jdbc_url&#125;
flink.starrocks.load-url=$&#123;sink_load_url&#125;
flink.starrocks.username=$&#123;sink_username&#125;
flink.starrocks.password=$&#123;sink_password&#125;
flink.starrocks.sink.max-retries=10
flink.starrocks.sink.buffer-flush.interval-ms=1000
flink.starrocks.sink.properties.format=json
flink.starrocks.sink.properties.strip_outer_array=true
#防止json数据过大导致错误
flink.starrocks.sink.properties.ignore_json_size=true
# # used to set the server-id for mysql-cdc jobs instead of using a random server-id
# flink.cdc.server-id = 5000

############################################
### flink-cdc configuration for `tidb`
############################################
# # Only takes effect on TiDB before v4.0.0. 
# # TiKV cluster's PD address.
# flink.cdc.pd-addresses = 127.0.0.1:2379
#可以配置source端的相关参数
flink.cdc.debezium.snapshot.isolation.mode=read_committed
flink.cdc.debezium.snapshot.lock.timeout.ms=-1

############################################
### flink-cdc plugin configuration for `postgresql`
############################################
# # for `9.*` decoderbufs, wal2json, wal2json_rds, wal2json_streaming, wal2json_rds_streaming
# # refer to https://ververica.github.io/flink-cdc-connectors/master/content/connectors/postgres-cdc.html 
# # and https://debezium.io/documentation/reference/postgres-plugins.html
# flink.cdc.decoding.plugin.name = decoderbufs
</code></pre><ol start="3"><li><p>执行程序生成对应的文件</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>./starrocks-migrate-tool</pre></td></tr></table></figure></li></ol><h3 id="导入数据"><a class="anchor" href="#导入数据">#</a> 导入数据</h3><p>本篇只介绍从 <code>flink</code> 中实时导入数据</p><div class="tags"><a href="/tzblog/tags/StarRocks/" rel="tag"><i class="ic i-tag"></i> StarRocks</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-04-23 00:44:24" itemprop="dateModified" datetime="2024-04-23T00:44:24+08:00">2024-04-23</time> </span><span id="2024/03/24/computer-science/databases/starrocks/" class="item leancloud_visitors" data-flag-title="StarRocks数据库" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/tzblog/images/wechatpay.png" alt="Tz 微信支付"><p>微信支付</p></div><div><img data-src="/tzblog/images/alipay.png" alt="Tz 支付宝"><p>支付宝</p></div><div><img data-src="/tzblog/images/paypal.png" alt="Tz 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Tz <i class="ic i-at"><em>@</em></i>一些记录</li><li class="link"><strong>本文链接：</strong> <a href="https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/databases/starrocks/" title="StarRocks数据库">https://mytingting.gitee.io/tzblog/2024/03/24/computer-science/databases/starrocks/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/tzblog/2024/03/24/computer-science/databases/sqlserver/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tzting.github.io&#x2F;images&#x2F;sky7.jpg" title="sqlserver数据库"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 数据库</span><h3>sqlserver数据库</h3></a></div><div class="item right"><a href="/tzblog/2024/03/24/computer-science/databases/dm/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tzting.github.io&#x2F;images&#x2F;sky10.jpg" title="达梦数据库"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 数据库</span><h3>达梦数据库</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#starrocks%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">StarRocks 数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.</span> <span class="toc-text">环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.</span> <span class="toc-text">安装与部署</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">前提条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2"><span class="toc-number">1.3.3.</span> <span class="toc-text">部署</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%AE%BE%E8%AE%A1"><span class="toc-number">1.4.1.</span> <span class="toc-text">表设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E6%A6%82%E8%BF%B0"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">表概述</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E5%AF%B9%E6%AF%94"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">表对比</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E8%A1%A8"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">主键表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%8E%E7%BB%86%E8%A1%A8"><span class="toc-number">1.4.1.4.</span> <span class="toc-text">明细表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E8%A1%A8"><span class="toc-number">1.4.1.5.</span> <span class="toc-text">聚合表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">1.4.2.</span> <span class="toc-text">语法注意点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%9A%84sql%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.3.</span> <span class="toc-text">常用的 sql 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E7%BB%8F%E9%AA%8C"><span class="toc-number">1.4.4.</span> <span class="toc-text">优化经验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">1.4.5.</span> <span class="toc-text">导入数据</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/tzblog/2024/03/24/computer-science/databases/mysql/" rel="bookmark" title="mysql数据库">mysql数据库</a></li><li><a href="/tzblog/2024/03/24/computer-science/databases/dm/" rel="bookmark" title="达梦数据库">达梦数据库</a></li><li class="active"><a href="/tzblog/2024/03/24/computer-science/databases/starrocks/" rel="bookmark" title="StarRocks数据库">StarRocks数据库</a></li><li><a href="/tzblog/2024/03/24/computer-science/databases/sqlserver/" rel="bookmark" title="sqlserver数据库">sqlserver数据库</a></li><li><a href="/tzblog/2024/04/20/computer-science/databases/sql-optimization/" rel="bookmark" title="通用sql优化">通用sql优化</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Tz" data-src="/tzblog/images/avatar.jpg"><p class="name" itemprop="name">Tz</p><div class="description" itemprop="description">君将自由, 我心亦然</div></div><nav class="state"><div class="item posts"><a href="/tzblog/archives/"><span class="count">34</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/tzblog/categories/"><span class="count">18</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tzblog/tags/"><span class="count">22</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1R6VGluZw==" title="https:&#x2F;&#x2F;github.com&#x2F;TzTing"><i class="ic i-github"></i></span> <a href="/tzblog/2269472297@qq.com" title="2269472297@qq.com" class="item email"><i class="ic i-envelope"></i></a></div><ul class="menu"><li class="item"><a href="/tzblog/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/tzblog/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/tzblog/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/tzblog/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tzblog/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/tzblog/links/" rel="section"><i class="ic i-magic"></i>链接</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/tzblog/2024/03/24/computer-science/databases/sqlserver/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/tzblog/2024/03/24/computer-science/databases/dm/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/dsa/" title="分类于 数据结构与算法">数据结构与算法</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/dsa/topic/" title="分类于 每日一题">每日一题</a></div><span><a href="/tzblog/2024/03/19/computer-science/dsa/topic/1716/" title="每日一题-计算力扣银行的钱">每日一题-计算力扣银行的钱</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/xxx/" title="分类于 xxx">xxx</a></div><span><a href="/tzblog/2024/03/24/example/" title="xxx">xxx</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/Program-language/" title="分类于 编程语言">编程语言</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/Program-language/java/" title="分类于 Java">Java</a></div><span><a href="/tzblog/2024/03/24/computer-science/program-language/java/java-1/" title="java编程语言">java编程语言</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/middleware/" title="分类于 中间件">中间件</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/middleware/message-queue/" title="分类于 消息队列">消息队列</a></div><span><a href="/tzblog/2024/03/24/computer-science/middleware/message-queue/rabbitmq-1/" title="rabbit消息队列">rabbit消息队列</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/framework/" title="分类于 框架">框架</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/framework/java-application/" title="分类于 java应用程序框架">java应用程序框架</a></div><span><a href="/tzblog/2024/03/24/computer-science/framework/java-application/springboot-1/" title="Spring Boot框架">Spring Boot框架</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/dsa/" title="分类于 数据结构与算法">数据结构与算法</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/dsa/topic/" title="分类于 每日一题">每日一题</a></div><span><a href="/tzblog/2024/03/19/computer-science/dsa/topic/2671/" title="每日一题-频率跟踪器">每日一题-频率跟踪器</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/%E7%B3%BB%E7%BB%9F/" title="分类于 系统">系统</a></div><span><a href="/tzblog/2024/03/21/computer-science/system/windows/windows/" title="window 使用">window 使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/middleware/" title="分类于 中间件">中间件</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/middleware/message-queue/" title="分类于 消息队列">消息队列</a></div><span><a href="/tzblog/2024/03/24/computer-science/middleware/message-queue/rocketmq-1/" title="rocket消息队列">rocket消息队列</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/dsa/" title="分类于 数据结构与算法">数据结构与算法</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/dsa/topic/" title="分类于 每日一题">每日一题</a></div><span><a href="/tzblog/2024/03/19/computer-science/dsa/topic/2605/" title="每日一题-从两个数字数组里生成最小数字">每日一题-从两个数字数组里生成最小数字</a></span></li><li class="item"><div class="breadcrumb"><a href="/tzblog/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/tzblog/categories/computer-science/databases/" title="分类于 数据库">数据库</a></div><span><a href="/tzblog/2024/03/24/computer-science/databases/sqlserver/" title="sqlserver数据库">sqlserver数据库</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Tz @ Tz</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">184k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:48</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/03/24/computer-science/databases/starrocks/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/tzblog/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->